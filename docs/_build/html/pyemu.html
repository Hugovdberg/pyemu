

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyemu package &mdash; pyEMU 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyEMU
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">pyemu package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyemu.en">pyemu.en module</a></li>
<li><a class="reference internal" href="#module-pyemu.ev">pyemu.ev module</a></li>
<li><a class="reference internal" href="#module-pyemu.la">pyemu.la module</a></li>
<li><a class="reference internal" href="#module-pyemu.logger">pyemu.logger module</a></li>
<li><a class="reference internal" href="#module-pyemu.mc">pyemu.mc module</a></li>
<li><a class="reference internal" href="#module-pyemu.pyemu_warnings">pyemu.pyemu_warnings module</a></li>
<li><a class="reference internal" href="#module-pyemu.sc">pyemu.sc module</a></li>
<li><a class="reference internal" href="#module-pyemu">Module contents</a><ul>
<li><a class="reference internal" href="#pyemu.en.Ensemble">Ensemble</a><ul>
<li><a class="reference internal" href="#pyemu.en.Ensemble.as_pyemu_matrix">as_pyemu_matrix</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.back_transform">back_transform</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.copy">copy</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.covariance_matrix">covariance_matrix</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.dropna">dropna</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.from_binary">from_binary</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.from_csv">from_csv</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.from_dataframe">from_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.get_deviations">get_deviations</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.istransformed">istransformed</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.plot">plot</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.pst">pst</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.reseed">reseed</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.to_binary">to_binary</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.to_csv">to_csv</a></li>
<li><a class="reference internal" href="#pyemu.en.Ensemble.transform">transform</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.en.Iloc">Iloc</a></li>
<li><a class="reference internal" href="#pyemu.en.Loc">Loc</a></li>
<li><a class="reference internal" href="#pyemu.en.ObservationEnsemble">ObservationEnsemble</a><ul>
<li><a class="reference internal" href="#pyemu.en.ObservationEnsemble.add_base">add_base</a></li>
<li><a class="reference internal" href="#pyemu.en.ObservationEnsemble.from_gaussian_draw">from_gaussian_draw</a></li>
<li><a class="reference internal" href="#pyemu.en.ObservationEnsemble.nonzero">nonzero</a></li>
<li><a class="reference internal" href="#pyemu.en.ObservationEnsemble.phi_vector">phi_vector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble">ParameterEnsemble</a><ul>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.add_base">add_base</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.adj_names">adj_names</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.back_transform">back_transform</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.enforce">enforce</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.fixed_indexer">fixed_indexer</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.from_gaussian_draw">from_gaussian_draw</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.from_mixed_draws">from_mixed_draws</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.from_parfiles">from_parfiles</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.from_triangular_draw">from_triangular_draw</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.from_uniform_draw">from_uniform_draw</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.lbnd">lbnd</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.log_indexer">log_indexer</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.project">project</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.transform">transform</a></li>
<li><a class="reference internal" href="#pyemu.en.ParameterEnsemble.ubnd">ubnd</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar">ErrVar</a><ul>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.G">G</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.I_minus_R">I_minus_R</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.R">R</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.first_forecast">first_forecast</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.first_parameter">first_parameter</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.first_prediction">first_prediction</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.get_errvar_dataframe">get_errvar_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.get_identifiability_dataframe">get_identifiability_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.get_null_proj">get_null_proj</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.omitted_jco">omitted_jco</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.omitted_parcov">omitted_parcov</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.omitted_predictions">omitted_predictions</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.second_forecast">second_forecast</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.second_parameter">second_parameter</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.second_prediction">second_prediction</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.third_forecast">third_forecast</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.third_parameter">third_parameter</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.third_prediction">third_prediction</a></li>
<li><a class="reference internal" href="#pyemu.ev.ErrVar.variance_at">variance_at</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis">LinearAnalysis</a><ul>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.adj_par_names">adj_par_names</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.adjust_obscov_resfile">adjust_obscov_resfile</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.apply_karhunen_loeve_scaling">apply_karhunen_loeve_scaling</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.clean">clean</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.drop_prior_information">drop_prior_information</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.fehalf">fehalf</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.forecast_names">forecast_names</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.forecasts">forecasts</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.forecasts_iter">forecasts_iter</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.get">get</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.get_cso_dataframe">get_cso_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.get_obs_competition_dataframe">get_obs_competition_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.get_par_css_dataframe">get_par_css_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.jco">jco</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.mle_covariance">mle_covariance</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.mle_parameter_estimate">mle_parameter_estimate</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.nnz_obs_names">nnz_obs_names</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.obscov">obscov</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.parcov">parcov</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.predictions">predictions</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.predictions_iter">predictions_iter</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.prior_forecast">prior_forecast</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.prior_parameter">prior_parameter</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.prior_prediction">prior_prediction</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.pst">pst</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.qhalf">qhalf</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.qhalfx">qhalfx</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.reset_obscov">reset_obscov</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.reset_parcov">reset_parcov</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.reset_pst">reset_pst</a></li>
<li><a class="reference internal" href="#pyemu.la.LinearAnalysis.xtqx">xtqx</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.logger.Logger">Logger</a><ul>
<li><a class="reference internal" href="#pyemu.logger.Logger.log">log</a></li>
<li><a class="reference internal" href="#pyemu.logger.Logger.lraise">lraise</a></li>
<li><a class="reference internal" href="#pyemu.logger.Logger.statement">statement</a></li>
<li><a class="reference internal" href="#pyemu.logger.Logger.warn">warn</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo">MonteCarlo</a><ul>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo.parensemble">parensemble</a></li>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo.obsensemble">obsensemble</a></li>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo.draw">draw</a></li>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo.get_nsing">get_nsing</a></li>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo.get_null_proj">get_null_proj</a></li>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo.num_reals">num_reals</a></li>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo.project_parensemble">project_parensemble</a></li>
<li><a class="reference internal" href="#pyemu.mc.MonteCarlo.write_psts">write_psts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.pyemu_warnings.PyemuWarning">PyemuWarning</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur">Schur</a><ul>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_added_obs_group_importance">get_added_obs_group_importance</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_added_obs_importance">get_added_obs_importance</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_conditional_instance">get_conditional_instance</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_forecast_summary">get_forecast_summary</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_obs_group_dict">get_obs_group_dict</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_par_contribution">get_par_contribution</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_par_group_contribution">get_par_group_contribution</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_parameter_summary">get_parameter_summary</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_removed_obs_group_importance">get_removed_obs_group_importance</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.get_removed_obs_importance">get_removed_obs_importance</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.next_most_important_added_obs">next_most_important_added_obs</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.next_most_par_contribution">next_most_par_contribution</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.posterior_forecast">posterior_forecast</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.posterior_parameter">posterior_parameter</a></li>
<li><a class="reference internal" href="#pyemu.sc.Schur.posterior_prediction">posterior_prediction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.Cov">Cov</a><ul>
<li><a class="reference internal" href="#pyemu.Cov.condition_on">condition_on</a></li>
<li><a class="reference internal" href="#pyemu.Cov.from_observation_data">from_observation_data</a></li>
<li><a class="reference internal" href="#pyemu.Cov.from_obsweights">from_obsweights</a></li>
<li><a class="reference internal" href="#pyemu.Cov.from_parameter_data">from_parameter_data</a></li>
<li><a class="reference internal" href="#pyemu.Cov.from_parbounds">from_parbounds</a></li>
<li><a class="reference internal" href="#pyemu.Cov.from_uncfile">from_uncfile</a></li>
<li><a class="reference internal" href="#pyemu.Cov.identity">identity</a></li>
<li><a class="reference internal" href="#pyemu.Cov.identity_like">identity_like</a></li>
<li><a class="reference internal" href="#pyemu.Cov.names">names</a></li>
<li><a class="reference internal" href="#pyemu.Cov.replace">replace</a></li>
<li><a class="reference internal" href="#pyemu.Cov.to_pearson">to_pearson</a></li>
<li><a class="reference internal" href="#pyemu.Cov.to_uncfile">to_uncfile</a></li>
<li><a class="reference internal" href="#pyemu.Cov.zero">zero</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.Ensemble">Ensemble</a><ul>
<li><a class="reference internal" href="#pyemu.Ensemble.as_pyemu_matrix">as_pyemu_matrix</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.back_transform">back_transform</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.copy">copy</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.covariance_matrix">covariance_matrix</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.dropna">dropna</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.from_binary">from_binary</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.from_csv">from_csv</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.from_dataframe">from_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.get_deviations">get_deviations</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.istransformed">istransformed</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.plot">plot</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.pst">pst</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.reseed">reseed</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.to_binary">to_binary</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.to_csv">to_csv</a></li>
<li><a class="reference internal" href="#pyemu.Ensemble.transform">transform</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.ErrVar">ErrVar</a><ul>
<li><a class="reference internal" href="#pyemu.ErrVar.G">G</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.I_minus_R">I_minus_R</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.R">R</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.first_forecast">first_forecast</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.first_parameter">first_parameter</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.first_prediction">first_prediction</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.get_errvar_dataframe">get_errvar_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.get_identifiability_dataframe">get_identifiability_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.get_null_proj">get_null_proj</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.omitted_jco">omitted_jco</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.omitted_parcov">omitted_parcov</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.omitted_predictions">omitted_predictions</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.second_forecast">second_forecast</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.second_parameter">second_parameter</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.second_prediction">second_prediction</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.third_forecast">third_forecast</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.third_parameter">third_parameter</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.third_prediction">third_prediction</a></li>
<li><a class="reference internal" href="#pyemu.ErrVar.variance_at">variance_at</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.Jco">Jco</a><ul>
<li><a class="reference internal" href="#pyemu.Jco.from_pst">from_pst</a></li>
<li><a class="reference internal" href="#pyemu.Jco.nobs">nobs</a></li>
<li><a class="reference internal" href="#pyemu.Jco.npar">npar</a></li>
<li><a class="reference internal" href="#pyemu.Jco.obs_names">obs_names</a></li>
<li><a class="reference internal" href="#pyemu.Jco.par_names">par_names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis">LinearAnalysis</a><ul>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.adj_par_names">adj_par_names</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.adjust_obscov_resfile">adjust_obscov_resfile</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.apply_karhunen_loeve_scaling">apply_karhunen_loeve_scaling</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.clean">clean</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.drop_prior_information">drop_prior_information</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.fehalf">fehalf</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.forecast_names">forecast_names</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.forecasts">forecasts</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.forecasts_iter">forecasts_iter</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.get">get</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.get_cso_dataframe">get_cso_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.get_obs_competition_dataframe">get_obs_competition_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.get_par_css_dataframe">get_par_css_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.jco">jco</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.mle_covariance">mle_covariance</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.mle_parameter_estimate">mle_parameter_estimate</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.nnz_obs_names">nnz_obs_names</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.obscov">obscov</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.parcov">parcov</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.predictions">predictions</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.predictions_iter">predictions_iter</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.prior_forecast">prior_forecast</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.prior_parameter">prior_parameter</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.prior_prediction">prior_prediction</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.pst">pst</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.qhalf">qhalf</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.qhalfx">qhalfx</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.reset_obscov">reset_obscov</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.reset_parcov">reset_parcov</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.reset_pst">reset_pst</a></li>
<li><a class="reference internal" href="#pyemu.LinearAnalysis.xtqx">xtqx</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.Matrix">Matrix</a><ul>
<li><a class="reference internal" href="#pyemu.Matrix.T">T</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.align">align</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.as_2d">as_2d</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.binary_header_dt">binary_header_dt</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.binary_rec_dt">binary_rec_dt</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.char">char</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.coo_rec_dt">coo_rec_dt</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.copy">copy</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.df">df</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.double">double</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.drop">drop</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.element_isaligned">element_isaligned</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.extend">extend</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.extract">extract</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.find_rowcol_indices">find_rowcol_indices</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.from_ascii">from_ascii</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.from_binary">from_binary</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.from_dataframe">from_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.from_fortranfile">from_fortranfile</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.from_names">from_names</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.full_s">full_s</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.get">get</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.get_diagonal_vector">get_diagonal_vector</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.get_maxsing">get_maxsing</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.get_maxsing_from_s">get_maxsing_from_s</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.hadamard_product">hadamard_product</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.indices">indices</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.integer">integer</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.inv">inv</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.mult_isaligned">mult_isaligned</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.ncol">ncol</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.new_obs_length">new_obs_length</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.new_par_length">new_par_length</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.newx">newx</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.nrow">nrow</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.obs_length">obs_length</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.par_length">par_length</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.pseudo_inv">pseudo_inv</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.pseudo_inv_components">pseudo_inv_components</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.read_ascii">read_ascii</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.read_binary">read_binary</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.reset_x">reset_x</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.s">s</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.shape">shape</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.sqrt">sqrt</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.to_2d">to_2d</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.to_ascii">to_ascii</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.to_binary">to_binary</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.to_coo">to_coo</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.to_dataframe">to_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.transpose">transpose</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.u">u</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.v">v</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.x">x</a></li>
<li><a class="reference internal" href="#pyemu.Matrix.zero2d">zero2d</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.ObservationEnsemble">ObservationEnsemble</a><ul>
<li><a class="reference internal" href="#pyemu.ObservationEnsemble.add_base">add_base</a></li>
<li><a class="reference internal" href="#pyemu.ObservationEnsemble.from_gaussian_draw">from_gaussian_draw</a></li>
<li><a class="reference internal" href="#pyemu.ObservationEnsemble.nonzero">nonzero</a></li>
<li><a class="reference internal" href="#pyemu.ObservationEnsemble.phi_vector">phi_vector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble">ParameterEnsemble</a><ul>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.add_base">add_base</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.adj_names">adj_names</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.back_transform">back_transform</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.enforce">enforce</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.fixed_indexer">fixed_indexer</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.from_gaussian_draw">from_gaussian_draw</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.from_mixed_draws">from_mixed_draws</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.from_parfiles">from_parfiles</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.from_triangular_draw">from_triangular_draw</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.from_uniform_draw">from_uniform_draw</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.lbnd">lbnd</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.log_indexer">log_indexer</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.project">project</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.transform">transform</a></li>
<li><a class="reference internal" href="#pyemu.ParameterEnsemble.ubnd">ubnd</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.Pst">Pst</a><ul>
<li><a class="reference internal" href="#pyemu.Pst.add_observations">add_observations</a></li>
<li><a class="reference internal" href="#pyemu.Pst.add_parameters">add_parameters</a></li>
<li><a class="reference internal" href="#pyemu.Pst.add_pi_equation">add_pi_equation</a></li>
<li><a class="reference internal" href="#pyemu.Pst.add_transform_columns">add_transform_columns</a></li>
<li><a class="reference internal" href="#pyemu.Pst.adj_par_groups">adj_par_groups</a></li>
<li><a class="reference internal" href="#pyemu.Pst.adj_par_names">adj_par_names</a></li>
<li><a class="reference internal" href="#pyemu.Pst.adjust_weights">adjust_weights</a></li>
<li><a class="reference internal" href="#pyemu.Pst.adjust_weights_discrepancy">adjust_weights_discrepancy</a></li>
<li><a class="reference internal" href="#pyemu.Pst.bounds_report">bounds_report</a></li>
<li><a class="reference internal" href="#pyemu.Pst.build_increments">build_increments</a></li>
<li><a class="reference internal" href="#pyemu.Pst.calculate_pertubations">calculate_pertubations</a></li>
<li><a class="reference internal" href="#pyemu.Pst.control_data">control_data</a></li>
<li><a class="reference internal" href="#pyemu.Pst.enforce_bounds">enforce_bounds</a></li>
<li><a class="reference internal" href="#pyemu.Pst.estimation">estimation</a></li>
<li><a class="reference internal" href="#pyemu.Pst.forecast_names">forecast_names</a></li>
<li><a class="reference internal" href="#pyemu.Pst.from_io_files">from_io_files</a></li>
<li><a class="reference internal" href="#pyemu.Pst.from_par_obs_names">from_par_obs_names</a></li>
<li><a class="reference internal" href="#pyemu.Pst.get">get</a></li>
<li><a class="reference internal" href="#pyemu.Pst.get_adj_pars_at_bounds">get_adj_pars_at_bounds</a></li>
<li><a class="reference internal" href="#pyemu.Pst.get_par_change_limits">get_par_change_limits</a></li>
<li><a class="reference internal" href="#pyemu.Pst.get_res_stats">get_res_stats</a></li>
<li><a class="reference internal" href="#pyemu.Pst.greater_than_obs_constraints">greater_than_obs_constraints</a></li>
<li><a class="reference internal" href="#pyemu.Pst.greater_than_pi_constraints">greater_than_pi_constraints</a></li>
<li><a class="reference internal" href="#pyemu.Pst.less_than_obs_constraints">less_than_obs_constraints</a></li>
<li><a class="reference internal" href="#pyemu.Pst.less_than_pi_constraints">less_than_pi_constraints</a></li>
<li><a class="reference internal" href="#pyemu.Pst.load">load</a></li>
<li><a class="reference internal" href="#pyemu.Pst.nnz_obs">nnz_obs</a></li>
<li><a class="reference internal" href="#pyemu.Pst.nnz_obs_groups">nnz_obs_groups</a></li>
<li><a class="reference internal" href="#pyemu.Pst.nnz_obs_names">nnz_obs_names</a></li>
<li><a class="reference internal" href="#pyemu.Pst.nobs">nobs</a></li>
<li><a class="reference internal" href="#pyemu.Pst.npar">npar</a></li>
<li><a class="reference internal" href="#pyemu.Pst.npar_adj">npar_adj</a></li>
<li><a class="reference internal" href="#pyemu.Pst.nprior">nprior</a></li>
<li><a class="reference internal" href="#pyemu.Pst.obs_groups">obs_groups</a></li>
<li><a class="reference internal" href="#pyemu.Pst.obs_names">obs_names</a></li>
<li><a class="reference internal" href="#pyemu.Pst.observation_data">observation_data</a></li>
<li><a class="reference internal" href="#pyemu.Pst.par_groups">par_groups</a></li>
<li><a class="reference internal" href="#pyemu.Pst.par_names">par_names</a></li>
<li><a class="reference internal" href="#pyemu.Pst.parameter_data">parameter_data</a></li>
<li><a class="reference internal" href="#pyemu.Pst.parrep">parrep</a></li>
<li><a class="reference internal" href="#pyemu.Pst.phi">phi</a></li>
<li><a class="reference internal" href="#pyemu.Pst.phi_components">phi_components</a></li>
<li><a class="reference internal" href="#pyemu.Pst.phi_components_normalized">phi_components_normalized</a></li>
<li><a class="reference internal" href="#pyemu.Pst.plot">plot</a></li>
<li><a class="reference internal" href="#pyemu.Pst.prior_groups">prior_groups</a></li>
<li><a class="reference internal" href="#pyemu.Pst.prior_information">prior_information</a></li>
<li><a class="reference internal" href="#pyemu.Pst.prior_names">prior_names</a></li>
<li><a class="reference internal" href="#pyemu.Pst.process_output_files">process_output_files</a></li>
<li><a class="reference internal" href="#pyemu.Pst.proportional_weights">proportional_weights</a></li>
<li><a class="reference internal" href="#pyemu.Pst.rectify_pgroups">rectify_pgroups</a></li>
<li><a class="reference internal" href="#pyemu.Pst.rectify_pi">rectify_pi</a></li>
<li><a class="reference internal" href="#pyemu.Pst.reg_data">reg_data</a></li>
<li><a class="reference internal" href="#pyemu.Pst.res">res</a></li>
<li><a class="reference internal" href="#pyemu.Pst.sanity_checks">sanity_checks</a></li>
<li><a class="reference internal" href="#pyemu.Pst.set_res">set_res</a></li>
<li><a class="reference internal" href="#pyemu.Pst.svd_data">svd_data</a></li>
<li><a class="reference internal" href="#pyemu.Pst.tied">tied</a></li>
<li><a class="reference internal" href="#pyemu.Pst.try_parse_name_metadata">try_parse_name_metadata</a></li>
<li><a class="reference internal" href="#pyemu.Pst.write">write</a></li>
<li><a class="reference internal" href="#pyemu.Pst.write_input_files">write_input_files</a></li>
<li><a class="reference internal" href="#pyemu.Pst.write_obs_summary_table">write_obs_summary_table</a></li>
<li><a class="reference internal" href="#pyemu.Pst.write_par_summary_table">write_par_summary_table</a></li>
<li><a class="reference internal" href="#pyemu.Pst.zero_weight_obs_names">zero_weight_obs_names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.Schur">Schur</a><ul>
<li><a class="reference internal" href="#pyemu.Schur.get_added_obs_group_importance">get_added_obs_group_importance</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_added_obs_importance">get_added_obs_importance</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_conditional_instance">get_conditional_instance</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_forecast_summary">get_forecast_summary</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_obs_group_dict">get_obs_group_dict</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_par_contribution">get_par_contribution</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_par_group_contribution">get_par_group_contribution</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_parameter_summary">get_parameter_summary</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_removed_obs_group_importance">get_removed_obs_group_importance</a></li>
<li><a class="reference internal" href="#pyemu.Schur.get_removed_obs_importance">get_removed_obs_importance</a></li>
<li><a class="reference internal" href="#pyemu.Schur.next_most_important_added_obs">next_most_important_added_obs</a></li>
<li><a class="reference internal" href="#pyemu.Schur.next_most_par_contribution">next_most_par_contribution</a></li>
<li><a class="reference internal" href="#pyemu.Schur.posterior_forecast">posterior_forecast</a></li>
<li><a class="reference internal" href="#pyemu.Schur.posterior_parameter">posterior_parameter</a></li>
<li><a class="reference internal" href="#pyemu.Schur.posterior_prediction">posterior_prediction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyEMU</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>pyemu package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pyemu.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pyemu-package">
<h1>pyemu package<a class="headerlink" href="#pyemu-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyemu.mat.html">pyemu.mat package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyemu.mat.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.mat.html#module-pyemu.mat.mat_handler">pyemu.mat.mat_handler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.mat.html#module-pyemu.mat">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov">Cov</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.condition_on">condition_on</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.from_observation_data">from_observation_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.from_obsweights">from_obsweights</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.from_parameter_data">from_parameter_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.from_parbounds">from_parbounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.from_uncfile">from_uncfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.identity">identity</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.identity_like">identity_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.names">names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.replace">replace</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.to_pearson">to_pearson</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.to_uncfile">to_uncfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Cov.zero">zero</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Jco">Jco</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Jco.from_pst">from_pst</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Jco.nobs">nobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Jco.npar">npar</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Jco.obs_names">obs_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Jco.par_names">par_names</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix">Matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.T">T</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.align">align</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.as_2d">as_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.binary_header_dt">binary_header_dt</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.binary_rec_dt">binary_rec_dt</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.char">char</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.coo_rec_dt">coo_rec_dt</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.copy">copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.df">df</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.double">double</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.drop">drop</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.element_isaligned">element_isaligned</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.extend">extend</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.extract">extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.find_rowcol_indices">find_rowcol_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.from_ascii">from_ascii</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.from_binary">from_binary</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.from_dataframe">from_dataframe</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.from_fortranfile">from_fortranfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.from_names">from_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.full_s">full_s</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.get">get</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.get_diagonal_vector">get_diagonal_vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.get_maxsing">get_maxsing</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.get_maxsing_from_s">get_maxsing_from_s</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.hadamard_product">hadamard_product</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.indices">indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.integer">integer</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.inv">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.mult_isaligned">mult_isaligned</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.ncol">ncol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.new_obs_length">new_obs_length</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.new_par_length">new_par_length</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.newx">newx</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.nrow">nrow</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.obs_length">obs_length</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.par_length">par_length</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.pseudo_inv">pseudo_inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.pseudo_inv_components">pseudo_inv_components</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.read_ascii">read_ascii</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.read_binary">read_binary</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.reset_x">reset_x</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.s">s</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.shape">shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.sqrt">sqrt</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.to_2d">to_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.to_ascii">to_ascii</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.to_binary">to_binary</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.to_coo">to_coo</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.to_dataframe">to_dataframe</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.transpose">transpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.u">u</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.v">v</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.x">x</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix.zero2d">zero2d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.concat">concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.get_common_elements">get_common_elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.save_coo">save_coo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyemu.plot.html">pyemu.plot package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyemu.plot.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.plot.html#module-pyemu.plot.plot_utils">pyemu.plot.plot_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.plot.html#module-pyemu.plot">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.ensemble_change_summary">ensemble_change_summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.ensemble_helper">ensemble_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.ensemble_res_1to1">ensemble_res_1to1</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.gaussian_distribution">gaussian_distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.phi_progress">phi_progress</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.plot_id_bar">plot_id_bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.plot_jac_test">plot_jac_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.plot_summary_distributions">plot_summary_distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.pst_helper">pst_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.pst_prior">pst_prior</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.res_1to1">res_1to1</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.plot.html#pyemu.plot.plot_utils.res_phi_pie">res_phi_pie</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyemu.prototypes.html">pyemu.prototypes package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyemu.prototypes.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.prototypes.html#module-pyemu.prototypes.da">pyemu.prototypes.da module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.prototypes.html#module-pyemu.prototypes.ensemble_method">pyemu.prototypes.ensemble_method module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.prototypes.html#module-pyemu.prototypes.moouu">pyemu.prototypes.moouu module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.prototypes.html#module-pyemu.prototypes">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator">Assimilator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.enkf">enkf</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.enks">enks</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.forcast">forcast</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.generate_priors">generate_priors</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.model_evalutions">model_evalutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.model_temporal_evolotion">model_temporal_evolotion</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.run">run</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.smoother">smoother</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.Assimilator.update">update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.EnsembleKalmanFilter">EnsembleKalmanFilter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.EnsembleKalmanFilter.analysis">analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.EnsembleKalmanFilter.analysis_evensen">analysis_evensen</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.EnsembleKalmanFilter.forecast">forecast</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.EnsembleKalmanFilter.initialize">initialize</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.da.EnsembleKalmanFilter.update">update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.ensemble_method.EnsembleMethod">EnsembleMethod</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.ensemble_method.EnsembleMethod.initialize">initialize</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.ensemble_method.EnsembleMethod.update">update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.EliteDiffEvol">EliteDiffEvol</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.EliteDiffEvol.iter_report">iter_report</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.EliteDiffEvol.update">update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.EvolAlg">EvolAlg</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.EvolAlg.initialize">initialize</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.EvolAlg.update">update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc">ParetoObjFunc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.crowd_distance">crowd_distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.dominates">dominates</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.get_risk_shifted_value">get_risk_shifted_value</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.is_feasible">is_feasible</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.is_nondominated_continuous">is_nondominated_continuous</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.is_nondominated_kung">is_nondominated_kung</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.is_nondominated_pathetic">is_nondominated_pathetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.obs_obj_signs">obs_obj_signs</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.prototypes.html#pyemu.prototypes.moouu.ParetoObjFunc.reduce_stack_with_risk_shift">reduce_stack_with_risk_shift</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyemu.pst.html">pyemu.pst package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#module-pyemu.pst.pst_controldata">pyemu.pst.pst_controldata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#module-pyemu.pst.pst_handler">pyemu.pst.pst_handler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#module-pyemu.pst.pst_utils">pyemu.pst.pst_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.pst.html#module-pyemu.pst">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.ControlData">ControlData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.ControlData.copy">copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.ControlData.formatted_values">formatted_values</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.ControlData.get_dataframe">get_dataframe</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.ControlData.parse_values_from_lines">parse_values_from_lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.ControlData.write">write</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.ControlData.write_keyword">write_keyword</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.FFMT">FFMT</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.IFMT">IFMT</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.RegData">RegData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.RegData.write">write</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.RegData.write_keyword">write_keyword</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.SFMT">SFMT</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.SFMT_LONG">SFMT_LONG</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.SvdData">SvdData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.SvdData.parse_values_from_lines">parse_values_from_lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.SvdData.write">write</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.SvdData.write_keyword">write_keyword</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst">Pst</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.add_observations">add_observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.add_parameters">add_parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.add_pi_equation">add_pi_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.add_transform_columns">add_transform_columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.adj_par_groups">adj_par_groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.adj_par_names">adj_par_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.adjust_weights">adjust_weights</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.adjust_weights_discrepancy">adjust_weights_discrepancy</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.bounds_report">bounds_report</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.build_increments">build_increments</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.calculate_pertubations">calculate_pertubations</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.control_data">control_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.enforce_bounds">enforce_bounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.estimation">estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.forecast_names">forecast_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.from_io_files">from_io_files</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.from_par_obs_names">from_par_obs_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.get">get</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.get_adj_pars_at_bounds">get_adj_pars_at_bounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.get_par_change_limits">get_par_change_limits</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.get_res_stats">get_res_stats</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.greater_than_obs_constraints">greater_than_obs_constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.greater_than_pi_constraints">greater_than_pi_constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.less_than_obs_constraints">less_than_obs_constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.less_than_pi_constraints">less_than_pi_constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.load">load</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.nnz_obs">nnz_obs</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.nnz_obs_groups">nnz_obs_groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.nnz_obs_names">nnz_obs_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.nobs">nobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.npar">npar</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.npar_adj">npar_adj</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.nprior">nprior</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.obs_groups">obs_groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.obs_names">obs_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.observation_data">observation_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.par_groups">par_groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.par_names">par_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.parameter_data">parameter_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.parrep">parrep</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.phi">phi</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.phi_components">phi_components</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.phi_components_normalized">phi_components_normalized</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.plot">plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.prior_groups">prior_groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.prior_information">prior_information</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.prior_names">prior_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.process_output_files">process_output_files</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.proportional_weights">proportional_weights</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.rectify_pgroups">rectify_pgroups</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.rectify_pi">rectify_pi</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.reg_data">reg_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.res">res</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.sanity_checks">sanity_checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.set_res">set_res</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.svd_data">svd_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.tied">tied</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.try_parse_name_metadata">try_parse_name_metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.write">write</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.write_input_files">write_input_files</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.write_obs_summary_table">write_obs_summary_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.write_par_summary_table">write_par_summary_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_handler.Pst.zero_weight_obs_names">zero_weight_obs_names</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.FFMT">FFMT</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.IFMT">IFMT</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.InstructionFile">InstructionFile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.InstructionFile.obs_name_set">obs_name_set</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.InstructionFile.read_ins_file">read_ins_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.InstructionFile.read_output_file">read_output_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.InstructionFile.throw_ins_error">throw_ins_error</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.InstructionFile.throw_ins_warning">throw_ins_warning</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.InstructionFile.throw_out_error">throw_out_error</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.SFMT">SFMT</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.SFMT_LONG">SFMT_LONG</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.clean_missing_exponent">clean_missing_exponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.csv_to_ins_file">csv_to_ins_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.generic_pst">generic_pst</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.get_phi_comps_from_recfile">get_phi_comps_from_recfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.parse_ins_file">parse_ins_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.parse_tpl_file">parse_tpl_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.process_output_files">process_output_files</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.read_parfile">read_parfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.read_resfile">read_resfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.res_from_en">res_from_en</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.res_from_obseravtion_data">res_from_obseravtion_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.str_con">str_con</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.try_process_output_file">try_process_output_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.try_process_output_pst">try_process_output_pst</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.write_input_files">write_input_files</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.write_parfile">write_parfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_utils.write_to_template">write_to_template</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyemu.utils.html">pyemu.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.geostats">pyemu.utils.geostats module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.gw_utils">pyemu.utils.gw_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.helpers">pyemu.utils.helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.optimization">pyemu.utils.optimization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.os_utils">pyemu.utils.os_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.pp_utils">pyemu.utils.pp_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.pst_from">pyemu.utils.pst_from module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils.smp_utils">pyemu.utils.smp_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyemu.utils.html#module-pyemu.utils">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.ExpVario">ExpVario</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GauVario">GauVario</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct">GeoStruct</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.covariance">covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.covariance_matrix">covariance_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.covariance_points">covariance_points</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.nugget">nugget</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.plot">plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.same_as_other">same_as_other</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.sill">sill</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.to_struct_file">to_struct_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.transform">transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.GeoStruct.variograms">variograms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.OrdinaryKrige">OrdinaryKrige</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.OrdinaryKrige.calc_factors">calc_factors</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.OrdinaryKrige.calc_factors_grid">calc_factors_grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.OrdinaryKrige.check_point_data_dist">check_point_data_dist</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.OrdinaryKrige.to_grid_factors_file">to_grid_factors_file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.SpecSim2d">SpecSim2d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.SpecSim2d.draw_arrays">draw_arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.SpecSim2d.draw_conditional">draw_conditional</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.SpecSim2d.grid_is_regular">grid_is_regular</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.SpecSim2d.grid_par_ensemble_helper">grid_par_ensemble_helper</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.SpecSim2d.initialize">initialize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.SphVario">SphVario</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d">Vario2d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.bearing_rads">bearing_rads</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.covariance">covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.covariance_matrix">covariance_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.covariance_points">covariance_points</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.inv_h">inv_h</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.plot">plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.rotation_coefs">rotation_coefs</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.same_as_other">same_as_other</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.Vario2d.to_struct_file">to_struct_file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.fac2real">fac2real</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.gslib_2_dataframe">gslib_2_dataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.load_sgems_exp_var">load_sgems_exp_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.read_sgems_variogram_xml">read_sgems_variogram_xml</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.geostats.read_struct_file">read_struct_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_gage_obs">apply_gage_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_hds_obs">apply_hds_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_hds_timeseries">apply_hds_timeseries</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_hfb_pars">apply_hfb_pars</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_mflist_budget_obs">apply_mflist_budget_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_mtlist_budget_obs">apply_mtlist_budget_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_sfr_obs">apply_sfr_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_sfr_parameters">apply_sfr_parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_sfr_reach_obs">apply_sfr_reach_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_sfr_seg_parameters">apply_sfr_seg_parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.apply_sft_obs">apply_sft_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.last_kstp_from_kper">last_kstp_from_kper</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.load_sfr_out">load_sfr_out</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.modflow_hob_to_instruction_file">modflow_hob_to_instruction_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.modflow_hydmod_to_instruction_file">modflow_hydmod_to_instruction_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.modflow_pval_to_template_file">modflow_pval_to_template_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.modflow_read_hydmod_file">modflow_read_hydmod_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.modflow_sfr_gag_to_instruction_file">modflow_sfr_gag_to_instruction_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_gage_obs">setup_gage_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_hds_obs">setup_hds_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_hds_timeseries">setup_hds_timeseries</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_mflist_budget_obs">setup_mflist_budget_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_mtlist_budget_obs">setup_mtlist_budget_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_sfr_obs">setup_sfr_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_sfr_reach_obs">setup_sfr_reach_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_sfr_reach_parameters">setup_sfr_reach_parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_sfr_seg_parameters">setup_sfr_seg_parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.setup_sft_obs">setup_sft_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.write_hfb_template">write_hfb_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.gw_utils.write_hfb_zone_multipliers_template">write_hfb_zone_multipliers_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.PstFromFlopyModel">PstFromFlopyModel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.PstFromFlopyModel.build_prior">build_prior</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.PstFromFlopyModel.build_pst">build_pst</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.PstFromFlopyModel.draw">draw</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.PstFromFlopyModel.write_forward_run">write_forward_run</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference">SpatialReference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.xedge">xedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.yedge">yedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.xgrid">xgrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.ygrid">ygrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.xcenter">xcenter</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.ycenter">ycenter</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.xcentergrid">xcentergrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.ycentergrid">ycentergrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.vertices">vertices</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.attribs_from_namfile_header">attribs_from_namfile_header</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.attribute_dict">attribute_dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.bounds">bounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.defaults">defaults</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.epsg">epsg</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.from_gridspec">from_gridspec</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.from_namfile">from_namfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_extent">get_extent</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_grid_lines">get_grid_lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_ij">get_ij</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_rc">get_rc</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_vertices">get_vertices</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_xcenter_array">get_xcenter_array</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_xedge_array">get_xedge_array</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_ycenter_array">get_ycenter_array</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.get_yedge_array">get_yedge_array</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.length_multiplier">length_multiplier</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.lenuni">lenuni</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.lenuni_text">lenuni_text</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.lenuni_values">lenuni_values</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.load">load</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.model_length_units">model_length_units</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.ncol">ncol</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.nrow">nrow</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.origin_loc">origin_loc</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.proj4_str">proj4_str</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.read_usgs_model_reference_file">read_usgs_model_reference_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.reset">reset</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.rotate">rotate</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.rotation">rotation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.set_spatialreference">set_spatialreference</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.theta">theta</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.transform">transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.units">units</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id0">vertices</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.write_gridspec">write_gridspec</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id1">xcenter</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id2">xcentergrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id3">xedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id4">xgrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.xll">xll</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.xul">xul</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id5">ycenter</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id6">ycentergrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id7">yedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#id8">ygrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.yll">yll</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.SpatialReference.yul">yul</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.apply_array_pars">apply_array_pars</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.apply_genericlist_pars">apply_genericlist_pars</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.apply_list_and_array_pars">apply_list_and_array_pars</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.apply_list_pars">apply_list_pars</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.apply_temporal_diff_obs">apply_temporal_diff_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.build_jac_test_csv">build_jac_test_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.calc_observation_ensemble_quantiles">calc_observation_ensemble_quantiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.calc_rmse_ensemble">calc_rmse_ensemble</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.first_order_pearson_tikhonov">first_order_pearson_tikhonov</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.geostatistical_draws">geostatistical_draws</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.geostatistical_prior_builder">geostatistical_prior_builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.get_maha_obs_summary">get_maha_obs_summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.jco_from_pestpp_runstorage">jco_from_pestpp_runstorage</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.kl_apply">kl_apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.kl_setup">kl_setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.parse_dir_for_io_files">parse_dir_for_io_files</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.pst_from_io_files">pst_from_io_files</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.pst_from_parnames_obsnames">pst_from_parnames_obsnames</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.read_pestpp_runstorage">read_pestpp_runstorage</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.setup_fake_forward_run">setup_fake_forward_run</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.setup_temporal_diff_obs">setup_temporal_diff_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.simple_ins_from_obs">simple_ins_from_obs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.simple_tpl_from_pars">simple_tpl_from_pars</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.write_const_tpl">write_const_tpl</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.write_grid_tpl">write_grid_tpl</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.write_zone_tpl">write_zone_tpl</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.helpers.zero_order_tikhonov">zero_order_tikhonov</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.optimization.add_pi_obj_func">add_pi_obj_func</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.os_utils.run">run</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.os_utils.start_workers">start_workers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pp_utils.pilot_points_to_tpl">pilot_points_to_tpl</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pp_utils.pp_file_to_dataframe">pp_file_to_dataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pp_utils.pp_tpl_to_dataframe">pp_tpl_to_dataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pp_utils.setup_pilotpoints_grid">setup_pilotpoints_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pp_utils.write_pp_file">write_pp_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pp_utils.write_pp_shapfile">write_pp_shapfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom">PstFrom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.add_observations">add_observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.add_observations_from_ins">add_observations_from_ins</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.add_parameters">add_parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.add_py_function">add_py_function</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.build_prior">build_prior</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.build_pst">build_pst</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.draw">draw</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.initialize_spatial_reference">initialize_spatial_reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.parfile_relations">parfile_relations</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.parse_kij_args">parse_kij_args</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.PstFrom.write_forward_run">write_forward_run</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.write_array_tpl">write_array_tpl</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.pst_from.write_list_tpl">write_list_tpl</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.smp_utils.dataframe_to_smp">dataframe_to_smp</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.smp_utils.smp_to_dataframe">smp_to_dataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyemu.utils.html#pyemu.utils.smp_utils.smp_to_ins">smp_to_ins</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyemu.en">
<span id="pyemu-en-module"></span><h2>pyemu.en module<a class="headerlink" href="#module-pyemu.en" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyemu.en.Ensemble">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.en.</code><code class="sig-name descname">Ensemble</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">istransformed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>based class for handling ensembles of numeric values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>df</strong> (<cite>pandas.DataFrame</cite>) – a pandas dataframe.  Columns
should be parameter/observation names.  Index is
treated as realization names</p></li>
<li><p><strong>istransformed</strong> (<cite>bool</cite>) – flag to indicate parameter values
are in log space.  Not used for <cite>ObservationEnsemble</cite></p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.en.Ensemble.as_pyemu_matrix">
<code class="sig-name descname">as_pyemu_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">typ</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.as_pyemu_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>get a <cite>pyemu.Matrix</cite> instance of <cite>Ensemble</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>typ</strong> (<cite>pyemu.Matrix</cite> or <cite>pyemu.Cov</cite>) – the type of matrix to return.
Default is <cite>pyemu.Matrix</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a matrix instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">oe</span><span class="o">.</span><span class="n">add_base</span><span class="p">()</span>
<span class="n">oe_dev</span> <span class="o">=</span> <span class="n">oe</span><span class="o">.</span><span class="n">get_deviations</span><span class="p">(</span><span class="n">center_on</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">)</span>
<span class="n">oe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;obs_base_devs.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.back_transform">
<code class="sig-name descname">back_transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.back_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>back transform parameters with respect to <cite>partrans</cite> value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place (None is returned).</p>
<p>Parameter transform is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
<p><cite>Ensemble.back_transform() is only provided for inhertance purposes.
It only changes the `Ensemble._transformed</cite> flag</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>get a copy of <cite>Ensemble</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>copy of this <cite>Ensemble</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Ensemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>copies both <cite>Ensemble.pst</cite> and <cite>Ensemble._df</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.covariance_matrix">
<code class="sig-name descname">covariance_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">localizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">center_on</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>get a empirical covariance matrix implied by the
correlations between realizations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>localizer</strong> (<cite>pyemu.Matrix</cite>, optional) – a matrix to localize covariates
in the resulting covariance matrix.  Default is None</p></li>
<li><p><strong>center_on</strong> (<cite>str</cite>, optional) – a realization name to use as the centering
point in ensemble space.  If <cite>None</cite>, the mean vector is
treated as the centering point.  Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the empirical (and optionally localized) covariance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.dropna">
<code class="sig-name descname">dropna</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.dropna" title="Permalink to this definition">¶</a></dt>
<dd><p>override of <cite>pandas.DataFrame.dropna()</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>[</strong><strong>object</strong><strong>]</strong> (<em>*args</em>) – positional arguments to pass to
<cite>pandas.DataFrame.dropna()</cite>.</p></li>
<li><p><strong>(</strong><strong>{str</strong> (<em>**kwargs</em>) – <cite>object</cite>}): keyword arguments to pass
to <cite>pandas.DataFrame.dropna()</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.from_binary">
<em class="property">classmethod </em><code class="sig-name descname">from_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.from_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>create an <cite>Ensemble</cite> from a PEST-style binary file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – filename containing binary ensemble</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the ensembled loaded from the binary file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Ensemble</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_binary</span><span class="p">(</span><span class="s2">&quot;obs.jcb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.from_csv">
<em class="property">classmethod </em><code class="sig-name descname">from_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>create an <cite>Ensemble</cite> from a CSV file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – filename containing CSV ensemble</p></li>
<li><p><strong>(</strong><strong>[</strong><strong>object</strong><strong>]</strong> (<em>*args</em>) – positional arguments to pass to
<cite>pandas.read_csv()</cite>.</p></li>
<li><p><strong>(</strong><strong>{str</strong> (<em>**kwargs</em>) – <cite>object</cite>}): keyword arguments to pass
to <cite>pandas.read_csv()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>Ensemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>uses <cite>pandas.read_csv()</cite> to load numeric values from
CSV file</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s2">&quot;obs.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.from_dataframe">
<em class="property">classmethod </em><code class="sig-name descname">from_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">istransformed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.get_deviations">
<code class="sig-name descname">get_deviations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">center_on</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.get_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>get the deviations of the realizations around a certain
point in ensemble space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>center_on</strong> (<cite>str</cite>, optional) – a realization name to use as the centering
point in ensemble space.  If <cite>None</cite>, the mean vector is
treated as the centering point.  Default is None</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an ensemble of deviations around the centering point</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Ensemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>deviations are the Euclidean distances from the <cite>center_on</cite> value to
realized values for each column</p>
<p><cite>center_on=None</cite> yields the classic ensemble smoother/ensemble Kalman
filter deviations</p>
<p>Deviations respect log-transformation status.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.istransformed">
<em class="property">property </em><code class="sig-name descname">istransformed</code><a class="headerlink" href="#pyemu.en.Ensemble.istransformed" title="Permalink to this definition">¶</a></dt>
<dd><p>the parameter transformation status</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flag to indicate whether or not the <cite>ParameterEnsemble</cite> is
transformed with respect to log_{10}.  Not used for (and has no effect
on) <cite>ObservationEnsemble</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>bool</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>parameter transformation status is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">facecolor</span><span class="o">=</span><span class="default_value">'0.5'</span></em>, <em class="sig-param"><span class="n">plot_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'ensemble.pdf'</span></em>, <em class="sig-param"><span class="n">func_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>plot ensemble histograms to multipage pdf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> (<cite>int</cite>) – number of bins for the histograms</p></li>
<li><p><strong>facecolor</strong> (<cite>str</cite>) – matplotlib color (e.g. <cite>r</cite>,`g`, etc)</p></li>
<li><p><strong>plot_cols</strong> ([<cite>str</cite>]) – list of subset of ensemble columns to plot.
If None, all are plotted. Default is None</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – multipage pdf filename. Default is “ensemble.pdf”</p></li>
<li><p><strong>func_dict</strong> (<cite>dict</cite>) – a dict of functions to apply to specific
columns. For example: {“par1”: np.log10}</p></li>
<li><p><strong>**kwargs</strong> (<cite>dict</cite>) – addkeyword args to pass to <cite>pyemu.plot_utils.ensemble_helper()</cite></p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span> <span class="c1"># plot log space (if needed)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.en.Ensemble.pst">
<code class="sig-name descname">pst</code><a class="headerlink" href="#pyemu.en.Ensemble.pst" title="Permalink to this definition">¶</a></dt>
<dd><p>control file instance</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>pyemu.Pst</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.reseed">
<em class="property">static </em><code class="sig-name descname">reseed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.reseed" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the <cite>numpy.random.seed</cite></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>reseeds using the pyemu.en.SEED global variable</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.to_binary">
<code class="sig-name descname">to_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.to_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>write <cite>Ensemble</cite> to a PEST-style binary file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – file to write</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">oe</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s2">&quot;obs.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>back transforms <cite>ParameterEnsemble</cite> before writing so that
values are in arithmatic space</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.to_csv">
<code class="sig-name descname">to_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>write <cite>Ensemble</cite> to a CSV file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – file to write</p></li>
<li><p><strong>(</strong><strong>[</strong><strong>object</strong><strong>]</strong> (<em>*args</em>) – positional arguments to pass to
<cite>pandas.DataFrame.to_csv()</cite>.</p></li>
<li><p><strong>(</strong><strong>{str</strong> (<em>**kwargs</em>) – <cite>object</cite>}): keyword arguments to pass
to <cite>pandas.DataFrame.to_csv()</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">oe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;obs.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>back transforms <cite>ParameterEnsemble</cite> before writing so that
values are in arithmatic space</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.Ensemble.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Ensemble.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transform parameters with respect to <cite>partrans</cite> value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place (None is returned).</p>
<p>Parameter transform is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
<p><cite>Ensemble.transform() is only provided for inhertance purposes.
It only changes the `Ensemble._transformed</cite> flag</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.en.Iloc">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.en.</code><code class="sig-name descname">Iloc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ensemble</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Iloc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>thin wrapper around <cite>pandas.DataFrame.iloc</cite> to make sure returned type
is <cite>Ensemble</cite> (instead of <cite>pandas.DataFrame)</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ensemble</strong> (<cite>pyemu.Ensemble</cite>) – an ensemble instance</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users do not need to mess with this class - it is added
to each <cite>Ensemble</cite> instance</p>
</div>
</dd></dl>

<dl class="py class">
<dt id="pyemu.en.Loc">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.en.</code><code class="sig-name descname">Loc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ensemble</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.Loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>thin wrapper around <cite>pandas.DataFrame.loc</cite> to make sure returned type
is <cite>Ensemble</cite> (instead of <cite>pandas.DataFrame)</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ensemble</strong> (<cite>pyemu.Ensemble</cite>) – an ensemble instance</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users do not need to mess with this class - it is added
to each <cite>Ensemble</cite> instance</p>
</div>
</dd></dl>

<dl class="py class">
<dt id="pyemu.en.ObservationEnsemble">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.en.</code><code class="sig-name descname">ObservationEnsemble</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">istransformed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ObservationEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.en.Ensemble</span></code></a></p>
<p>Observation noise ensemble in the PEST(++) realm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>df</strong> (<cite>pandas.DataFrame</cite>) – a pandas dataframe.  Columns
should be observation names.  Index is
treated as realization names</p></li>
<li><p><strong>istransformed</strong> (<cite>bool</cite>) – flag to indicate parameter values
are in log space.  Not used for <cite>ObservationEnsemble</cite></p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.en.ObservationEnsemble.add_base">
<code class="sig-name descname">add_base</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ObservationEnsemble.add_base" title="Permalink to this definition">¶</a></dt>
<dd><p>add the control file <cite>obsval</cite> values as a realization</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>replaces the last realization with the current <cite>ObservationEnsemble.pst.observation_data.obsval</cite> values</dt><dd><p>as a new realization named “base”</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ObservationEnsemble.from_gaussian_draw">
<em class="property">classmethod </em><code class="sig-name descname">from_gaussian_draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">by_groups</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">factor</span><span class="o">=</span><span class="default_value">'eigen'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ObservationEnsemble.from_gaussian_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>generate an <cite>ObservationEnsemble</cite> from a (multivariate) gaussian
distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance.</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – a covariance matrix describing the second
moment of the gaussian distribution.  If None, <cite>cov</cite> is
generated from the non-zero-weighted observation weights in <cite>pst</cite>.
Only observations listed in <cite>cov</cite> are sampled.  Other observations are
assigned the <cite>obsval</cite> value from <cite>pst</cite>.</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of stochastic realizations to generate.  Default
is 100</p></li>
<li><p><strong>by_groups</strong> (<cite>bool</cite>) – flag to generate realzations be observation group.  This
assumes no correlation (covariates) between observation groups.</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in zero-weighted observations with control file
values.  Default is False.</p></li>
<li><p><strong>factor</strong> (<cite>str</cite>) – how to factorize <cite>cov</cite> to form the projectin matrix.  Can
be “eigen” or “svd”. The “eigen” option is default and is faster.  But
for (nearly) singular cov matrices (such as those generated empirically
from ensembles), “svd” is the only way.  Ignored for diagonal <cite>cov</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the realized <cite>ObservationEnsemble</cite> instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ObservationEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only observations named in <cite>cov</cite> are sampled. Additional, <cite>cov</cite> is processed prior
to sampling to only include non-zero-weighted observations depending on the value of <cite>fill</cite>.
So users must take care to make sure observations have been assigned non-zero weights even if <cite>cov</cite>
is being passed</p>
<p>The default <cite>cov</cite> is generated from <cite>pyemu.Cov.from_observation_data</cite>, which assumes
observation noise standard deviations are the inverse of the weights listed in <cite>pst</cite></p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="c1"># the easiest way - just relying on weights in pst</span>
<span class="n">oe1</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>

<span class="c1"># generate the cov explicitly</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_observation_data</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">oe2</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">cov</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>

<span class="c1"># give all but one observation zero weight.  This will</span>
<span class="c1"># result in an oe with only one randomly sampled observation noise</span>
<span class="c1"># vector since the cov is processed to remove any zero-weighted</span>
<span class="c1"># observations before sampling</span>
<span class="n">pst</span><span class="o">.</span><span class="n">observation_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pst</span><span class="o">.</span><span class="n">nnz_obs_names</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="s2">&quot;weight] = 0.0</span>
<span class="n">oe3</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">cov</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ObservationEnsemble.nonzero">
<em class="property">property </em><code class="sig-name descname">nonzero</code><a class="headerlink" href="#pyemu.en.ObservationEnsemble.nonzero" title="Permalink to this definition">¶</a></dt>
<dd><p>get a new <cite>ObservationEnsemble</cite> of just non-zero weighted observations</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>non-zero weighted observation ensemble.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>ObservationEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>pst</cite> attribute of the returned <cite>ObservationEnsemble</cite> also only includes
non-zero weighted observations (and is therefore not valid for running
with PEST or PEST++)</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ObservationEnsemble.phi_vector">
<em class="property">property </em><code class="sig-name descname">phi_vector</code><a class="headerlink" href="#pyemu.en.ObservationEnsemble.phi_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>vector of L2 norm (phi) for the realizations (rows) of <cite>Ensemble</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>series of realization name (<cite>Ensemble.index</cite>) and phi values</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ObservationEnsemble.pst.weights can be updated prior to calling
this method to evaluate new weighting strategies</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.en.ParameterEnsemble">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.en.</code><code class="sig-name descname">ParameterEnsemble</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">istransformed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.en.Ensemble</span></code></a></p>
<p>Parameter ensembles in the PEST(++) realm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>df</strong> (<cite>pandas.DataFrame</cite>) – a pandas dataframe.  Columns
should be parameter names.  Index is
treated as realization names</p></li>
<li><p><strong>istransformed</strong> (<cite>bool</cite>) – flag to indicate parameter values
are in log space (if <cite>partrans</cite> is “log” in <cite>pst</cite>)</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.add_base">
<code class="sig-name descname">add_base</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.add_base" title="Permalink to this definition">¶</a></dt>
<dd><p>add the control file <cite>obsval</cite> values as a realization</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>replaces the last realization with the current <cite>ParameterEnsemble.pst.parameter_data.parval1</cite> values
as a new realization named “base”</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.adj_names">
<em class="property">property </em><code class="sig-name descname">adj_names</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.adj_names" title="Permalink to this definition">¶</a></dt>
<dd><p>the names of adjustable parameters in <cite>ParameterEnsemble</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>adjustable parameter names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.back_transform">
<code class="sig-name descname">back_transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.back_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>back transform parameters with respect to <cite>partrans</cite> value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place (None is returned).</p>
<p>Parameter transform is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.enforce">
<code class="sig-name descname">enforce</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">how</span><span class="o">=</span><span class="default_value">'reset'</span></em>, <em class="sig-param"><span class="n">bound_tol</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.enforce" title="Permalink to this definition">¶</a></dt>
<dd><p>entry point for bounds enforcement.  This gets called for the
draw method(s), so users shouldn’t need to call this</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>enforce_bounds</strong> (<cite>str</cite>) – can be ‘reset’ to reset offending values or ‘drop’ to drop
offending realizations</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">()</span>
<span class="n">pe</span><span class="o">.</span><span class="n">enforce</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;scale)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;par.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.fixed_indexer">
<em class="property">property </em><code class="sig-name descname">fixed_indexer</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.fixed_indexer" title="Permalink to this definition">¶</a></dt>
<dd><p>boolean indexer for non-adjustable parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>boolean array indicating which parameters have
<cite>partrans</cite> equal to “log” or “fixed”</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>numpy.ndarray(bool)</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.from_gaussian_draw">
<em class="property">classmethod </em><code class="sig-name descname">from_gaussian_draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">by_groups</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">factor</span><span class="o">=</span><span class="default_value">'eigen'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_gaussian_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a <cite>ParameterEnsemble</cite> from a (multivariate) (log) gaussian
distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance.</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – a covariance matrix describing the second
moment of the gaussian distribution.  If None, <cite>cov</cite> is
generated from the bounds of the adjustable parameters in <cite>pst</cite>.
the (log) width of the bounds is assumed to represent a multiple of
the parameter standard deviation (this is the <cite>sigma_range</cite> argument
that can be passed to <cite>pyemu.Cov.from_parameter_data</cite>).</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of stochastic realizations to generate.  Default
is 100</p></li>
<li><p><strong>by_groups</strong> (<cite>bool</cite>) – flag to generate realzations be parameter group.  This
assumes no correlation (covariates) between parameter groups.  For large
numbers of parameters, this help prevent memories but is slower.</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in fixed and/or tied parameters with control file
values.  Default is True.</p></li>
<li><p><strong>factor</strong> (<cite>str</cite>) – how to factorize <cite>cov</cite> to form the projectin matrix.  Can
be “eigen” or “svd”. The “eigen” option is default and is faster.  But
for (nearly) singular cov matrices (such as those generated empirically
from ensembles), “svd” is the only way.  Ignored for diagonal <cite>cov</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the parameter ensemble realized from the gaussian
distribution</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only parameters named in <cite>cov</cite> are sampled. Missing parameters are assigned values of
<cite>pst.parameter_data.parval1</cite> along the corresponding columns of <cite>ParameterEnsemble</cite>
according to the value of <cite>fill</cite>.</p>
<p>The default <cite>cov</cite> is generated from <cite>pyemu.Cov.from_observation_data</cite>, which assumes
parameter bounds in <cite>ParameterEnsemble.pst</cite> represent some multiple of parameter
standard deviations.  Additionally, the default Cov only includes adjustable
parameters (<cite>partrans</cite> not “tied” or “fixed”).</p>
<p>“tied” parameters are not sampled.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="c1"># the easiest way - just relying on weights in pst</span>
<span class="n">oe1</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>

<span class="c1"># generate the cov explicitly with a sigma_range</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_parameter_data</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">sigma_range</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">oe2</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">cov</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.from_mixed_draws">
<em class="property">classmethod </em><code class="sig-name descname">from_mixed_draws</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">how_dict</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">'gaussian'</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">enforce_bounds</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">partial</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_mixed_draws" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a <cite>ParameterEnsemble</cite> using a mixture of
distributions.  Available distributions include (log) “uniform”, (log) “triangular”,
and (log) “gaussian”. log transformation is respected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file</p></li>
<li><p><strong>how_dict</strong> (<cite>dict</cite>) – a dictionary of parameter name keys and
“how” values, where “how” can be “uniform”,”triangular”, or “gaussian”.</p></li>
<li><p><strong>default</strong> (<cite>str</cite>) – the default distribution to use for parameter not listed
in how_dict.  Default is “gaussian”.</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of realizations to draw.  Default is 100.</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – an optional Cov instance to use for drawing from gaussian distribution.
If None, and “gaussian” is listed in <cite>how_dict</cite> (and/or <cite>default</cite>), then a diagonal
covariance matrix is constructed from the parameter bounds in <cite>pst</cite> (with <cite>sigma_range</cite>).
Default is None.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – the number of standard deviations implied by the parameter bounds in the pst.
Only used if “gaussian” is in <cite>how_dict</cite> (and/or <cite>default</cite>) and <cite>cov</cite> is None.  Default is 6.</p></li>
<li><p><strong>enforce_bounds</strong> (<cite>bool</cite>) – flag to enforce parameter bounds in resulting <cite>ParameterEnsemble</cite>. Only
matters if “gaussian” is in values of <cite>how_dict</cite>.  Default is True.</p></li>
<li><p><strong>partial</strong> (<cite>bool</cite>) – flag to allow a partial ensemble (not all pars included).  If True, parameters
not name in <cite>how_dict</cite> will be sampled using the distribution named as <cite>default</cite>.
Default is <cite>False</cite>.</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in fixed and/or tied parameters with control file
values.  Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.from_parfiles">
<em class="property">classmethod </em><code class="sig-name descname">from_parfiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">parfile_names</span></em>, <em class="sig-param"><span class="n">real_names</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_parfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>create a parameter ensemble from PEST-style parameter value files.
Accepts parfiles with less than the parameters in the control
(get NaNs in the ensemble) or extra parameters in the
parfiles (get dropped)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – control file instance</p></li>
<li><p><strong>parfile_names</strong> (<cite>[str</cite>]) – par file names</p></li>
<li><p><strong>real_names</strong> (<cite>str</cite>) – optional list of realization names.
If None, a single integer counter is used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameter ensemble loaded from par files</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.from_triangular_draw">
<em class="property">classmethod </em><code class="sig-name descname">from_triangular_draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_triangular_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a <cite>ParameterEnsemble</cite> from a (multivariate) (log) triangular distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>, optional) – number of realizations to generate.  Default is 100</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in fixed and/or tied parameters with control file
values.  Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a parameter ensemble drawn from the multivariate (log) triangular
distribution defined by the parameter upper and lower bounds and initial parameter
values in <cite>pst</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>respects transformation status in <cite>pst</cite>: fixed and tied parameters are not realized,
log-transformed parameters are drawn in log space.  The returned <cite>ParameterEnsemble</cite>
is back transformed (not in log space)</p>
<p>uses numpy.random.triangular</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_triangular_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;my_tri_pe.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.from_uniform_draw">
<em class="property">classmethod </em><code class="sig-name descname">from_uniform_draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">num_reals</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.from_uniform_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a <cite>ParameterEnsemble</cite> from a (multivariate) (log) uniform
distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>, optional) – number of realizations to generate.  Default is 100</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in fixed and/or tied parameters with control file
values.  Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a parameter ensemble drawn from the multivariate (log) uniform
distribution defined by the parameter upper and lower bounds <cite>pst</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>respects transformation status in <cite>pst</cite>: fixed and tied parameters are not realized,
log-transformed parameters are drawn in log space.  The returned <cite>ParameterEnsemble</cite>
is back transformed (not in log space)</p>
<p>uses numpy.random.uniform</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_uniform_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;my_uni_pe.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.lbnd">
<em class="property">property </em><code class="sig-name descname">lbnd</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.lbnd" title="Permalink to this definition">¶</a></dt>
<dd><p>the lower bound vector while respecting current log transform status</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(log-transformed) lower parameter bounds listed in
<cite>ParameterEnsemble.pst.parameter_data.parlbnd</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.log_indexer">
<em class="property">property </em><code class="sig-name descname">log_indexer</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.log_indexer" title="Permalink to this definition">¶</a></dt>
<dd><p>boolean indexer for log transform</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>boolean array indicating which parameters are log
transformed</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>numpy.ndarray(bool)</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.project">
<code class="sig-name descname">project</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">projection_matrix</span></em>, <em class="sig-param"><span class="n">center_on</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">enforce_bounds</span><span class="o">=</span><span class="default_value">'reset'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.project" title="Permalink to this definition">¶</a></dt>
<dd><p>project the ensemble using the null-space Monte Carlo method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projection_matrix</strong> (<cite>pyemu.Matrix</cite>) – null-space projection operator.</p></li>
<li><p><strong>center_on</strong> (<cite>str</cite>) – the name of the realization to use as the centering
point for the null-space differening operation.  If <cite>center_on</cite> is <cite>None</cite>,
the <cite>ParameterEnsemble</cite> mean vector is used.  Default is <cite>None</cite></p></li>
<li><p><strong>log</strong> (<cite>pyemu.Logger</cite>, optional) – for logging progress</p></li>
<li><p><strong>enforce_bounds</strong> (<cite>str</cite>) – parameter bound enforcement option to pass to
<cite>ParameterEnsemble.enforce()</cite>.  Valid options are <cite>reset</cite>, <cite>drop</cite>,
<cite>scale</cite> or <cite>None</cite>.  Default is <cite>reset</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>untransformed, null-space projected ensemble.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ev</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ErrVar</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span> <span class="c1">#assumes my.pst exists</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pe_proj</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">get_null_proj</span><span class="p">(</span><span class="n">maxsing</span><span class="o">=</span><span class="mi">25</span><span class="p">))</span>
<span class="n">pe_proj</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;proj_par.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.en.ParameterEnsemble.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transform parameters with respect to <cite>partrans</cite> value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place (None is returned).</p>
<p>Parameter transform is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.en.ParameterEnsemble.ubnd">
<em class="property">property </em><code class="sig-name descname">ubnd</code><a class="headerlink" href="#pyemu.en.ParameterEnsemble.ubnd" title="Permalink to this definition">¶</a></dt>
<dd><p>the upper bound vector while respecting current log transform status</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(log-transformed) upper parameter bounds listed in
<cite>ParameterEnsemble.pst.parameter_data.parubnd</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.ev">
<span id="pyemu-ev-module"></span><h2>pyemu.ev module<a class="headerlink" href="#module-pyemu.ev" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyemu.ev.ErrVar">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.ev.</code><code class="sig-name descname">ErrVar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jco</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.la.LinearAnalysis</span></code></a></p>
<p>FOSM-based error variance analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jco</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast or loaded into a <cite>pyemu.Jco</cite>.  Can be a
str for a filename or <cite>pyemu.Matrix</cite>/<cite>pyemu.Jco</cite> object.</p></li>
<li><p><strong>pst</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast into a <cite>pyemu.Pst</cite>.  Can be an <cite>str</cite> for a
filename or an existing <cite>pyemu.Pst</cite>.  If <cite>None</cite>, a pst filename is sought
with the same base name as the jco argument (if passed)</p></li>
<li><p><strong>parcov</strong> (<em>varies</em><em>, </em><em>optional</em>) – prior parameter covariance matrix.  If <cite>str</cite>, a filename is assumed and
the prior parameter covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the prior parameter covariance matrix is
constructed from the parameter bounds in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>obscov</strong> (<em>varies</em><em>, </em><em>optional</em>) – observation noise covariance matrix.  If <cite>str</cite>, a filename is assumed and
the noise covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the noise covariance matrix is
constructed from the obsevation weights in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>forecasts</strong> (<em>varies</em><em>, </em><em>optional</em>) – forecast sensitivity vectors.  If <cite>str</cite>, first an observation name is assumed (a row
in <cite>LinearAnalysis.jco</cite>).  If that is not found, a filename is assumed and predictions are
loaded from a file using the file extension.  If [<cite>str</cite>], a list of observation names is assumed.
Can also be a <cite>pyemu.Matrix</cite> instance, a <cite>numpy.ndarray</cite> or a collection.  Note if the PEST++ option
“++forecasts()” is set in the pest control file (under the <cite>pyemu.Pst.pestpp_options</cite> dictionary),
then there is no need to pass this argument (unless you want to analyze different forecasts)
of <cite>pyemu.Matrix</cite> or <cite>numpy.ndarray</cite>.</p></li>
<li><p><strong>ref_var</strong> (<em>float</em><em>, </em><em>optional</em>) – reference variance.  Default is 1.0</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – controls screen output.  If <cite>str</cite>, a filename is assumed and
and log file is written.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>, optional) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds represent 4 * sigma.
Default is 4.0, representing approximately 95% confidence of implied normal distribution.
This arg is only used if constructing parcov from parameter bounds.</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>, optional) – flag to apply parameter scale and offset to parameter bounds
when calculating prior parameter covariance matrix from bounds.  This arg is onlyused if
constructing parcov from parameter bounds.Default is True.</p></li>
<li><p><strong>omitted_parameters</strong> ([<cite>str</cite>]) – list of parameters to treat as “omitted”.  Passing this argument
activates 3-term error variance analysis.</p></li>
<li><p><strong>omitted_parcov</strong> (<em>varies</em>) – an argument that can be cast to a parcov for the omitted parameters.
If None, omitted_parcov will be formed by extracting a sub-matrix from the <cite>LinearAnalsis.parcov</cite>
attribute.</p></li>
<li><p><strong>omitted_predictions</strong> (<em>varies</em>) – an argument that can be cast to a “predictions” (e.g. “forecasts”)
attribute to form prediction sensitivity vectors with respec to the omitted parameters.  If None,
these vectors will be extracted from the <cite>pyemu.LinearAnalysis.predictions</cite> attribute</p></li>
<li><p><strong>kl</strong> (<cite>bool</cite>, optional) – flag to perform Karhunen-Loeve scaling on the jacobian before error variance
calculations. If <cite>True</cite>, the <cite>pyemu.ErrVar.jco</cite> and <cite>pyemu.ErrVar.parcov</cite> are altered in place.
Default is <cite>False</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ev</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ErrVar</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">,</span><span class="n">omitted_parameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wel1&quot;</span><span class="p">,</span><span class="s2">&quot;wel2&quot;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">get_errvar_dataframe</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.ev.ErrVar.G">
<code class="sig-name descname">G</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.G" title="Permalink to this definition">¶</a></dt>
<dd><p>get the parameter solution Matrix at a given singular value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc G at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameter solution matrix  (V_1 * S_1^(_1) * U_1^T) at <cite>singular_value</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.I_minus_R">
<code class="sig-name descname">I_minus_R</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.I_minus_R" title="Permalink to this definition">¶</a></dt>
<dd><p>get I - R at a given singular value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calculate I - R at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>identity matrix minus resolution matrix at <cite>singular_value</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.R">
<code class="sig-name descname">R</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.R" title="Permalink to this definition">¶</a></dt>
<dd><p>get resolution Matrix (V_1 * V_1^T) at a given singular value</p>
<p>Args:
singular_value (<cite>int</cite>): singular value to calculate <cite>R</cite> at</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>resolution matrix at <cite>singular_value</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.first_forecast">
<code class="sig-name descname">first_forecast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.first_forecast" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the null space term (first term) contribution to forecast (e.g. prediction)</dt><dd><p>error variance at a given singular value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc first term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to construct the error variance dataframe</p>
<p>Just a wrapper around <cite>ErrVar.first_forecast</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of (“first”,prediction_names),error variance pairs at <cite>singular_value</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.first_parameter">
<code class="sig-name descname">first_parameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.first_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the null space term (first term) contribution to parameter error variance</dt><dd><p>at a given singular value</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc first term at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>first term contribution to parameter error variance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.first_prediction">
<code class="sig-name descname">first_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.first_prediction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the null space term (first term) contribution to prediction error variance</dt><dd><p>at a given singular value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc first term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to construct the error variance dataframe</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of (“first”,prediction_names),error variance pairs at <cite>singular_value</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.get_errvar_dataframe">
<code class="sig-name descname">get_errvar_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.get_errvar_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>primary entry point for error variance analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_values</strong> ([<cite>int</cite>], optional) – a list singular values to test. If <cite>None</cite>,
defaults to <cite>range(0,min(nnz_obs,nadj_par) + 1)</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a multi-indexed pandas dataframe summarizing each of the
error variance terms for each nominated forecast. Rows are the singluar values
tested, columns are a multi-index of forecast name and error variance term number
(e.g. 1,2 or (optionally) 3).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ev</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ErrVar</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">,</span><span class="n">omitted_parameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wel1&quot;</span><span class="p">,</span><span class="s2">&quot;wel2&quot;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">get_errvar_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.get_identifiability_dataframe">
<code class="sig-name descname">get_identifiability_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">precondition</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.get_identifiability_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>primary entry point for identifiability analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>singular_value</strong> (<cite>int</cite>) – the singular spectrum truncation point. Defaults
to minimum of non-zero-weighted observations and adjustable parameters</p></li>
<li><p><strong>precondition</strong> (<cite>bool</cite>) – flag to use the preconditioned hessian with the prior
parameter covariance matrix (xtqt + sigma_theta^-1).  This should be used
KL scaling. Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pandas dataframe of the right solution-space singular
vectors and identifiability (identifiabiity is in the column labeled “ident”)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ev</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ErrVar</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">get_identifiability_dataframe</span><span class="p">(</span><span class="n">singular_value</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">ident</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.get_null_proj">
<code class="sig-name descname">get_null_proj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maxsing</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eigthresh</span><span class="o">=</span><span class="default_value">1e-06</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.get_null_proj" title="Permalink to this definition">¶</a></dt>
<dd><p>get a null-space projection matrix of XTQX</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxsing</strong> (<cite>int</cite>, optional) – number of singular components
to use (the truncation point).  If None, <cite>pyemu.Matrx.get_maxsing()
is used to determine the truncation point with `eigthresh</cite>. Default
is None</p></li>
<li><p><strong>eigthresh</strong> (<cite>float</cite>, optional) – the ratio of smallest to largest singular
value to keep in the range (solution) space of XtQX.  Not used if
<cite>maxsing</cite> is not <cite>None</cite>.  Default is 1.0e-6</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>used for null-space monte carlo operations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>pyemu.Matrix</cite> the null-space projection matrix (V2V2^T)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.omitted_jco">
<em class="property">property </em><code class="sig-name descname">omitted_jco</code><a class="headerlink" href="#pyemu.ev.ErrVar.omitted_jco" title="Permalink to this definition">¶</a></dt>
<dd><p>the omitted-parameters jacobian matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the jacobian matrix instance of non-zero-weighted observations and
omitted parameters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Jco</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.omitted_parcov">
<em class="property">property </em><code class="sig-name descname">omitted_parcov</code><a class="headerlink" href="#pyemu.ev.ErrVar.omitted_parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>the prior omitted-parameter covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the prior parameter covariance matrix of the
omitted parameters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.omitted_predictions">
<em class="property">property </em><code class="sig-name descname">omitted_predictions</code><a class="headerlink" href="#pyemu.ev.ErrVar.omitted_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>omitted prediction sensitivity vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a matrix of prediction sensitivity vectors (column wise) to
omitted parameters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.second_forecast">
<code class="sig-name descname">second_forecast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.second_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>get the solution space contribution to forecast (e.g. “prediction”) error variance
at a given singular value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc second term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to construct error variance dataframe</p>
<p>Just a thin wrapper around <cite>ErrVar.second_prediction</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of (“second”,prediction_names), error variance
arising from the solution space contribution (y^t * G * obscov * G^T * y)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.second_parameter">
<code class="sig-name descname">second_parameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.second_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the solution space contribution to parameter error variance</dt><dd><p>at a given singular value (G * obscov * G^T)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc second term at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the second term contribution to parameter error variance
(G * obscov * G^T)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.second_prediction">
<code class="sig-name descname">second_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.second_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>get the solution space contribution to predictive error variance
at a given singular value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc second term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to construct error variance dataframe</p>
</div>
<dl class="simple">
<dt>Returns:            <cite>dict</cite>:  dictionary of (“second”,prediction_names), error variance</dt><dd><p>arising from the solution space contribution (y^t * G * obscov * G^T * y)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.third_forecast">
<code class="sig-name descname">third_forecast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.third_forecast" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the omitted parameter contribution to forecast (<cite>prediction</cite>) error variance</dt><dd><p>at a given singular value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc third term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>used to construct error variance dataframe
just a thin wrapper around <cite>ErrVar.third_prediction()</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of (“third”,prediction_names),error variance</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.third_parameter">
<code class="sig-name descname">third_parameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.third_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the omitted parameter contribution to parameter error variance</dt><dd><p>at a given singular value</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc third term at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the third term contribution to parameter error variance
calculated at <cite>singular_value</cite> (G * omitted_jco * Sigma_(omitted_pars) *
omitted_jco^T * G^T).  Returns 0.0 if third term calculations are not
being used.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.third_prediction">
<code class="sig-name descname">third_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.third_prediction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the omitted parameter contribution to prediction error variance</dt><dd><p>at a given singular value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc third term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>used to construct error variance dataframe</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of (“third”,prediction_names),error variance</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ev.ErrVar.variance_at">
<code class="sig-name descname">variance_at</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ev.ErrVar.variance_at" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the error variance of all three error variance terms at a</dt><dd><p>given singluar value</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to test</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary of (err var term,prediction_name), variance pairs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.la">
<span id="pyemu-la-module"></span><h2>pyemu.la module<a class="headerlink" href="#module-pyemu.la" title="Permalink to this headline">¶</a></h2>
<p>LinearAnalysis object, which is the base class for other
pyemu analysis objects (Schur, ErrVar, MonteCarlo, and EnsembleSmoother).
This class is usually not used directly.</p>
<dl class="py class">
<dt id="pyemu.la.LinearAnalysis">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.la.</code><code class="sig-name descname">LinearAnalysis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jco</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pst</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parcov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">obscov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">predictions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ref_var</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">resfile</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">forecasts</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">4.0</span></em>, <em class="sig-param"><span class="n">scale_offset</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The base/parent class for linear analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jco</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast or loaded into a <cite>pyemu.Jco</cite>.  Can be a
str for a filename or <cite>pyemu.Matrix</cite>/<cite>pyemu.Jco</cite> object.</p></li>
<li><p><strong>pst</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast into a <cite>pyemu.Pst</cite>.  Can be an <cite>str</cite> for a
filename or an existing <cite>pyemu.Pst</cite>.  If <cite>None</cite>, a pst filename is sought
with the same base name as the jco argument (if passed)</p></li>
<li><p><strong>parcov</strong> (<em>varies</em><em>, </em><em>optional</em>) – prior parameter covariance matrix.  If <cite>str</cite>, a filename is assumed and
the prior parameter covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the prior parameter covariance matrix is
constructed from the parameter bounds in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>obscov</strong> (<em>varies</em><em>, </em><em>optional</em>) – observation noise covariance matrix.  If <cite>str</cite>, a filename is assumed and
the noise covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the noise covariance matrix is
constructed from the obsevation weights in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>forecasts</strong> (<em>varies</em><em>, </em><em>optional</em>) – forecast sensitivity vectors.  If <cite>str</cite>, first an observation name is assumed (a row
in <cite>LinearAnalysis.jco</cite>).  If that is not found, a filename is assumed and predictions are
loaded from a file using the file extension.  If [<cite>str</cite>], a list of observation names is assumed.
Can also be a <cite>pyemu.Matrix</cite> instance, a <cite>numpy.ndarray</cite> or a collection
of <cite>pyemu.Matrix</cite> or <cite>numpy.ndarray</cite>.</p></li>
<li><p><strong>ref_var</strong> (<em>float</em><em>, </em><em>optional</em>) – reference variance.  Default is 1.0</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – controls screen output.  If <cite>str</cite>, a filename is assumed and
and log file is written.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>, optional) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds represent 4 * sigma.
Default is 4.0, representing approximately 95% confidence of implied normal distribution.
This arg is only used if constructing parcov from parameter bounds.</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>, optional) – flag to apply parameter scale and offset to parameter bounds
when calculating prior parameter covariance matrix from bounds.  This arg is onlyused if
constructing parcov from parameter bounds.Default is True.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used directly, but for prior uncertainty analyses only.</p>
<p>The derived types (<cite>pyemu.Schur</cite>, <cite>pyemu.ErrVar</cite>) are for different
forms of FOMS-based posterior uncertainty analyses.</p>
<p>This class tries hard to not load items until they are needed; all arguments are optional.</p>
<p>The class makes heavy use of property decorator to encapsulated private attributes</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#assumes &quot;my.pst&quot; exists</span>
<span class="n">la</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">LinearAnalysis</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">,</span><span class="n">forecasts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="s2">&quot;fore2&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">prior_forecast</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.adj_par_names">
<em class="property">property </em><code class="sig-name descname">adj_par_names</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.adj_par_names" title="Permalink to this definition">¶</a></dt>
<dd><p>adjustable parameter names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of adjustable parameter names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[‘str`]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if <cite>LinearAnalysis.pst</cite> is <cite>None</cite>, returns <cite>LinearAnalysis.jco.col_names</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.adjust_obscov_resfile">
<code class="sig-name descname">adjust_obscov_resfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">resfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.adjust_obscov_resfile" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the elements of obscov by scaling the implied weights
based on the phi components in res_file so that the total phi
is equal to the number of non-zero weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>resfile</strong> (<cite>str</cite>) – residual file to use.  If None, residual
file with case name is sought. default is None</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>calls <cite>pyemu.Pst.adjust_weights_resfile()</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.apply_karhunen_loeve_scaling">
<code class="sig-name descname">apply_karhunen_loeve_scaling</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.apply_karhunen_loeve_scaling" title="Permalink to this definition">¶</a></dt>
<dd><p>apply karhuene-loeve scaling to the jacobian matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This scaling is not necessary for analyses using Schur’s
complement, but can be very important for error variance
analyses.  This operation effectively transfers prior knowledge
specified in the parcov to the jacobian and reset parcov to the
identity matrix.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.clean">
<code class="sig-name descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>drop regularization and prior information observation from the jco</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.drop_prior_information">
<code class="sig-name descname">drop_prior_information</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.drop_prior_information" title="Permalink to this definition">¶</a></dt>
<dd><p>drop the prior information from the jco and pst attributes</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.fehalf">
<em class="property">property </em><code class="sig-name descname">fehalf</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.fehalf" title="Permalink to this definition">¶</a></dt>
<dd><p>Karhunen-Loeve scaling matrix attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the Karhunen-Loeve scaling matrix based on the prior
parameter covariance matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.forecast_names">
<em class="property">property </em><code class="sig-name descname">forecast_names</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.forecast_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the forecast (aka prediction) names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of forecast names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>([<cite>str</cite>])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.forecasts">
<em class="property">property </em><code class="sig-name descname">forecasts</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>the forecast sentivity vectors attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a matrix of forecast (prediction) sensitivity vectors (column wise)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.forecasts_iter">
<em class="property">property </em><code class="sig-name descname">forecasts_iter</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.forecasts_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>forecast (e.g. prediction) sensitivity vectors iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>iterator on forecasts (e.g. predictions) sensitivity vectors (matrix)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>iterator</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is used for processing huge numbers of predictions</p>
<p>This is a synonym for LinearAnalysis.predictions_iter()</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">obs_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">astype</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.get" title="Permalink to this definition">¶</a></dt>
<dd><p>method to get a new LinearAnalysis class using a
subset of parameters and/or observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par_names</strong> ([<cite>‘str</cite>]) – par names for new object</p></li>
<li><p><strong>obs_names</strong> ([<cite>‘str</cite>]) – obs names for new object</p></li>
<li><p><strong>astype</strong> (<cite>pyemu.Schur</cite> or <cite>pyemu.ErrVar</cite>) – type to
cast the new object.  If None, return type is
same as self</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>LinearAnalysis</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.get_cso_dataframe">
<code class="sig-name descname">get_cso_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.get_cso_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe of composite observation sensitivity, as returned by PEST in the
seo file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataframe of observation names and composite observation
sensitivity</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>That this formulation deviates slightly from the PEST documentation in that the
values are divided by (npar-1) rather than by (npar).</p>
<p>The equation is cso_j = ((Q^1/2*J*J^T*Q^1/2)^1/2)_jj/(NPAR-1)</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.get_obs_competition_dataframe">
<code class="sig-name descname">get_obs_competition_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.get_obs_competition_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get the observation competition stat a la PEST utility</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe of observation names by
observation names with values equal to the PEST
competition statistic</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.get_par_css_dataframe">
<code class="sig-name descname">get_par_css_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.get_par_css_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe of composite scaled sensitivities.  Includes both
PEST-style and Hill-style.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe of parameter names, PEST-style and
Hill-style composite scaled sensitivity</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.jco">
<em class="property">property </em><code class="sig-name descname">jco</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.jco" title="Permalink to this definition">¶</a></dt>
<dd><p>the jacobian matrix attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the jacobian matrix attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Jco</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.mle_covariance">
<em class="property">property </em><code class="sig-name descname">mle_covariance</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.mle_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>maximum likelihood parameter covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>maximum likelihood parameter covariance matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.mle_parameter_estimate">
<em class="property">property </em><code class="sig-name descname">mle_parameter_estimate</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.mle_parameter_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>maximum likelihood parameter estimate.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the maximum likelihood parameter estimates</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.nnz_obs_names">
<em class="property">property </em><code class="sig-name descname">nnz_obs_names</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.nnz_obs_names" title="Permalink to this definition">¶</a></dt>
<dd><p>non-zero-weighted observation names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of non-zero-weighted observation names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[‘str`]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if <cite>LinearAnalysis.pst</cite> is <cite>None</cite>, returns <cite>LinearAnalysis.jco.row_names</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.obscov">
<em class="property">property </em><code class="sig-name descname">obscov</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.obscov" title="Permalink to this definition">¶</a></dt>
<dd><p>get the observation noise covariance matrix attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a reference to the <cite>LinearAnalysis.obscov</cite> attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.parcov">
<em class="property">property </em><code class="sig-name descname">parcov</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>get the prior parameter covariance matrix attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a reference to the <cite>LinearAnalysis.parcov</cite> attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.predictions">
<em class="property">property </em><code class="sig-name descname">predictions</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>the prediction (aka forecast) sentivity vectors attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a matrix of prediction sensitivity vectors (column wise)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.predictions_iter">
<em class="property">property </em><code class="sig-name descname">predictions_iter</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.predictions_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>prediction sensitivity vectors iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>iterator on prediction sensitivity vectors (matrix)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>iterator</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this is used for processing huge numbers of predictions</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.prior_forecast">
<em class="property">property </em><code class="sig-name descname">prior_forecast</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.prior_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>prior forecast (e.g. prediction) variances</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of forecast name, prior variance pairs</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.prior_parameter">
<em class="property">property </em><code class="sig-name descname">prior_parameter</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.prior_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>prior parameter covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>prior parameter covariance matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.prior_prediction">
<em class="property">property </em><code class="sig-name descname">prior_prediction</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.prior_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>prior prediction (e.g. forecast) variances</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of prediction name, prior variance pairs</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.pst">
<em class="property">property </em><code class="sig-name descname">pst</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.pst" title="Permalink to this definition">¶</a></dt>
<dd><p>the pst attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the pst attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Pst</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.qhalf">
<em class="property">property </em><code class="sig-name descname">qhalf</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.qhalf" title="Permalink to this definition">¶</a></dt>
<dd><p>square root of the cofactor matrix attribute. Create the attribute if
it has not yet been created</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>square root of the cofactor matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.qhalfx">
<em class="property">property </em><code class="sig-name descname">qhalfx</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.qhalfx" title="Permalink to this definition">¶</a></dt>
<dd><p>half normal matrix attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>half normal matrix attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.reset_obscov">
<code class="sig-name descname">reset_obscov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.reset_obscov" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the obscov attribute to None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<cite>str</cite> or <cite>pyemu.Matrix</cite>) – the value to assign to the obscov
attribute.  If None, the private __obscov attribute is cleared
but not reset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.reset_parcov">
<code class="sig-name descname">reset_parcov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.reset_parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the parcov attribute to None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<cite>str</cite> or <cite>pyemu.Matrix</cite>) – the value to assign to the parcov
attribute.  If None, the private __parcov attribute is cleared
but not reset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.reset_pst">
<code class="sig-name descname">reset_pst</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.la.LinearAnalysis.reset_pst" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the LinearAnalysis.pst attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<cite>str</cite> or <cite>pyemu.Pst</cite>) – the value to assign to the pst attribute</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.la.LinearAnalysis.xtqx">
<em class="property">property </em><code class="sig-name descname">xtqx</code><a class="headerlink" href="#pyemu.la.LinearAnalysis.xtqx" title="Permalink to this definition">¶</a></dt>
<dd><p>normal matrix attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>normal matrix attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.logger">
<span id="pyemu-logger-module"></span><h2>pyemu.logger module<a class="headerlink" href="#module-pyemu.logger" title="Permalink to this headline">¶</a></h2>
<p>module for logging pyemu progress</p>
<dl class="py class">
<dt id="pyemu.logger.Logger">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.logger.</code><code class="sig-name descname">Logger</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">echo</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.logger.Logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>a basic class for logging events during the linear analysis calculations</dt><dd><p>if filename is passed, then a file handle is opened.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – Filename to write logged events to. If False, no file will be created,
and logged events will be displayed on standard out.</p></li>
<li><p><strong>echo</strong> (<cite>bool</cite>) – Flag to cause logged events to be echoed to the screen.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyemu.logger.Logger.log">
<code class="sig-name descname">log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phrase</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.logger.Logger.log" title="Permalink to this definition">¶</a></dt>
<dd><p>log something that happened.</p>
<dl class="simple">
<dt>Arg:</dt><dd><p>phrase (<cite>str</cite>): statement to log</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>The first time phrase is passed the start time is saved.</dt><dd><p>The second time the phrase is logged, the elapsed time is written</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.logger.Logger.lraise">
<code class="sig-name descname">lraise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.logger.Logger.lraise" title="Permalink to this definition">¶</a></dt>
<dd><p>log an exception, close the log file, then raise the exception</p>
<dl class="simple">
<dt>Arg:</dt><dd><p>phrase (<cite>str</cite>): exception statement to log and raise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.logger.Logger.statement">
<code class="sig-name descname">statement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phrase</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.logger.Logger.statement" title="Permalink to this definition">¶</a></dt>
<dd><p>log a one-time statement</p>
<dl class="simple">
<dt>Arg:</dt><dd><p>phrase (<cite>str</cite>): statement to log</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.logger.Logger.warn">
<code class="sig-name descname">warn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.logger.Logger.warn" title="Permalink to this definition">¶</a></dt>
<dd><p>write a warning to the log file.</p>
<dl class="simple">
<dt>Arg:</dt><dd><p>phrase (<cite>str</cite>): warning statement to log</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.mc">
<span id="pyemu-mc-module"></span><h2>pyemu.mc module<a class="headerlink" href="#module-pyemu.mc" title="Permalink to this headline">¶</a></h2>
<p>pyEMU Monte Carlo module.  Supports easy Monte Carlo
and GLUE analyses.  The MonteCarlo class inherits from
pyemu.LinearAnalysis</p>
<dl class="py class">
<dt id="pyemu.mc.MonteCarlo">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.mc.</code><code class="sig-name descname">MonteCarlo</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.mc.MonteCarlo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.la.LinearAnalysis</span></code></a></p>
<p>LinearAnalysis derived type for monte carlo analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dict</em>) – dictionary of keyword arguments.  See pyemu.LinearAnalysis for
complete definitions</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="pyemu.mc.MonteCarlo.parensemble">
<code class="sig-name descname">parensemble</code><a class="headerlink" href="#pyemu.mc.MonteCarlo.parensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>pyemu object derived from a pandas dataframe, the ensemble
of parameters from the PEST control file with associated
starting value and bounds.  Object also exposes methods
relevant to the dataframe and parameters– see documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyemu.ParameterEnsemble" title="pyemu.ParameterEnsemble">pyemu.ParameterEnsemble</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.mc.MonteCarlo.obsensemble">
<code class="sig-name descname">obsensemble</code><a class="headerlink" href="#pyemu.mc.MonteCarlo.obsensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>pyemu object derived from a pandas dataframe, the ensemble
of observations from the PEST control file with associated
starting weights.  Object also exposes methods
relevant to the dataframe and observations– see documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyemu.ObservationEnsemble" title="pyemu.ObservationEnsemble">pyemu.ObservationEnsemble</a></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>pyEMU MonteCarlo object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyemu.mc.MonteCarlo" title="pyemu.mc.MonteCarlo">MonteCarlo</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc</span> <span class="pre">=</span> <span class="pre">pyemu.MonteCarlo(pst=&quot;pest.pst&quot;)</span></code></p>
<dl class="py method">
<dt id="pyemu.mc.MonteCarlo.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">par_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">obs</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">enforce_bounds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">how</span><span class="o">=</span><span class="default_value">'gaussian'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.mc.MonteCarlo.draw" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>draw stochastic realizations of parameters and</dt><dd><p>optionally observations, filling MonteCarlo.parensemble and
optionally MonteCarlo.obsensemble.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_reals</strong> (<em>int</em>) – number of realization to generate</p></li>
<li><p><strong>par_file</strong> (<em>str</em>) – parameter file to use as mean values. If None,
use MonteCarlo.pst.parameter_data.parval1.
Default is None</p></li>
<li><p><strong>obs</strong> (<em>bool</em>) – add a realization of measurement noise to observation values,
forming MonteCarlo.obsensemble.Default is False</p></li>
<li><p><strong>enforce_bounds</strong> (<em>str</em>) – enforce parameter bounds based on control file information.
options are ‘reset’, ‘drop’ or None.  Default is None</p></li>
<li><p><strong>how</strong> (<em>str</em>) – type of distribution to draw from. Must be in [“gaussian”,”uniform”]
default is “gaussian”.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc</span> <span class="pre">=</span> <span class="pre">pyemu.MonteCarlo(pst=&quot;pest.pst&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc.draw(1000)</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.mc.MonteCarlo.get_nsing">
<code class="sig-name descname">get_nsing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epsilon</span><span class="o">=</span><span class="default_value">0.0001</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.mc.MonteCarlo.get_nsing" title="Permalink to this definition">¶</a></dt>
<dd><p>get the number of solution space dimensions given
a ratio between the largest and smallest singular values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>epsilon</strong> (<em>float</em>) – singular value ratio</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nsing</strong> – number of singular components above the epsilon ratio threshold</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If nsing == nadj_par, then None is returned</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.mc.MonteCarlo.get_null_proj">
<code class="sig-name descname">get_null_proj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nsing</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.mc.MonteCarlo.get_null_proj" title="Permalink to this definition">¶</a></dt>
<dd><p>get a null-space projection matrix of XTQX</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nsing</strong> (<em>int</em>) – optional number of singular components to use
If Nonte, then nsing is determined from
call to MonteCarlo.get_nsing()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>v2_proj</strong> – the null-space projection matrix (V2V2^T)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyemu.Matrix" title="pyemu.Matrix">pyemu.Matrix</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.mc.MonteCarlo.num_reals">
<em class="property">property </em><code class="sig-name descname">num_reals</code><a class="headerlink" href="#pyemu.mc.MonteCarlo.num_reals" title="Permalink to this definition">¶</a></dt>
<dd><p>get the number of realizations in the parameter ensemble</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>num_real</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.mc.MonteCarlo.project_parensemble">
<code class="sig-name descname">project_parensemble</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nsing</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enforce_bounds</span><span class="o">=</span><span class="default_value">'reset'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.mc.MonteCarlo.project_parensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>perform the null-space projection operations for null-space monte carlo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par_file</strong> (<em>str</em>) – an optional file of parameter values to use</p></li>
<li><p><strong>nsing</strong> (<em>int</em>) – number of singular values to in forming null subspace matrix</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – overwrite the existing parameter ensemble with the
projected values</p></li>
<li><p><strong>enforce_bounds</strong> (<em>str</em>) – how to enforce parameter bounds.  can be None, ‘reset’, or ‘drop’.
Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>par_en</strong> – if inplace is False, otherwise None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyemu.ParameterEnsemble" title="pyemu.ParameterEnsemble">pyemu.ParameterEnsemble</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>to use this method, the MonteCarlo instance must have been constructed
with the <code class="docutils literal notranslate"><span class="pre">jco</span></code> argument.</p>
</div>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc</span> <span class="pre">=</span> <span class="pre">pyemu.MonteCarlo(jco=&quot;pest.jcb&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc.draw(1000)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc.project_parensemble(par_file=&quot;final.par&quot;,nsing=100)</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.mc.MonteCarlo.write_psts">
<code class="sig-name descname">write_psts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prefix</span></em>, <em class="sig-param"><span class="n">existing_jco</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">noptmax</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.mc.MonteCarlo.write_psts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>write parameter and optionally observation realizations</dt><dd><p>to a series of pest control files</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<em>str</em>) – pest control file prefix</p></li>
<li><p><strong>existing_jco</strong> (<em>str</em>) – filename of an existing jacobian matrix to add to the
pest++ options in the control file.  This is useful for
NSMC since this jco can be used to get the first set of
parameter upgrades for free!  Needs to be the path the jco
file as seen from the location where pest++ will be run</p></li>
<li><p><strong>noptmax</strong> (<em>int</em>) – value of NOPTMAX to set in new pest control files</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc</span> <span class="pre">=</span> <span class="pre">pyemu.MonteCarlo(jco=&quot;pest.jcb&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc.draw(1000,</span> <span class="pre">obs=True)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;mc.write_psts(&quot;mc_&quot;,</span> <span class="pre">existing_jco=&quot;pest.jcb&quot;,</span> <span class="pre">noptmax=1)</span></code></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu.pyemu_warnings">
<span id="pyemu-pyemu-warnings-module"></span><h2>pyemu.pyemu_warnings module<a class="headerlink" href="#module-pyemu.pyemu_warnings" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="pyemu.pyemu_warnings.PyemuWarning">
<em class="property">exception </em><code class="sig-prename descclassname">pyemu.pyemu_warnings.</code><code class="sig-name descname">PyemuWarning</code><a class="headerlink" href="#pyemu.pyemu_warnings.PyemuWarning" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeWarning</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-pyemu.sc">
<span id="pyemu-sc-module"></span><h2>pyemu.sc module<a class="headerlink" href="#module-pyemu.sc" title="Permalink to this headline">¶</a></h2>
<p>module for FOSM-based uncertainty analysis using a
linearized form of Bayes equation known as the Schur compliment</p>
<dl class="py class">
<dt id="pyemu.sc.Schur">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.sc.</code><code class="sig-name descname">Schur</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jco</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.la.LinearAnalysis</span></code></a></p>
<p>FOSM-based uncertainty and data-worth analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jco</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast or loaded into a <cite>pyemu.Jco</cite>.  Can be a
str for a filename or <cite>pyemu.Matrix</cite>/<cite>pyemu.Jco</cite> object.</p></li>
<li><p><strong>pst</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast into a <cite>pyemu.Pst</cite>.  Can be an <cite>str</cite> for a
filename or an existing <cite>pyemu.Pst</cite>.  If <cite>None</cite>, a pst filename is sought
with the same base name as the jco argument (if passed)</p></li>
<li><p><strong>parcov</strong> (<em>varies</em><em>, </em><em>optional</em>) – prior parameter covariance matrix.  If <cite>str</cite>, a filename is assumed and
the prior parameter covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the prior parameter covariance matrix is
constructed from the parameter bounds in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>obscov</strong> (<em>varies</em><em>, </em><em>optional</em>) – observation noise covariance matrix.  If <cite>str</cite>, a filename is assumed and
the noise covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the noise covariance matrix is
constructed from the obsevation weights in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>forecasts</strong> (<em>varies</em><em>, </em><em>optional</em>) – forecast sensitivity vectors.  If <cite>str</cite>, first an observation name is assumed (a row
in <cite>LinearAnalysis.jco</cite>).  If that is not found, a filename is assumed and predictions are
loaded from a file using the file extension.  If [<cite>str</cite>], a list of observation names is assumed.
Can also be a <cite>pyemu.Matrix</cite> instance, a <cite>numpy.ndarray</cite> or a collection.  Note if the PEST++ option
“++forecasts()” is set in the pest control file (under the <cite>pyemu.Pst.pestpp_options</cite> dictionary),
then there is no need to pass this argument (unless you want to analyze different forecasts)
of <cite>pyemu.Matrix</cite> or <cite>numpy.ndarray</cite>.</p></li>
<li><p><strong>ref_var</strong> (<em>float</em><em>, </em><em>optional</em>) – reference variance.  Default is 1.0</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – controls screen output.  If <cite>str</cite>, a filename is assumed and
and log file is written.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>, optional) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds represent 4 * sigma.
Default is 4.0, representing approximately 95% confidence of implied normal distribution.
This arg is only used if constructing parcov from parameter bounds.</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>, optional) – flag to apply parameter scale and offset to parameter bounds
when calculating prior parameter covariance matrix from bounds.  This arg is onlyused if
constructing parcov from parameter bounds.Default is True.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is the primary entry point for FOSM-based uncertainty and
dataworth analyses</p>
<p>This class replicates and extends the behavior of the PEST PREDUNC utilities.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#assumes &quot;my.pst&quot; exists</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">,</span><span class="n">forecasts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="s2">&quot;fore2&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">get_forecast_summary</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">get_parameter_contribution</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.sc.Schur.get_added_obs_group_importance">
<code class="sig-name descname">get_added_obs_group_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_added_obs_group_importance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A dataworth method to analyze the posterior uncertainty as a result of gaining</dt><dd><p>existing observations, tested by observation groups</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dataframe with index of observation group names and columns
of forecast names.  The values in the dataframe are the posterior
variances of the forecasts resulting from gaining the information
contained in each observation group. One row in the dataframe is labeled “base” - this is
posterior forecast variance resulting from the notional calibration with the
non-zero-weighed observations in <cite>Schur.pst</cite>.  Conceptually, the forecast variance should
either not change or decrease as a result of gaining new observations.  The magnitude
of the decrease represents the worth of the potential new observation(s) in each group
being tested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observations in <cite>Schur.pst</cite> with zero weights are not included in the analysis unless
<cite>reset_zero_weight</cite> is <cite>True</cite> or a float greater than zero.  In most cases, users
will want to reset zero-weighted observations as part dataworth testing process.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_added_obs_group_importance</span><span class="p">(</span><span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_added_obs_importance">
<code class="sig-name descname">get_added_obs_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obslist_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">base_obslist</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_added_obs_importance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A dataworth method to analyze the posterior uncertainty as a result of gathering</dt><dd><p>some additional observations</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obslist_dict</strong> (<cite>dict</cite>, optional) – a nested dictionary-list of groups of observations
that are to be treated as gained/collected.  key values become
row labels in returned dataframe. If <cite>None</cite>, then every zero-weighted
observation is tested sequentially. Default is <cite>None</cite></p></li>
<li><p><strong>base_obslist</strong> ([<cite>str</cite>], optional) – observation names to treat as the “existing” observations.
The values of <cite>obslist_dict</cite> will be added to this list during
each test.  If <cite>None</cite>, then the values in each <cite>obslist_dict</cite> entry will
be treated as the entire calibration dataset.  That is, there
are no existing observations. Default is <cite>None</cite>.  Standard practice would
be to pass this argument as <cite>pyemu.Schur.pst.nnz_obs_names</cite> so that existing,
non-zero-weighted observations are accounted for in evaluating the worth of
new yet-to-be-collected observations.</p></li>
<li><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with row labels (index) of <cite>obslist_dict.keys()</cite> and
columns of forecast names.  The values in the dataframe are the
posterior variance of the forecasts resulting from notional inversion
using the observations in <cite>obslist_dict[key value]</cite> plus the observations
in <cite>base_obslist</cite> (if any).  One row in the dataframe is labeled “base” - this is
posterior forecast variance resulting from the notional calibration with the
observations in <cite>base_obslist</cite> (if <cite>base_obslist</cite> is <cite>None</cite>, then the “base” row is the
prior forecast variance).  Conceptually, the forecast variance should either not change or
decrease as a result of gaining additional observations.  The magnitude of the decrease
represents the worth of the potential new observation(s) being tested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observations listed in <cite>obslist_dict</cite> and <cite>base_obslist</cite> with zero
weights are not included in the analysis unless <cite>reset_zero_weight</cite> is <cite>True</cite> or a float
greater than zero.  In most cases, users will want to reset zero-weighted observations as part
dataworth testing process.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">obslist_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;hds&quot;</span><span class="p">:[</span><span class="s2">&quot;head1&quot;</span><span class="p">,</span><span class="s2">&quot;head2&quot;</span><span class="p">],</span><span class="s2">&quot;flux&quot;</span><span class="p">:[</span><span class="s2">&quot;flux1&quot;</span><span class="p">,</span><span class="s2">&quot;flux2&quot;</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_added_obs_importance</span><span class="p">(</span><span class="n">obslist_dict</span><span class="o">=</span><span class="n">obslist_dict</span><span class="p">,</span>
                                 <span class="n">base_obslist</span><span class="o">=</span><span class="n">sc</span><span class="o">.</span><span class="n">pst</span><span class="o">.</span><span class="n">nnz_obs_names</span><span class="p">,</span>
                                 <span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_conditional_instance">
<code class="sig-name descname">get_conditional_instance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parameter_names</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_conditional_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>get a new <cite>pyemu.Schur</cite> instance that includes conditional update from
some parameters becoming known perfectly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parameter_names</strong> ([<cite>str</cite>]) – list of parameters that are to be treated as
notionally perfectly known</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Schur instance conditional on perfect knowledge
of some parameters. The new instance has an updated <cite>parcov</cite> that is less
the names listed in <cite>parameter_names</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Schur</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is primarily for use by the <cite>LinearAnalysis.get_parameter_contribution()</cite>
dataworth method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_forecast_summary">
<code class="sig-name descname">get_forecast_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_forecast_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>summary of the FOSM-based forecast uncertainty (variance) estimate(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataframe of prior,posterior variances and percent
uncertainty reduction of each forecast (e.g. prediction)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the primary entry point for accessing forecast uncertainty estimates
“precent_reduction” column in dataframe is calculated as
100.0 * (1.0 - (posterior variance / prior variance)</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jcb&quot;</span><span class="p">,</span><span class="n">forecasts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="s2">&quot;fore2&quot;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_parameter_summary</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s2">&quot;prior&quot;</span><span class="p">,</span><span class="s2">&quot;posterior&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">percent_reduction</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_obs_group_dict">
<code class="sig-name descname">get_obs_group_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_obs_group_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dictionary of observations grouped by observation group name</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of observations grouped by observation group name.
Useful for dataworth processing in <cite>pyemu.Schur</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>only includes observations that are listed in <cite>Schur.jco.row_names</cite></p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">obsgrp_dict</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_obs_group_dict</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_removed_obs_importance</span><span class="p">(</span><span class="n">obsgrp_dict</span><span class="o">=</span><span class="n">obsgrp_dict</span><span class="p">,</span> <span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_par_contribution">
<code class="sig-name descname">get_par_contribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parlist_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_prior_results</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_par_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>A dataworth method to get a dataframe the prior and posterior uncertainty
reduction as a result of some parameter becoming perfectly known</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parlist_dict</strong> – (<cite>dict</cite>, optional): a nested dictionary-list of groups of parameters
that are to be treated as perfectly known.  key values become
row labels in returned dataframe.  If <cite>None</cite>, each adjustable parameter
is sequentially treated as known and the returned dataframe
has row labels for each adjustable parameter</p></li>
<li><p><strong>include_prior_results</strong> (<cite>bool</cite>, optional) – flag to return a multi-indexed dataframe with both conditional
prior and posterior forecast uncertainty estimates.  This is because
the notional learning about parameters potentially effects both the prior
and posterior forecast uncertainty estimates. If <cite>False</cite>, only posterior
results are returned.  Default is <cite>False</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe that summarizes the parameter contribution
dataworth analysis. The dataframe has index (row labels) of the keys in parlist_dict
and a column labels of forecast names.  The values in the dataframe
are the posterior variance of the forecast conditional on perfect
knowledge of the parameters in the values of parlist_dict.  One row in the
dataframe will be labeled <cite>base</cite> - this is the forecast uncertainty estimates
that include the effects of all adjustable parameters.  Percent decreases in
forecast uncertainty can be calculated by differencing all rows against the
“base” row.  Varies depending on <cite>include_prior_results</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the primary dataworth method for assessing the contribution of one or more
parameters to forecast uncertainty.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">parlist_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;hk&quot;</span><span class="p">:[</span><span class="s2">&quot;hk1&quot;</span><span class="p">,</span><span class="s2">&quot;hk2&quot;</span><span class="p">],</span><span class="s2">&quot;rech&quot;</span><span class="p">[</span><span class="s2">&quot;rech1&quot;</span><span class="p">,</span><span class="s2">&quot;rech2&quot;</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_par_contribution</span><span class="p">(</span><span class="n">parlist_dict</span><span class="o">=</span><span class="n">parlist_dict</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_par_group_contribution">
<code class="sig-name descname">get_par_group_contribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">include_prior_results</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_par_group_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>A dataworth method to get the forecast uncertainty contribution from each parameter
group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>include_prior_results</strong> (<cite>bool</cite>, optional) – flag to return a multi-indexed dataframe with both conditional
prior and posterior forecast uncertainty estimates.  This is because
the notional learning about parameters potentially effects both the prior
and posterior forecast uncertainty estimates. If <cite>False</cite>, only posterior
results are returned.  Default is <cite>False</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe that summarizes the parameter contribution analysis.
The dataframe has index (row labels) that are the parameter group names
and a column labels of forecast names.  The values in the dataframe
are the posterior variance of the forecast conditional on perfect
knowledge of the adjustable parameters in each parameter group.  One
row is labelled “base” - this is the variance of the forecasts that includes
the effects of all adjustable parameters. Varies depending on <cite>include_prior_results</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is just a thin wrapper around get_contribution_dataframe() - this method
automatically constructs the parlist_dict argument where the keys are the
group names and the values are the adjustable parameters in the groups</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_par_group_contribution</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_parameter_summary">
<code class="sig-name descname">get_parameter_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_parameter_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>summary of the FOSM-based parameter uncertainty (variance) estimate(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataframe of prior,posterior variances and percent
uncertainty reduction of each parameter</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the primary entry point for accessing parameter uncertainty estimates</p>
<p>The “Prior” column in dataframe is the diagonal of <cite>LinearAnalysis.parcov</cite>
“precent_reduction” column in dataframe is calculated as 100.0 * (1.0 -
(posterior variance / prior variance)</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jcb&quot;</span><span class="p">,</span><span class="n">forecasts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="s2">&quot;fore2&quot;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_parameter_summary</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s2">&quot;prior&quot;</span><span class="p">,</span><span class="s2">&quot;posterior&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">percent_reduction</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_removed_obs_group_importance">
<code class="sig-name descname">get_removed_obs_group_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_removed_obs_group_importance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A dataworth method to analyze the posterior uncertainty as a result of losing</dt><dd><p>existing observations, tested by observation groups</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dataframe with index of observation group names and columns
of forecast names.  The values in the dataframe are the posterior
variances of the forecasts resulting from losing the information
contained in each observation group. One row in the dataframe is labeled “base” - this is
posterior forecast variance resulting from the notional calibration with the
non-zero-weighed observations in <cite>Schur.pst</cite>.  Conceptually, the forecast variance should
either not change or increase as a result of losing existing observations.  The magnitude
of the increase represents the worth of the existing observation(s) in each group being tested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observations in <cite>Schur.pst</cite> with zero weights are not included in the analysis unless
<cite>reset_zero_weight</cite> is <cite>True</cite> or a float greater than zero.  In most cases, users
will want to reset zero-weighted observations as part dataworth testing process.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_removed_obs_group_importance</span><span class="p">(</span><span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.get_removed_obs_importance">
<code class="sig-name descname">get_removed_obs_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obslist_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.get_removed_obs_importance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A dataworth method to analyze the posterior uncertainty as a result of losing</dt><dd><p>some existing observations</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obslist_dict</strong> (<cite>dict</cite>, optional) – a nested dictionary-list of groups of observations
that are to be treated as lost.  key values become
row labels in returned dataframe. If <cite>None</cite>, then every zero-weighted
observation is tested sequentially. Default is <cite>None</cite></p></li>
<li><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dataframe with index of obslist_dict.keys() and columns
of forecast names.  The values in the dataframe are the posterior
variances of the forecasts resulting from losing the information
contained in obslist_dict[key value]. One row in the dataframe is labeled “base” - this is
posterior forecast variance resulting from the notional calibration with the
non-zero-weighed observations in <cite>Schur.pst</cite>.  Conceptually, the forecast variance should
either not change or increase as a result of losing existing observations.  The magnitude
of the increase represents the worth of the existing observation(s) being tested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observations listed in <cite>obslist_dict</cite> and <cite>base_obslist</cite> with zero
weights are not included in the analysis unless <cite>reset_zero_weight</cite> is <cite>True</cite> or a float
greater than zero.  In most cases, users will want to reset zero-weighted observations as part
dataworth testing process.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_removed_obs_importance</span><span class="p">(</span><span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.next_most_important_added_obs">
<code class="sig-name descname">next_most_important_added_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">forecast</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">obslist_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">base_obslist</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.next_most_important_added_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>find the most important observation(s) by sequentially evaluating
the importance of the observations in <cite>obslist_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forecast</strong> (<cite>str</cite>, optional) – name of the forecast to use in the ranking process.  If
more than one forecast has been listed, this argument is required.  This is because
the data worth must be ranked with respect to the variance reduction for a single
forecast</p></li>
<li><p><strong>niter</strong> (<cite>int</cite>, optional) – number of sequential dataworth testing iterations.  Default is 3</p></li>
<li><p><strong>obslist_dict</strong> (<cite>dict</cite>, optional) – a nested dictionary-list of groups of observations
that are to be treated as gained/collected.  key values become
row labels in returned dataframe. If <cite>None</cite>, then every zero-weighted
observation is tested sequentially. Default is <cite>None</cite></p></li>
<li><p><strong>base_obslist</strong> ([<cite>str</cite>], optional) – observation names to treat as the “existing” observations.
The values of <cite>obslist_dict</cite> will be added to this list during
each test.  If <cite>None</cite>, then the values in each <cite>obslist_dict</cite> entry will
be treated as the entire calibration dataset.  That is, there
are no existing observations. Default is <cite>None</cite>.  Standard practice would
be to pass this argument as <cite>pyemu.Schur.pst.nnz_obs_names</cite> so that existing,
non-zero-weighted observations are accounted for in evaluating the worth of
new yet-to-be-collected observations.</p></li>
<li><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataFrame with columns of <cite>obslist_dict</cite> key for each iteration
the yields the largest variance reduction for the named <cite>forecast</cite>. Columns are forecast
variance percent reduction for each iteration (percent reduction compared to initial “base”
case with all non-zero weighted observations included in the notional calibration)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The most important observations from each iteration is added to <cite>base_obslist</cite>
and removed <cite>obslist_dict</cite> for the next iteration.  In this way, the added
observation importance values include the conditional information from
the last iteration.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">next_most_important_added_obs</span><span class="p">(</span><span class="n">forecast</span><span class="o">=</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="n">base_obslist</span><span class="o">=</span><span class="n">sc</span><span class="o">.</span><span class="n">pst</span><span class="o">.</span><span class="n">nnz_obs_names</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.next_most_par_contribution">
<code class="sig-name descname">next_most_par_contribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">forecast</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parlist_dict</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.sc.Schur.next_most_par_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>find the parameter(s) contributing most to posterior
forecast  by sequentially evaluating the contribution of parameters in
<cite>parlist_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forecast</strong> (<cite>str</cite>, optional) – name of the forecast to use in the ranking process.  If
more than one forecast has been listed, this argument is required.  This is because
the data worth must be ranked with respect to the variance reduction for a single
forecast</p></li>
<li><p><strong>niter</strong> (<cite>int</cite>, optional) – number of sequential dataworth testing iterations.  Default is 3</p></li>
<li><p><strong>parlist_dict</strong> (<cite>dict</cite>, optional) – dict
a nested dictionary-list of groups of parameters
that are to be treated as perfectly known.  key values become
row labels in dataframe</p></li>
<li><p><strong>parlist_dict</strong> – a nested dictionary-list of groups of parameters
that are to be treated as perfectly known (zero uncertainty).  key values become
row labels in returned dataframe. If <cite>None</cite>, then every adustable parameter is tested
sequentially. Default is <cite>None</cite>. Conceptually, the forecast variance should
either not change or decrease as a result of knowing parameter perfectly.  The magnitude
of the decrease represents the worth of gathering information about the parameter(s) being
tested.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The largest contributing parameters from each iteration are
treated as known perfectly for the remaining iterations.  In this way, the
next iteration seeks the next most influential group of parameters.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe with index of iteration number and columns
of <cite>parlist_dict.keys()</cite>.  The values are the results of the knowing
each parlist_dict entry expressed as posterior variance reduction</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.posterior_forecast">
<em class="property">property </em><code class="sig-name descname">posterior_forecast</code><a class="headerlink" href="#pyemu.sc.Schur.posterior_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>posterior forecast (e.g. prediction) variance(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of forecast names and FOSM-estimated posterior
variances</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sames as <cite>LinearAnalysis.posterior_prediction</cite></p>
<p>See <cite>Schur.get_forecast_summary()</cite> for a dataframe-based container of prior and posterior
variances</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.posterior_parameter">
<em class="property">property </em><code class="sig-name descname">posterior_parameter</code><a class="headerlink" href="#pyemu.sc.Schur.posterior_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>posterior parameter covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the posterior parameter covariance matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jcb&quot;</span><span class="p">)</span>
<span class="n">post_cov</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">posterior_parameter</span>
<span class="n">post_cov</span><span class="o">.</span><span class="n">to_ascii</span><span class="p">(</span><span class="s2">&quot;post.cov&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.sc.Schur.posterior_prediction">
<em class="property">property </em><code class="sig-name descname">posterior_prediction</code><a class="headerlink" href="#pyemu.sc.Schur.posterior_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>posterior prediction (e.g. forecast) variance estimate(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of forecast names and FOSM-estimated posterior
variances</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><p><cite>dict</cite></p>
<dl>
<dt>Note:</dt><dd><p>sames as <cite>LinearAnalysis.posterior_forecast</cite></p>
<p>See <cite>Schur.get_forecast_summary()</cite> for a dataframe-based container of prior and posterior
variances</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyemu">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyemu" title="Permalink to this headline">¶</a></h2>
<p>pyEMU: python modules for Environmental Model Uncertainty analyses.  These
modules are designed to work directly and seamlessly with PEST and PEST++ model
independent interface.  pyEMU can also be used to setup this interface.</p>
<p>Several forms of uncertainty analyses are support including FOSM-based
analyses (pyemu.Schur and pyemu.ErrVar), data worth analyses and
high-dimensional ensemble generation.</p>
<dl class="py class">
<dt id="pyemu.Cov">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">Cov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">names</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">row_names</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">col_names</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">isdiagonal</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">autoalign</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix" title="pyemu.mat.mat_handler.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.mat.mat_handler.Matrix</span></code></a></p>
<p>Diagonal and/or dense Covariance matrices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>numpy.ndarray</cite>) – numeric values</p></li>
<li><p><strong>names</strong> ([<cite>str</cite>]) – list of row and column names</p></li>
<li><p><strong>isdigonal</strong> (<cite>bool</cite>) – flag if the Matrix is diagonal</p></li>
<li><p><strong>autoalign</strong> (<cite>bool</cite>) – flag to control the autoalignment of Matrix during
linear algebra operations</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;par_</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
<span class="n">mat</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s2">&quot;mat.jco&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>row_names</cite> and <cite>col_names</cite> args are supported in the contructor
so support inheritance.  However, users should only pass <cite>names</cite></p>
</div>
<dl class="py method">
<dt id="pyemu.Cov.condition_on">
<code class="sig-name descname">condition_on</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">conditioning_elements</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.condition_on" title="Permalink to this definition">¶</a></dt>
<dd><p>get a new Covariance object that is conditional on knowing some
elements.  uses Schur’s complement for conditional Covariance
propagation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>conditioning_elements</strong> (<em>[</em><em>'str'</em><em>]</em>) – list of names of elements to condition on</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new conditional <cite>Cov</cite> that assumes <cite>conditioning_elements</cite> have become known</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.from_observation_data">
<em class="property">classmethod </em><code class="sig-name descname">from_observation_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.from_observation_data" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiates a <cite>Cov</cite> from pyemu.Pst.observation_data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – control file instance</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a diagonal observation noise covariance matrix derived from the
weights in the pest control file.  Zero-weighted observations
are included with a weight of 1.0e-30</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Cov</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obscov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_observation_data</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.from_obsweights">
<em class="property">classmethod </em><code class="sig-name descname">from_obsweights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst_file</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.from_obsweights" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiates a <cite>Cov</cite> instance from observation weights in
a PEST control file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pst_file</strong> (<cite>str</cite>) – pest control file name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a diagonal observation noise covariance matrix derived from the
weights in the pest control file.  Zero-weighted observations
are included with a weight of 1.0e-30</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Cov</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calls <cite>Cov.from_observation_data()</cite></p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obscov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_obsweights</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.from_parameter_data">
<em class="property">classmethod </em><code class="sig-name descname">from_parameter_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">4.0</span></em>, <em class="sig-param"><span class="n">scale_offset</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.from_parameter_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a <cite>Cov</cite> from a pest control file parameter data section using
parameter bounds as a proxy for uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst_file</strong> (<cite>str</cite>) – pest control file name</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds
represent 4 * sigma.  Default is 4.0, representing approximately
95% confidence of implied normal distribution</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>) – flag to apply scale and offset to parameter upper and lower
bounds before calculating varaince. In some cases, not applying scale and
offset can result in undefined (log) variance.  Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>diagonal parameter <cite>Cov</cite> matrix created from parameter bounds</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Cov</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calls <cite>Cov.from_parameter_data()</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.from_parbounds">
<em class="property">classmethod </em><code class="sig-name descname">from_parbounds</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst_file</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">4.0</span></em>, <em class="sig-param"><span class="n">scale_offset</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.from_parbounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a <cite>Cov</cite> from a pest control file parameter data section using
parameter bounds as a proxy for uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst_file</strong> (<cite>str</cite>) – pest control file name</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds
represent 4 * sigma.  Default is 4.0, representing approximately
95% confidence of implied normal distribution</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>) – flag to apply scale and offset to parameter upper and lower
bounds before calculating varaince. In some cases, not applying scale and
offset can result in undefined (log) variance.  Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>diagonal parameter <cite>Cov</cite> matrix created from parameter bounds</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Cov</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calls <cite>Cov.from_parameter_data()</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.from_uncfile">
<em class="property">classmethod </em><code class="sig-name descname">from_uncfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.from_uncfile" title="Permalink to this definition">¶</a></dt>
<dd><p>instaniates a <cite>Cov</cite> from a PEST-compatible uncertainty file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – uncertainty file name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>Cov</cite> instance from uncertainty file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Cov</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_uncfile</span><span class="p">(</span><span class="s2">&quot;my.unc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.identity">
<em class="property">property </em><code class="sig-name descname">identity</code><a class="headerlink" href="#pyemu.Cov.identity" title="Permalink to this definition">¶</a></dt>
<dd><p>get an identity <cite>Cov</cite> of the same shape</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new <cite>Cov</cite> instance with identity matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.identity_like">
<em class="property">classmethod </em><code class="sig-name descname">identity_like</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.identity_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an identity matrix Cov instance like other <cite>Cov</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<cite>Matrix</cite>) – other matrix - must be square</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new identity matrix <cite>Cov</cite> with shape of <cite>other</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.names">
<em class="property">property </em><code class="sig-name descname">names</code><a class="headerlink" href="#pyemu.Cov.names" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper for getting row_names.  row_names == col_names for Cov</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.replace">
<code class="sig-name descname">replace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>replace elements in the covariance matrix with elements from other.
if other is not diagonal, then this <cite>Cov</cite> becomes non diagonal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Cov</strong> – the Cov to replace elements in this <cite>Cov</cite> with</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.to_pearson">
<code class="sig-name descname">to_pearson</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.to_pearson" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Cov instance to Pearson correlation coefficient
matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <cite>Matrix</cite> of correlation coefs.  Return type is <cite>Matrix</cite>
on purpose so that it is clear the returned instance is not a Cov</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.to_uncfile">
<code class="sig-name descname">to_uncfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">unc_file</span></em>, <em class="sig-param"><span class="n">covmat_file</span><span class="o">=</span><span class="default_value">'cov.mat'</span></em>, <em class="sig-param"><span class="n">var_mult</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">include_path</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Cov.to_uncfile" title="Permalink to this definition">¶</a></dt>
<dd><p>write a PEST-compatible uncertainty file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unc_file</strong> (<cite>str</cite>) – filename of the uncertainty file</p></li>
<li><p><strong>covmat_file</strong> (<cite>str</cite>) – covariance matrix filename. Default is
“Cov.mat”.  If None, and Cov.isdiaonal, then a standard deviation
form of the uncertainty file is written.  Exception raised if <cite>covmat_file</cite> is <cite>None</cite>
and not <cite>Cov.isdiagonal</cite></p></li>
<li><p><strong>var_mult</strong> (<cite>float</cite>) – variance multiplier for the covmat_file entry</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_parameter_data</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">cov</span><span class="o">.</span><span class="n">to_uncfile</span><span class="p">(</span><span class="s2">&quot;my.unc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Cov.zero">
<em class="property">property </em><code class="sig-name descname">zero</code><a class="headerlink" href="#pyemu.Cov.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>get an instance of <cite>Cov</cite> with all zeros</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new <cite>Cov</cite> instance with zeros</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Cov</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.Ensemble">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">Ensemble</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">istransformed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>based class for handling ensembles of numeric values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>df</strong> (<cite>pandas.DataFrame</cite>) – a pandas dataframe.  Columns
should be parameter/observation names.  Index is
treated as realization names</p></li>
<li><p><strong>istransformed</strong> (<cite>bool</cite>) – flag to indicate parameter values
are in log space.  Not used for <cite>ObservationEnsemble</cite></p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.Ensemble.as_pyemu_matrix">
<code class="sig-name descname">as_pyemu_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">typ</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.as_pyemu_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>get a <cite>pyemu.Matrix</cite> instance of <cite>Ensemble</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>typ</strong> (<cite>pyemu.Matrix</cite> or <cite>pyemu.Cov</cite>) – the type of matrix to return.
Default is <cite>pyemu.Matrix</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a matrix instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">oe</span><span class="o">.</span><span class="n">add_base</span><span class="p">()</span>
<span class="n">oe_dev</span> <span class="o">=</span> <span class="n">oe</span><span class="o">.</span><span class="n">get_deviations</span><span class="p">(</span><span class="n">center_on</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">)</span>
<span class="n">oe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;obs_base_devs.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.back_transform">
<code class="sig-name descname">back_transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.back_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>back transform parameters with respect to <cite>partrans</cite> value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place (None is returned).</p>
<p>Parameter transform is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
<p><cite>Ensemble.back_transform() is only provided for inhertance purposes.
It only changes the `Ensemble._transformed</cite> flag</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>get a copy of <cite>Ensemble</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>copy of this <cite>Ensemble</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Ensemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>copies both <cite>Ensemble.pst</cite> and <cite>Ensemble._df</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.covariance_matrix">
<code class="sig-name descname">covariance_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">localizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">center_on</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>get a empirical covariance matrix implied by the
correlations between realizations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>localizer</strong> (<cite>pyemu.Matrix</cite>, optional) – a matrix to localize covariates
in the resulting covariance matrix.  Default is None</p></li>
<li><p><strong>center_on</strong> (<cite>str</cite>, optional) – a realization name to use as the centering
point in ensemble space.  If <cite>None</cite>, the mean vector is
treated as the centering point.  Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the empirical (and optionally localized) covariance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.dropna">
<code class="sig-name descname">dropna</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.dropna" title="Permalink to this definition">¶</a></dt>
<dd><p>override of <cite>pandas.DataFrame.dropna()</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>[</strong><strong>object</strong><strong>]</strong> (<em>*args</em>) – positional arguments to pass to
<cite>pandas.DataFrame.dropna()</cite>.</p></li>
<li><p><strong>(</strong><strong>{str</strong> (<em>**kwargs</em>) – <cite>object</cite>}): keyword arguments to pass
to <cite>pandas.DataFrame.dropna()</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.from_binary">
<em class="property">classmethod </em><code class="sig-name descname">from_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.from_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>create an <cite>Ensemble</cite> from a PEST-style binary file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – filename containing binary ensemble</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the ensembled loaded from the binary file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Ensemble</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_binary</span><span class="p">(</span><span class="s2">&quot;obs.jcb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.from_csv">
<em class="property">classmethod </em><code class="sig-name descname">from_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>create an <cite>Ensemble</cite> from a CSV file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – filename containing CSV ensemble</p></li>
<li><p><strong>(</strong><strong>[</strong><strong>object</strong><strong>]</strong> (<em>*args</em>) – positional arguments to pass to
<cite>pandas.read_csv()</cite>.</p></li>
<li><p><strong>(</strong><strong>{str</strong> (<em>**kwargs</em>) – <cite>object</cite>}): keyword arguments to pass
to <cite>pandas.read_csv()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>Ensemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>uses <cite>pandas.read_csv()</cite> to load numeric values from
CSV file</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s2">&quot;obs.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.from_dataframe">
<em class="property">classmethod </em><code class="sig-name descname">from_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">istransformed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.get_deviations">
<code class="sig-name descname">get_deviations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">center_on</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.get_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>get the deviations of the realizations around a certain
point in ensemble space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>center_on</strong> (<cite>str</cite>, optional) – a realization name to use as the centering
point in ensemble space.  If <cite>None</cite>, the mean vector is
treated as the centering point.  Default is None</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an ensemble of deviations around the centering point</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Ensemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>deviations are the Euclidean distances from the <cite>center_on</cite> value to
realized values for each column</p>
<p><cite>center_on=None</cite> yields the classic ensemble smoother/ensemble Kalman
filter deviations</p>
<p>Deviations respect log-transformation status.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.istransformed">
<em class="property">property </em><code class="sig-name descname">istransformed</code><a class="headerlink" href="#pyemu.Ensemble.istransformed" title="Permalink to this definition">¶</a></dt>
<dd><p>the parameter transformation status</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flag to indicate whether or not the <cite>ParameterEnsemble</cite> is
transformed with respect to log_{10}.  Not used for (and has no effect
on) <cite>ObservationEnsemble</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>bool</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>parameter transformation status is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">facecolor</span><span class="o">=</span><span class="default_value">'0.5'</span></em>, <em class="sig-param"><span class="n">plot_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'ensemble.pdf'</span></em>, <em class="sig-param"><span class="n">func_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>plot ensemble histograms to multipage pdf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> (<cite>int</cite>) – number of bins for the histograms</p></li>
<li><p><strong>facecolor</strong> (<cite>str</cite>) – matplotlib color (e.g. <cite>r</cite>,`g`, etc)</p></li>
<li><p><strong>plot_cols</strong> ([<cite>str</cite>]) – list of subset of ensemble columns to plot.
If None, all are plotted. Default is None</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – multipage pdf filename. Default is “ensemble.pdf”</p></li>
<li><p><strong>func_dict</strong> (<cite>dict</cite>) – a dict of functions to apply to specific
columns. For example: {“par1”: np.log10}</p></li>
<li><p><strong>**kwargs</strong> (<cite>dict</cite>) – addkeyword args to pass to <cite>pyemu.plot_utils.ensemble_helper()</cite></p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span> <span class="c1"># plot log space (if needed)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Ensemble.pst">
<code class="sig-name descname">pst</code><a class="headerlink" href="#pyemu.Ensemble.pst" title="Permalink to this definition">¶</a></dt>
<dd><p>control file instance</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>pyemu.Pst</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.reseed">
<em class="property">static </em><code class="sig-name descname">reseed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.reseed" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the <cite>numpy.random.seed</cite></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>reseeds using the pyemu.en.SEED global variable</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.to_binary">
<code class="sig-name descname">to_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.to_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>write <cite>Ensemble</cite> to a PEST-style binary file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – file to write</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">oe</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s2">&quot;obs.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>back transforms <cite>ParameterEnsemble</cite> before writing so that
values are in arithmatic space</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.to_csv">
<code class="sig-name descname">to_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>write <cite>Ensemble</cite> to a CSV file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – file to write</p></li>
<li><p><strong>(</strong><strong>[</strong><strong>object</strong><strong>]</strong> (<em>*args</em>) – positional arguments to pass to
<cite>pandas.DataFrame.to_csv()</cite>.</p></li>
<li><p><strong>(</strong><strong>{str</strong> (<em>**kwargs</em>) – <cite>object</cite>}): keyword arguments to pass
to <cite>pandas.DataFrame.to_csv()</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">oe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;obs.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>back transforms <cite>ParameterEnsemble</cite> before writing so that
values are in arithmatic space</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Ensemble.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Ensemble.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transform parameters with respect to <cite>partrans</cite> value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place (None is returned).</p>
<p>Parameter transform is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
<p><cite>Ensemble.transform() is only provided for inhertance purposes.
It only changes the `Ensemble._transformed</cite> flag</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.ErrVar">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">ErrVar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jco</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.la.LinearAnalysis</span></code></a></p>
<p>FOSM-based error variance analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jco</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast or loaded into a <cite>pyemu.Jco</cite>.  Can be a
str for a filename or <cite>pyemu.Matrix</cite>/<cite>pyemu.Jco</cite> object.</p></li>
<li><p><strong>pst</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast into a <cite>pyemu.Pst</cite>.  Can be an <cite>str</cite> for a
filename or an existing <cite>pyemu.Pst</cite>.  If <cite>None</cite>, a pst filename is sought
with the same base name as the jco argument (if passed)</p></li>
<li><p><strong>parcov</strong> (<em>varies</em><em>, </em><em>optional</em>) – prior parameter covariance matrix.  If <cite>str</cite>, a filename is assumed and
the prior parameter covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the prior parameter covariance matrix is
constructed from the parameter bounds in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>obscov</strong> (<em>varies</em><em>, </em><em>optional</em>) – observation noise covariance matrix.  If <cite>str</cite>, a filename is assumed and
the noise covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the noise covariance matrix is
constructed from the obsevation weights in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>forecasts</strong> (<em>varies</em><em>, </em><em>optional</em>) – forecast sensitivity vectors.  If <cite>str</cite>, first an observation name is assumed (a row
in <cite>LinearAnalysis.jco</cite>).  If that is not found, a filename is assumed and predictions are
loaded from a file using the file extension.  If [<cite>str</cite>], a list of observation names is assumed.
Can also be a <cite>pyemu.Matrix</cite> instance, a <cite>numpy.ndarray</cite> or a collection.  Note if the PEST++ option
“++forecasts()” is set in the pest control file (under the <cite>pyemu.Pst.pestpp_options</cite> dictionary),
then there is no need to pass this argument (unless you want to analyze different forecasts)
of <cite>pyemu.Matrix</cite> or <cite>numpy.ndarray</cite>.</p></li>
<li><p><strong>ref_var</strong> (<em>float</em><em>, </em><em>optional</em>) – reference variance.  Default is 1.0</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – controls screen output.  If <cite>str</cite>, a filename is assumed and
and log file is written.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>, optional) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds represent 4 * sigma.
Default is 4.0, representing approximately 95% confidence of implied normal distribution.
This arg is only used if constructing parcov from parameter bounds.</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>, optional) – flag to apply parameter scale and offset to parameter bounds
when calculating prior parameter covariance matrix from bounds.  This arg is onlyused if
constructing parcov from parameter bounds.Default is True.</p></li>
<li><p><strong>omitted_parameters</strong> ([<cite>str</cite>]) – list of parameters to treat as “omitted”.  Passing this argument
activates 3-term error variance analysis.</p></li>
<li><p><strong>omitted_parcov</strong> (<em>varies</em>) – an argument that can be cast to a parcov for the omitted parameters.
If None, omitted_parcov will be formed by extracting a sub-matrix from the <cite>LinearAnalsis.parcov</cite>
attribute.</p></li>
<li><p><strong>omitted_predictions</strong> (<em>varies</em>) – an argument that can be cast to a “predictions” (e.g. “forecasts”)
attribute to form prediction sensitivity vectors with respec to the omitted parameters.  If None,
these vectors will be extracted from the <cite>pyemu.LinearAnalysis.predictions</cite> attribute</p></li>
<li><p><strong>kl</strong> (<cite>bool</cite>, optional) – flag to perform Karhunen-Loeve scaling on the jacobian before error variance
calculations. If <cite>True</cite>, the <cite>pyemu.ErrVar.jco</cite> and <cite>pyemu.ErrVar.parcov</cite> are altered in place.
Default is <cite>False</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ev</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ErrVar</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">,</span><span class="n">omitted_parameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wel1&quot;</span><span class="p">,</span><span class="s2">&quot;wel2&quot;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">get_errvar_dataframe</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.ErrVar.G">
<code class="sig-name descname">G</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.G" title="Permalink to this definition">¶</a></dt>
<dd><p>get the parameter solution Matrix at a given singular value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc G at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameter solution matrix  (V_1 * S_1^(_1) * U_1^T) at <cite>singular_value</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.I_minus_R">
<code class="sig-name descname">I_minus_R</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.I_minus_R" title="Permalink to this definition">¶</a></dt>
<dd><p>get I - R at a given singular value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calculate I - R at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>identity matrix minus resolution matrix at <cite>singular_value</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.R">
<code class="sig-name descname">R</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.R" title="Permalink to this definition">¶</a></dt>
<dd><p>get resolution Matrix (V_1 * V_1^T) at a given singular value</p>
<p>Args:
singular_value (<cite>int</cite>): singular value to calculate <cite>R</cite> at</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>resolution matrix at <cite>singular_value</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.first_forecast">
<code class="sig-name descname">first_forecast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.first_forecast" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the null space term (first term) contribution to forecast (e.g. prediction)</dt><dd><p>error variance at a given singular value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc first term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to construct the error variance dataframe</p>
<p>Just a wrapper around <cite>ErrVar.first_forecast</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of (“first”,prediction_names),error variance pairs at <cite>singular_value</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.first_parameter">
<code class="sig-name descname">first_parameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.first_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the null space term (first term) contribution to parameter error variance</dt><dd><p>at a given singular value</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc first term at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>first term contribution to parameter error variance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.first_prediction">
<code class="sig-name descname">first_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.first_prediction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the null space term (first term) contribution to prediction error variance</dt><dd><p>at a given singular value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc first term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to construct the error variance dataframe</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of (“first”,prediction_names),error variance pairs at <cite>singular_value</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.get_errvar_dataframe">
<code class="sig-name descname">get_errvar_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.get_errvar_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>primary entry point for error variance analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_values</strong> ([<cite>int</cite>], optional) – a list singular values to test. If <cite>None</cite>,
defaults to <cite>range(0,min(nnz_obs,nadj_par) + 1)</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a multi-indexed pandas dataframe summarizing each of the
error variance terms for each nominated forecast. Rows are the singluar values
tested, columns are a multi-index of forecast name and error variance term number
(e.g. 1,2 or (optionally) 3).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ev</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ErrVar</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">,</span><span class="n">omitted_parameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wel1&quot;</span><span class="p">,</span><span class="s2">&quot;wel2&quot;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">get_errvar_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.get_identifiability_dataframe">
<code class="sig-name descname">get_identifiability_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">precondition</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.get_identifiability_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>primary entry point for identifiability analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>singular_value</strong> (<cite>int</cite>) – the singular spectrum truncation point. Defaults
to minimum of non-zero-weighted observations and adjustable parameters</p></li>
<li><p><strong>precondition</strong> (<cite>bool</cite>) – flag to use the preconditioned hessian with the prior
parameter covariance matrix (xtqt + sigma_theta^-1).  This should be used
KL scaling. Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pandas dataframe of the right solution-space singular
vectors and identifiability (identifiabiity is in the column labeled “ident”)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ev</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ErrVar</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">get_identifiability_dataframe</span><span class="p">(</span><span class="n">singular_value</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">ident</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.get_null_proj">
<code class="sig-name descname">get_null_proj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maxsing</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eigthresh</span><span class="o">=</span><span class="default_value">1e-06</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.get_null_proj" title="Permalink to this definition">¶</a></dt>
<dd><p>get a null-space projection matrix of XTQX</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxsing</strong> (<cite>int</cite>, optional) – number of singular components
to use (the truncation point).  If None, <cite>pyemu.Matrx.get_maxsing()
is used to determine the truncation point with `eigthresh</cite>. Default
is None</p></li>
<li><p><strong>eigthresh</strong> (<cite>float</cite>, optional) – the ratio of smallest to largest singular
value to keep in the range (solution) space of XtQX.  Not used if
<cite>maxsing</cite> is not <cite>None</cite>.  Default is 1.0e-6</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>used for null-space monte carlo operations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>pyemu.Matrix</cite> the null-space projection matrix (V2V2^T)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.omitted_jco">
<em class="property">property </em><code class="sig-name descname">omitted_jco</code><a class="headerlink" href="#pyemu.ErrVar.omitted_jco" title="Permalink to this definition">¶</a></dt>
<dd><p>the omitted-parameters jacobian matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the jacobian matrix instance of non-zero-weighted observations and
omitted parameters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Jco</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.omitted_parcov">
<em class="property">property </em><code class="sig-name descname">omitted_parcov</code><a class="headerlink" href="#pyemu.ErrVar.omitted_parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>the prior omitted-parameter covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the prior parameter covariance matrix of the
omitted parameters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.omitted_predictions">
<em class="property">property </em><code class="sig-name descname">omitted_predictions</code><a class="headerlink" href="#pyemu.ErrVar.omitted_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>omitted prediction sensitivity vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a matrix of prediction sensitivity vectors (column wise) to
omitted parameters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.second_forecast">
<code class="sig-name descname">second_forecast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.second_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>get the solution space contribution to forecast (e.g. “prediction”) error variance
at a given singular value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc second term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to construct error variance dataframe</p>
<p>Just a thin wrapper around <cite>ErrVar.second_prediction</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of (“second”,prediction_names), error variance
arising from the solution space contribution (y^t * G * obscov * G^T * y)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.second_parameter">
<code class="sig-name descname">second_parameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.second_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the solution space contribution to parameter error variance</dt><dd><p>at a given singular value (G * obscov * G^T)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc second term at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the second term contribution to parameter error variance
(G * obscov * G^T)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.second_prediction">
<code class="sig-name descname">second_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.second_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>get the solution space contribution to predictive error variance
at a given singular value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc second term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is used to construct error variance dataframe</p>
</div>
<dl class="simple">
<dt>Returns:            <cite>dict</cite>:  dictionary of (“second”,prediction_names), error variance</dt><dd><p>arising from the solution space contribution (y^t * G * obscov * G^T * y)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.third_forecast">
<code class="sig-name descname">third_forecast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.third_forecast" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the omitted parameter contribution to forecast (<cite>prediction</cite>) error variance</dt><dd><p>at a given singular value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc third term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>used to construct error variance dataframe
just a thin wrapper around <cite>ErrVar.third_prediction()</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of (“third”,prediction_names),error variance</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.third_parameter">
<code class="sig-name descname">third_parameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.third_parameter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the omitted parameter contribution to parameter error variance</dt><dd><p>at a given singular value</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc third term at</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the third term contribution to parameter error variance
calculated at <cite>singular_value</cite> (G * omitted_jco * Sigma_(omitted_pars) *
omitted_jco^T * G^T).  Returns 0.0 if third term calculations are not
being used.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.third_prediction">
<code class="sig-name descname">third_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.third_prediction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the omitted parameter contribution to prediction error variance</dt><dd><p>at a given singular value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to calc third term at</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>used to construct error variance dataframe</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of (“third”,prediction_names),error variance</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ErrVar.variance_at">
<code class="sig-name descname">variance_at</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">singular_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ErrVar.variance_at" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the error variance of all three error variance terms at a</dt><dd><p>given singluar value</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>singular_value</strong> (<cite>int</cite>) – singular value to test</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary of (err var term,prediction_name), variance pairs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.Jco">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">Jco</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">row_names</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">col_names</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">isdiagonal</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">autoalign</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Jco" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyemu.mat.html#pyemu.mat.mat_handler.Matrix" title="pyemu.mat.mat_handler.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.mat.mat_handler.Matrix</span></code></a></p>
<p>a thin wrapper class to get more intuitive attribute names.  Functions
exactly like <cite>Matrix</cite></p>
<dl class="py method">
<dt id="pyemu.Jco.from_pst">
<em class="property">classmethod </em><code class="sig-name descname">from_pst</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">random</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Jco.from_pst" title="Permalink to this definition">¶</a></dt>
<dd><p>construct a new empty Jco from a control file filled
with trash</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a pest control file instance.  If type is ‘str’,
<cite>pst</cite> is loaded from filename</p></li>
<li><p><strong>random</strong> (<cite>bool</cite>) – flag for contents of the trash matrix.
If True, fill with random numbers, if False, fill with zeros
Default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the new Jco instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Jco</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Jco.nobs">
<em class="property">property </em><code class="sig-name descname">nobs</code><a class="headerlink" href="#pyemu.Jco.nobs" title="Permalink to this definition">¶</a></dt>
<dd><p>number of observations in the Jco</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of observations (rows)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Jco.npar">
<em class="property">property </em><code class="sig-name descname">npar</code><a class="headerlink" href="#pyemu.Jco.npar" title="Permalink to this definition">¶</a></dt>
<dd><p>number of parameters in the Jco</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of parameters (columns)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Jco.obs_names">
<em class="property">property </em><code class="sig-name descname">obs_names</code><a class="headerlink" href="#pyemu.Jco.obs_names" title="Permalink to this definition">¶</a></dt>
<dd><p>thin wrapper around <cite>Matrix.row_names</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of observation names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[‘str’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Jco.par_names">
<em class="property">property </em><code class="sig-name descname">par_names</code><a class="headerlink" href="#pyemu.Jco.par_names" title="Permalink to this definition">¶</a></dt>
<dd><p>thin wrapper around <cite>Matrix.col_names</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of parameter names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.LinearAnalysis">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">LinearAnalysis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jco</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pst</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parcov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">obscov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">predictions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ref_var</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">resfile</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">forecasts</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">4.0</span></em>, <em class="sig-param"><span class="n">scale_offset</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The base/parent class for linear analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jco</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast or loaded into a <cite>pyemu.Jco</cite>.  Can be a
str for a filename or <cite>pyemu.Matrix</cite>/<cite>pyemu.Jco</cite> object.</p></li>
<li><p><strong>pst</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast into a <cite>pyemu.Pst</cite>.  Can be an <cite>str</cite> for a
filename or an existing <cite>pyemu.Pst</cite>.  If <cite>None</cite>, a pst filename is sought
with the same base name as the jco argument (if passed)</p></li>
<li><p><strong>parcov</strong> (<em>varies</em><em>, </em><em>optional</em>) – prior parameter covariance matrix.  If <cite>str</cite>, a filename is assumed and
the prior parameter covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the prior parameter covariance matrix is
constructed from the parameter bounds in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>obscov</strong> (<em>varies</em><em>, </em><em>optional</em>) – observation noise covariance matrix.  If <cite>str</cite>, a filename is assumed and
the noise covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the noise covariance matrix is
constructed from the obsevation weights in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>forecasts</strong> (<em>varies</em><em>, </em><em>optional</em>) – forecast sensitivity vectors.  If <cite>str</cite>, first an observation name is assumed (a row
in <cite>LinearAnalysis.jco</cite>).  If that is not found, a filename is assumed and predictions are
loaded from a file using the file extension.  If [<cite>str</cite>], a list of observation names is assumed.
Can also be a <cite>pyemu.Matrix</cite> instance, a <cite>numpy.ndarray</cite> or a collection
of <cite>pyemu.Matrix</cite> or <cite>numpy.ndarray</cite>.</p></li>
<li><p><strong>ref_var</strong> (<em>float</em><em>, </em><em>optional</em>) – reference variance.  Default is 1.0</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – controls screen output.  If <cite>str</cite>, a filename is assumed and
and log file is written.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>, optional) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds represent 4 * sigma.
Default is 4.0, representing approximately 95% confidence of implied normal distribution.
This arg is only used if constructing parcov from parameter bounds.</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>, optional) – flag to apply parameter scale and offset to parameter bounds
when calculating prior parameter covariance matrix from bounds.  This arg is onlyused if
constructing parcov from parameter bounds.Default is True.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used directly, but for prior uncertainty analyses only.</p>
<p>The derived types (<cite>pyemu.Schur</cite>, <cite>pyemu.ErrVar</cite>) are for different
forms of FOMS-based posterior uncertainty analyses.</p>
<p>This class tries hard to not load items until they are needed; all arguments are optional.</p>
<p>The class makes heavy use of property decorator to encapsulated private attributes</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#assumes &quot;my.pst&quot; exists</span>
<span class="n">la</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">LinearAnalysis</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">,</span><span class="n">forecasts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="s2">&quot;fore2&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">prior_forecast</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.LinearAnalysis.adj_par_names">
<em class="property">property </em><code class="sig-name descname">adj_par_names</code><a class="headerlink" href="#pyemu.LinearAnalysis.adj_par_names" title="Permalink to this definition">¶</a></dt>
<dd><p>adjustable parameter names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of adjustable parameter names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[‘str`]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if <cite>LinearAnalysis.pst</cite> is <cite>None</cite>, returns <cite>LinearAnalysis.jco.col_names</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.adjust_obscov_resfile">
<code class="sig-name descname">adjust_obscov_resfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">resfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.adjust_obscov_resfile" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the elements of obscov by scaling the implied weights
based on the phi components in res_file so that the total phi
is equal to the number of non-zero weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>resfile</strong> (<cite>str</cite>) – residual file to use.  If None, residual
file with case name is sought. default is None</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>calls <cite>pyemu.Pst.adjust_weights_resfile()</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.apply_karhunen_loeve_scaling">
<code class="sig-name descname">apply_karhunen_loeve_scaling</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.apply_karhunen_loeve_scaling" title="Permalink to this definition">¶</a></dt>
<dd><p>apply karhuene-loeve scaling to the jacobian matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This scaling is not necessary for analyses using Schur’s
complement, but can be very important for error variance
analyses.  This operation effectively transfers prior knowledge
specified in the parcov to the jacobian and reset parcov to the
identity matrix.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.clean">
<code class="sig-name descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>drop regularization and prior information observation from the jco</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.drop_prior_information">
<code class="sig-name descname">drop_prior_information</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.drop_prior_information" title="Permalink to this definition">¶</a></dt>
<dd><p>drop the prior information from the jco and pst attributes</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.fehalf">
<em class="property">property </em><code class="sig-name descname">fehalf</code><a class="headerlink" href="#pyemu.LinearAnalysis.fehalf" title="Permalink to this definition">¶</a></dt>
<dd><p>Karhunen-Loeve scaling matrix attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the Karhunen-Loeve scaling matrix based on the prior
parameter covariance matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.forecast_names">
<em class="property">property </em><code class="sig-name descname">forecast_names</code><a class="headerlink" href="#pyemu.LinearAnalysis.forecast_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the forecast (aka prediction) names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of forecast names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>([<cite>str</cite>])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.forecasts">
<em class="property">property </em><code class="sig-name descname">forecasts</code><a class="headerlink" href="#pyemu.LinearAnalysis.forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>the forecast sentivity vectors attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a matrix of forecast (prediction) sensitivity vectors (column wise)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.forecasts_iter">
<em class="property">property </em><code class="sig-name descname">forecasts_iter</code><a class="headerlink" href="#pyemu.LinearAnalysis.forecasts_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>forecast (e.g. prediction) sensitivity vectors iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>iterator on forecasts (e.g. predictions) sensitivity vectors (matrix)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>iterator</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is used for processing huge numbers of predictions</p>
<p>This is a synonym for LinearAnalysis.predictions_iter()</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">obs_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">astype</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.get" title="Permalink to this definition">¶</a></dt>
<dd><p>method to get a new LinearAnalysis class using a
subset of parameters and/or observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par_names</strong> ([<cite>‘str</cite>]) – par names for new object</p></li>
<li><p><strong>obs_names</strong> ([<cite>‘str</cite>]) – obs names for new object</p></li>
<li><p><strong>astype</strong> (<cite>pyemu.Schur</cite> or <cite>pyemu.ErrVar</cite>) – type to
cast the new object.  If None, return type is
same as self</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>LinearAnalysis</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.get_cso_dataframe">
<code class="sig-name descname">get_cso_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.get_cso_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe of composite observation sensitivity, as returned by PEST in the
seo file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataframe of observation names and composite observation
sensitivity</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>That this formulation deviates slightly from the PEST documentation in that the
values are divided by (npar-1) rather than by (npar).</p>
<p>The equation is cso_j = ((Q^1/2*J*J^T*Q^1/2)^1/2)_jj/(NPAR-1)</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.get_obs_competition_dataframe">
<code class="sig-name descname">get_obs_competition_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.get_obs_competition_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get the observation competition stat a la PEST utility</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe of observation names by
observation names with values equal to the PEST
competition statistic</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.get_par_css_dataframe">
<code class="sig-name descname">get_par_css_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.get_par_css_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dataframe of composite scaled sensitivities.  Includes both
PEST-style and Hill-style.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe of parameter names, PEST-style and
Hill-style composite scaled sensitivity</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.jco">
<em class="property">property </em><code class="sig-name descname">jco</code><a class="headerlink" href="#pyemu.LinearAnalysis.jco" title="Permalink to this definition">¶</a></dt>
<dd><p>the jacobian matrix attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the jacobian matrix attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Jco</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.mle_covariance">
<em class="property">property </em><code class="sig-name descname">mle_covariance</code><a class="headerlink" href="#pyemu.LinearAnalysis.mle_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>maximum likelihood parameter covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>maximum likelihood parameter covariance matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.mle_parameter_estimate">
<em class="property">property </em><code class="sig-name descname">mle_parameter_estimate</code><a class="headerlink" href="#pyemu.LinearAnalysis.mle_parameter_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>maximum likelihood parameter estimate.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the maximum likelihood parameter estimates</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.nnz_obs_names">
<em class="property">property </em><code class="sig-name descname">nnz_obs_names</code><a class="headerlink" href="#pyemu.LinearAnalysis.nnz_obs_names" title="Permalink to this definition">¶</a></dt>
<dd><p>non-zero-weighted observation names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of non-zero-weighted observation names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[‘str`]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if <cite>LinearAnalysis.pst</cite> is <cite>None</cite>, returns <cite>LinearAnalysis.jco.row_names</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.obscov">
<em class="property">property </em><code class="sig-name descname">obscov</code><a class="headerlink" href="#pyemu.LinearAnalysis.obscov" title="Permalink to this definition">¶</a></dt>
<dd><p>get the observation noise covariance matrix attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a reference to the <cite>LinearAnalysis.obscov</cite> attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.parcov">
<em class="property">property </em><code class="sig-name descname">parcov</code><a class="headerlink" href="#pyemu.LinearAnalysis.parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>get the prior parameter covariance matrix attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a reference to the <cite>LinearAnalysis.parcov</cite> attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.predictions">
<em class="property">property </em><code class="sig-name descname">predictions</code><a class="headerlink" href="#pyemu.LinearAnalysis.predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>the prediction (aka forecast) sentivity vectors attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a matrix of prediction sensitivity vectors (column wise)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.predictions_iter">
<em class="property">property </em><code class="sig-name descname">predictions_iter</code><a class="headerlink" href="#pyemu.LinearAnalysis.predictions_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>prediction sensitivity vectors iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>iterator on prediction sensitivity vectors (matrix)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>iterator</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this is used for processing huge numbers of predictions</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.prior_forecast">
<em class="property">property </em><code class="sig-name descname">prior_forecast</code><a class="headerlink" href="#pyemu.LinearAnalysis.prior_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>prior forecast (e.g. prediction) variances</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of forecast name, prior variance pairs</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.prior_parameter">
<em class="property">property </em><code class="sig-name descname">prior_parameter</code><a class="headerlink" href="#pyemu.LinearAnalysis.prior_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>prior parameter covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>prior parameter covariance matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.prior_prediction">
<em class="property">property </em><code class="sig-name descname">prior_prediction</code><a class="headerlink" href="#pyemu.LinearAnalysis.prior_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>prior prediction (e.g. forecast) variances</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of prediction name, prior variance pairs</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.pst">
<em class="property">property </em><code class="sig-name descname">pst</code><a class="headerlink" href="#pyemu.LinearAnalysis.pst" title="Permalink to this definition">¶</a></dt>
<dd><p>the pst attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the pst attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Pst</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.qhalf">
<em class="property">property </em><code class="sig-name descname">qhalf</code><a class="headerlink" href="#pyemu.LinearAnalysis.qhalf" title="Permalink to this definition">¶</a></dt>
<dd><p>square root of the cofactor matrix attribute. Create the attribute if
it has not yet been created</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>square root of the cofactor matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.qhalfx">
<em class="property">property </em><code class="sig-name descname">qhalfx</code><a class="headerlink" href="#pyemu.LinearAnalysis.qhalfx" title="Permalink to this definition">¶</a></dt>
<dd><p>half normal matrix attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>half normal matrix attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.reset_obscov">
<code class="sig-name descname">reset_obscov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.reset_obscov" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the obscov attribute to None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<cite>str</cite> or <cite>pyemu.Matrix</cite>) – the value to assign to the obscov
attribute.  If None, the private __obscov attribute is cleared
but not reset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.reset_parcov">
<code class="sig-name descname">reset_parcov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.reset_parcov" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the parcov attribute to None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<cite>str</cite> or <cite>pyemu.Matrix</cite>) – the value to assign to the parcov
attribute.  If None, the private __parcov attribute is cleared
but not reset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.reset_pst">
<code class="sig-name descname">reset_pst</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.LinearAnalysis.reset_pst" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the LinearAnalysis.pst attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<cite>str</cite> or <cite>pyemu.Pst</cite>) – the value to assign to the pst attribute</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.LinearAnalysis.xtqx">
<em class="property">property </em><code class="sig-name descname">xtqx</code><a class="headerlink" href="#pyemu.LinearAnalysis.xtqx" title="Permalink to this definition">¶</a></dt>
<dd><p>normal matrix attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>normal matrix attribute</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Matrix</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.Matrix">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">Matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">row_names</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">col_names</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">isdiagonal</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">autoalign</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Easy linear algebra in the PEST(++) realm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>numpy.ndarray</cite>) – numeric values</p></li>
<li><p><strong>row_names</strong> ([<cite>str</cite>]) – list of row names</p></li>
<li><p><strong>col_names</strong> (<em>[</em><em>'str'</em><em>]</em>) – list of column names</p></li>
<li><p><strong>isdigonal</strong> (<cite>bool</cite>) – flag if the Matrix is diagonal</p></li>
<li><p><strong>autoalign</strong> (<cite>bool</cite>) – flag to control the autoalignment of Matrix
during linear algebra operations</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">row_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;row_</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;col_</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">row_names</span><span class="o">=</span><span class="n">row_names</span><span class="p">,</span><span class="n">col_names</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>
<span class="n">mat</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s2">&quot;mat.jco&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this class makes heavy use of property decorators to encapsulate
private attributes</p>
</div>
<dl class="py method">
<dt id="pyemu.Matrix.T">
<em class="property">property </em><code class="sig-name descname">T</code><a class="headerlink" href="#pyemu.Matrix.T" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper function for <cite>Matrix.transpose()</cite> method</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>transpose of <cite>Matrix</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.align">
<code class="sig-name descname">align</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">names</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.align" title="Permalink to this definition">¶</a></dt>
<dd><p>reorder <cite>Matrix</cite> by names in place.  If axis is None, reorder both indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<em>[</em><em>'str'</em><em>]</em>) – names in <cite>Matrix.row_names</cite> andor <cite>Matrix.col_names</cite></p></li>
<li><p><strong>axis</strong> (<cite>int</cite>, optional) – the axis to reorder. if None, reorder both axes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.as_2d">
<em class="property">property </em><code class="sig-name descname">as_2d</code><a class="headerlink" href="#pyemu.Matrix.as_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>get a 2D numeric representation of <cite>Matrix.x</cite>.  If not <cite>isdiagonal</cite>, simply
return reference to <cite>Matrix.x</cite>, otherwise, constructs and returns
a 2D, diagonal ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.binary_header_dt">
<code class="sig-name descname">binary_header_dt</code><em class="property"> = dtype([('itemp1', '&lt;i4'), ('itemp2', '&lt;i4'), ('icount', '&lt;i4')])</em><a class="headerlink" href="#pyemu.Matrix.binary_header_dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.binary_rec_dt">
<code class="sig-name descname">binary_rec_dt</code><em class="property"> = dtype([('j', '&lt;i4'), ('dtemp', '&lt;f8')])</em><a class="headerlink" href="#pyemu.Matrix.binary_rec_dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.char">
<code class="sig-name descname">char</code><a class="headerlink" href="#pyemu.Matrix.char" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.uint8</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.coo_rec_dt">
<code class="sig-name descname">coo_rec_dt</code><em class="property"> = dtype([('i', '&lt;i4'), ('j', '&lt;i4'), ('dtemp', '&lt;f8')])</em><a class="headerlink" href="#pyemu.Matrix.coo_rec_dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>get a copy of <cite>Matrix</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>copy of this <cite>Matrix</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.df" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper of Matrix.to_dataframe()</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.double">
<code class="sig-name descname">double</code><a class="headerlink" href="#pyemu.Matrix.double" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.drop">
<code class="sig-name descname">drop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">names</span></em>, <em class="sig-param"><span class="n">axis</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.drop" title="Permalink to this definition">¶</a></dt>
<dd><p>drop elements from <cite>Matrix</cite> in place</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<em>[</em><em>'str'</em><em>]</em>) – list of names to drop</p></li>
<li><p><strong>axis</strong> (<cite>int</cite>) – the axis to drop from. must be in [0,1]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.element_isaligned">
<code class="sig-name descname">element_isaligned</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.element_isaligned" title="Permalink to this definition">¶</a></dt>
<dd><p>check if matrices are aligned for element-wise operations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<cite>Matrix</cite>) – the other matrix to check for alignment with</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if aligned, False if not aligned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.extend">
<code class="sig-name descname">extend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.extend" title="Permalink to this definition">¶</a></dt>
<dd><p>extend <cite>Matrix</cite> with the elements of other.</p>
<p>Args:
other (<cite>Matrix</cite>):  the Matrix to extend self by
inplace (<cite>bool</cite>): inplace = True not implemented</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new, extended <cite>Matrix</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.extract">
<code class="sig-name descname">extract</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">row_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">col_names</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.extract" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper method that <cite>Matrix.gets()</cite> then <cite>Matrix.drops()</cite> elements.
one of row_names or col_names must be not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row_names</strong> (<em>[</em><em>'str'</em><em>]</em><em>, </em><em>optional</em>) – row_names to extract.  If <cite>None</cite>,
all row_names are retained.</p></li>
<li><p><strong>col_names</strong> (<em>[</em><em>'str'</em><em>]</em><em>, </em><em>optional</em>) – col_names to extract. If <cite>None</cite>,
all col_names are retained.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the extract sub-matrix defined by <cite>row_names</cite> and/or <cite>col_names</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.find_rowcol_indices">
<em class="property">static </em><code class="sig-name descname">find_rowcol_indices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">names</span></em>, <em class="sig-param"><span class="n">row_names</span></em>, <em class="sig-param"><span class="n">col_names</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.find_rowcol_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>fast(er) look of row and colum names indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> ([<cite>str</cite>]) – list of names to look for in <cite>row_names</cite> and/or <cite>col_names</cite> names</p></li>
<li><p><strong>row_names</strong> ([<cite>str</cite>]) – list of row names</p></li>
<li><p><strong>col_names</strong> ([<cite>str</cite>]) – list of column names</p></li>
<li><p><strong>axis</strong> (<cite>int</cite>, optional) – axis to search along.  If None, search both.
Default is <cite>None</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of (integer) index locations.  If <cite>axis</cite> is
<cite>None</cite>, a 2 <cite>numpy.ndarrays</cite> of both row and column name indices is returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.from_ascii">
<em class="property">classmethod </em><code class="sig-name descname">from_ascii</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.from_ascii" title="Permalink to this definition">¶</a></dt>
<dd><p>load a PEST-compatible ASCII matrix/vector file into a
<cite>Matrix</cite> instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – name of the file to read</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>Matrix</cite> loaded from ASCII file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_ascii</span><span class="p">(</span><span class="s2">&quot;my.mat&quot;</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">pyemi</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_ascii</span><span class="p">(</span><span class="s2">&quot;my.cov&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.from_binary">
<em class="property">classmethod </em><code class="sig-name descname">from_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.from_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>class method load from PEST-compatible binary file into a
Matrix instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – filename to read</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>Matrix</cite> loaded from binary file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_binary</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">pyemi</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_binary</span><span class="p">(</span><span class="s2">&quot;large_cov.jcb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.from_dataframe">
<em class="property">classmethod </em><code class="sig-name descname">from_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>class method to create a new <cite>Matrix</cite> instance from a</dt><dd><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<cite>pandas.DataFrame</cite>) – dataframe</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>Matrix</cite> instance derived from <cite>df</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;my.csv&quot;</span><span class="p">)</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.from_fortranfile">
<em class="property">static </em><code class="sig-name descname">from_fortranfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.from_fortranfile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>a binary load method to accommodate one of the many</dt><dd><p>bizarre fortran binary writing formats</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – name of the binary matrix file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>numpy.ndarray</strong>: the numeric values in the file</p></li>
<li><p><strong>[‘str’]</strong>: list of row names</p></li>
<li><p><strong>[`str`]</strong>: list of col_names</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.from_names">
<em class="property">classmethod </em><code class="sig-name descname">from_names</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">row_names</span></em>, <em class="sig-param"><span class="n">col_names</span></em>, <em class="sig-param"><span class="n">isdiagonal</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">autoalign</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">random</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.from_names" title="Permalink to this definition">¶</a></dt>
<dd><p>class method to create a new Matrix instance from
row names and column names, filled with trash</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row_names</strong> (<em>[</em><em>'str'</em><em>]</em>) – row names for the new <cite>Matrix</cite></p></li>
<li><p><strong>col_names</strong> (<em>[</em><em>'str'</em><em>]</em>) – col_names for the new matrix</p></li>
<li><p><strong>isdiagonal</strong> (<cite>bool</cite>, optional) – flag for diagonal matrix. Default is False</p></li>
<li><p><strong>autoalign</strong> (<cite>bool</cite>, optional) – flag for autoaligning new matrix
during linear algebra calcs. Default is True</p></li>
<li><p><strong>random</strong> (<cite>bool</cite>) – flag for contents of the trash matrix.
If True, fill with random numbers, if False, fill with zeros
Default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the new Matrix instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.full_s">
<em class="property">property </em><code class="sig-name descname">full_s</code><a class="headerlink" href="#pyemu.Matrix.full_s" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the full singular value matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>full singular value matrix.  Shape is <cite>(max(Matrix.shape),max(Matrix.shape))</cite>
with zeros along the diagonal from <cite>min(Matrix.shape)</cite> to <cite>max(Matrix.shape)</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">row_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">col_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">drop</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.get" title="Permalink to this definition">¶</a></dt>
<dd><p>get a new <cite>Matrix</cite> instance ordered on row_names or col_names</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row_names</strong> (<em>[</em><em>'str'</em><em>]</em><em>, </em><em>optional</em>) – row_names for new Matrix.  If <cite>None</cite>,
all row_names are used.</p></li>
<li><p><strong>col_names</strong> (<em>[</em><em>'str'</em><em>]</em><em>, </em><em>optional</em>) – col_names for new Matrix. If <cite>None</cite>,
all col_names are used.</p></li>
<li><p><strong>drop</strong> (<cite>bool</cite>) – flag to remove row_names and/or col_names from this <cite>Matrix</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new <cite>Matrix</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.get_diagonal_vector">
<code class="sig-name descname">get_diagonal_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">col_name</span><span class="o">=</span><span class="default_value">'diag'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.get_diagonal_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a new Matrix instance that is the diagonal of self.  The
shape of the new matrix is (self.shape[0],1).  Self must be square</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>col_name</strong> (<cite>str</cite>) – the name of the single column in the new Matrix</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>vector-shaped <cite>Matrix</cite> instance of the diagonal of this <cite>Matrix</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.get_maxsing">
<code class="sig-name descname">get_maxsing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eigthresh</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.get_maxsing" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of singular components with a singular
value ratio greater than or equal to eigthresh</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eigthresh (<cite>float</cite>): the ratio of smallest to largest</dt><dd><p>singular value to retain.  Since it is assumed that
<cite>s</cite> is sorted from largest to smallest, once a singular value
is reached that yields a ratio with the first (largest)
singular value, the index of this singular is returned.</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the index of the singular value whos ratio with the
first singular value is less than or equal to <cite>eigthresh</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this method calls the static method <cite>Matrix.get_maxsing_from_s()</cite>
with <cite>Matrix.s.x</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.get_maxsing_from_s">
<em class="property">static </em><code class="sig-name descname">get_maxsing_from_s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">eigthresh</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.get_maxsing_from_s" title="Permalink to this definition">¶</a></dt>
<dd><p>static method to work out the maxsing for a
given singular spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<cite>numpy.ndarray</cite>) – 1-D array of singular values. This
array should come from calling either <cite>numpy.linalg.svd</cite>
or from the <cite>pyemu.Matrix.s.x</cite> attribute</p></li>
<li><p><strong>eigthresh</strong> (<cite>float</cite>) – the ratio of smallest to largest
singular value to retain.  Since it is assumed that
<cite>s</cite> is sorted from largest to smallest, once a singular value
is reached that yields a ratio with the first (largest)
singular value, the index of this singular is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the index of the singular value whos ratio with the
first singular value is less than or equal to <cite>eigthresh</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.hadamard_product">
<code class="sig-name descname">hadamard_product</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.hadamard_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Overload of numpy.ndarray.__mult__(): element-wise multiplication.
Tries to speedup by checking for scalars of diagonal matrices on
either side of operator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> – (<cite>int</cite>,`float`,`numpy.ndarray`,`Matrix`): the thing to multiply</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the result of multiplication</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if <cite>Matrix</cite> and other (if applicable) have <cite>autoalign</cite> set to <cite>True</cite>,
both <cite>Matrix</cite> and <cite>other</cite> are aligned based on row and column names.
If names are not common between the two, this may result in a smaller
returned <cite>Matrix</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.indices">
<code class="sig-name descname">indices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">names</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.indices" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the row and col indices of names. If axis is None, two ndarrays</dt><dd><p>are returned, corresponding the indices of names for each axis</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> ([<cite>str</cite>]) – list of names to look for in <cite>row_names</cite> and/or <cite>col_names</cite> names</p></li>
<li><p><strong>row_names</strong> ([<cite>str</cite>]) – list of row names</p></li>
<li><p><strong>col_names</strong> ([<cite>str</cite>]) – list of column names</p></li>
<li><p><strong>axis</strong> (<cite>int</cite>, optional) – axis to search along.  If None, search both.
Default is <cite>None</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of (integer) index locations.  If <cite>axis</cite> is
<cite>None</cite>, a 2 <cite>numpy.ndarrays</cite> of both row and column name indices is returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>thin wrapper around <cite>Matrix.find_rowcol_indices</cite> static method</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.integer">
<code class="sig-name descname">integer</code><a class="headerlink" href="#pyemu.Matrix.integer" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.int32</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.inv">
<em class="property">property </em><code class="sig-name descname">inv</code><a class="headerlink" href="#pyemu.Matrix.inv" title="Permalink to this definition">¶</a></dt>
<dd><p>inversion operation of <cite>Matrix</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>inverse of <cite>Matrix</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>uses <cite>numpy.linalg.inv</cite> for the inversion</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_binary</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">mat_inv</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">inv</span>
<span class="n">mat_inv</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s2">&quot;my_inv.jco&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.mult_isaligned">
<code class="sig-name descname">mult_isaligned</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.mult_isaligned" title="Permalink to this definition">¶</a></dt>
<dd><p>check if matrices are aligned for dot product multiplication</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<cite>Matrix</cite>) – the other matrix to check for alignment with</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if aligned, False if not aligned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.ncol">
<em class="property">property </em><code class="sig-name descname">ncol</code><a class="headerlink" href="#pyemu.Matrix.ncol" title="Permalink to this definition">¶</a></dt>
<dd><p>length of second dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of columns</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.new_obs_length">
<code class="sig-name descname">new_obs_length</code><em class="property"> = 200</em><a class="headerlink" href="#pyemu.Matrix.new_obs_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.new_par_length">
<code class="sig-name descname">new_par_length</code><em class="property"> = 200</em><a class="headerlink" href="#pyemu.Matrix.new_par_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.newx">
<em class="property">property </em><code class="sig-name descname">newx</code><a class="headerlink" href="#pyemu.Matrix.newx" title="Permalink to this definition">¶</a></dt>
<dd><p>return a copy of <cite>Matrix.x</cite> attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a copy <cite>Matrix.x</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.nrow">
<em class="property">property </em><code class="sig-name descname">nrow</code><a class="headerlink" href="#pyemu.Matrix.nrow" title="Permalink to this definition">¶</a></dt>
<dd><p>length of first dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of rows</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.obs_length">
<code class="sig-name descname">obs_length</code><em class="property"> = 20</em><a class="headerlink" href="#pyemu.Matrix.obs_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyemu.Matrix.par_length">
<code class="sig-name descname">par_length</code><em class="property"> = 12</em><a class="headerlink" href="#pyemu.Matrix.par_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.pseudo_inv">
<code class="sig-name descname">pseudo_inv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maxsing</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eigthresh</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.pseudo_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>The pseudo inverse of self.  Formed using truncated singular
value decomposition and <cite>Matrix.pseudo_inv_components</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxsing</strong> (<cite>int</cite>, optional) – the number of singular components to use.  If None,
<cite>maxsing</cite> is calculated using <cite>Matrix.get_maxsing()</cite> and <cite>eigthresh</cite></p></li>
<li><p><strong>eigthresh</strong> – (<cite>float</cite>, optional): the ratio of largest to smallest singular
components to use for truncation.  Ignored if maxsing is not None.  Default is
1.0e-5</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the truncated-SVD pseudo inverse of <cite>Matrix</cite> (V_1 * s_1^-1 * U^T)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.pseudo_inv_components">
<code class="sig-name descname">pseudo_inv_components</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maxsing</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eigthresh</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">truncate</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.pseudo_inv_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the (optionally) truncated SVD components</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxsing</strong> (<cite>int</cite>, optional) – the number of singular components to use.  If None,
<cite>maxsing</cite> is calculated using <cite>Matrix.get_maxsing()</cite> and <cite>eigthresh</cite></p></li>
<li><p><strong>eigthresh</strong> – (<cite>float</cite>, optional): the ratio of largest to smallest singular
components to use for truncation.  Ignored if maxsing is not None.  Default is
1.0e-5</p></li>
<li><p><strong>truncate</strong> (<cite>bool</cite>) – flag to truncate components. If False, U, s, and V will be
zeroed out at locations greater than <cite>maxsing</cite> instead of truncated. Default is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>Matrix</strong>: (optionally truncated) left singular vectors</p></li>
<li><p><strong>Matrix</strong>: (optionally truncated) singular value matrix</p></li>
<li><p><strong>Matrix</strong>: (optionally truncated) right singular vectors</p></li>
</ul>
</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_binary</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">u</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">pseudo_inv_components</span><span class="p">(</span><span class="n">maxsing</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">resolution_matrix</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span>
<span class="n">resolution_matrix</span><span class="o">.</span><span class="n">to_ascii</span><span class="p">(</span><span class="s2">&quot;resol.mat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.read_ascii">
<em class="property">static </em><code class="sig-name descname">read_ascii</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.read_ascii" title="Permalink to this definition">¶</a></dt>
<dd><p>read a PEST-compatible ASCII matrix/vector file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – file to read from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>numpy.ndarray</strong>: numeric values</p></li>
<li><p><strong>[‘str’]</strong>: list of row names</p></li>
<li><p><strong>[`str`]</strong>: list of column names</p></li>
<li><p><strong>bool</strong>: diagonal flag</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.read_binary">
<em class="property">static </em><code class="sig-name descname">read_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.read_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>static method to read PEST-format binary files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – filename to read</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>numpy.ndarray</strong>: the numeric values in the file</p></li>
<li><p><strong>[‘str’]</strong>: list of row names</p></li>
<li><p><strong>[`str`]</strong>: list of col_names</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.reset_x">
<code class="sig-name descname">reset_x</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.reset_x" title="Permalink to this definition">¶</a></dt>
<dd><p>reset self.__x private attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>numpy.ndarray</cite>) – the new numeric data</p></li>
<li><p><strong>copy</strong> (<cite>bool</cite>) – flag to make a copy of ‘x’. Defaule is True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.s">
<em class="property">property </em><code class="sig-name descname">s</code><a class="headerlink" href="#pyemu.Matrix.s" title="Permalink to this definition">¶</a></dt>
<dd><p>the singular value (diagonal) Matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>singular value matrix.  shape is <cite>(min(Matrix.shape),min(Matrix.shape))</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#pyemu.Matrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>get the implied, 2D shape of <cite>Matrix</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>length of 2 tuple</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.sqrt">
<em class="property">property </em><code class="sig-name descname">sqrt</code><a class="headerlink" href="#pyemu.Matrix.sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>element-wise square root operation</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>element-wise square root of <cite>Matrix</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>uses <cite>numpy.sqrt</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.to_2d">
<code class="sig-name descname">to_2d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.to_2d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get a 2D <cite>Matrix</cite> representation of <cite>Matrix</cite>.  If not <cite>Matrix.isdiagonal</cite>, simply</dt><dd><p>return a copy of <cite>Matrix</cite>, otherwise, constructs and returns a new <cite>Matrix</cite>
instance that is stored as diagonal</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>non-diagonal form of <cite>Matrix</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Martrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.to_ascii">
<code class="sig-name descname">to_ascii</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">icode</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.to_ascii" title="Permalink to this definition">¶</a></dt>
<dd><p>write a PEST-compatible ASCII Matrix/vector file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – filename to write to</p>
</dd>
</dl>
<dl class="simple">
<dt>icode (<cite>int</cite>, optional): PEST-style info code for matrix style.</dt><dd><p>Default is 2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.to_binary">
<code class="sig-name descname">to_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">droptol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunk</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.to_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>write a PEST-compatible binary file.  The format is the same
as the format used to storage a PEST Jacobian matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – filename to save binary file</p></li>
<li><p><strong>droptol</strong> (<cite>float</cite>) – absolute value tolerance to make values
smaller <cite>droptol</cite> than zero.  Default is None (no dropping)</p></li>
<li><p><strong>chunk</strong> (<cite>int</cite>) – number of elements to write in a single pass.
Default is <cite>None</cite>, which writes the entire numeric part of the
<cite>Matrix</cite> at once. This is faster but requires more memory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.to_coo">
<code class="sig-name descname">to_coo</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">droptol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunk</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.to_coo" title="Permalink to this definition">¶</a></dt>
<dd><p>write an extended PEST-format binary file.  The data format is
[int,int,float] for i,j,value.  It is autodetected during
the read with <cite>Matrix.from_binary()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – filename to save binary file</p></li>
<li><p><strong>droptol</strong> (<cite>float</cite>) – absolute value tolerance to make values
smaller <cite>droptol</cite> than zero.  Default is None (no dropping)</p></li>
<li><p><strong>chunk</strong> (<cite>int</cite>) – number of elements to write in a single pass.
Default is <cite>None</cite>, which writes the entire numeric part of the
<cite>Matrix</cite> at once. This is faster but requires more memory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.to_dataframe">
<code class="sig-name descname">to_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Matrix.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>return a pandas.DataFrame representation of <cite>Matrix</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe derived from <cite>Matrix</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.transpose">
<em class="property">property </em><code class="sig-name descname">transpose</code><a class="headerlink" href="#pyemu.Matrix.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>transpose operation of self</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>transpose of <cite>Matrix</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.u">
<em class="property">property </em><code class="sig-name descname">u</code><a class="headerlink" href="#pyemu.Matrix.u" title="Permalink to this definition">¶</a></dt>
<dd><p>the left singular vector Matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>left singular vectors.  Shape is <cite>(Matrix.shape[0], Matrix.shape[0])</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.v">
<em class="property">property </em><code class="sig-name descname">v</code><a class="headerlink" href="#pyemu.Matrix.v" title="Permalink to this definition">¶</a></dt>
<dd><p>the right singular vector Matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>right singular vectors.  Shape is <cite>(Matrix.shape[1], Matrix.shape[1])</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.x">
<em class="property">property </em><code class="sig-name descname">x</code><a class="headerlink" href="#pyemu.Matrix.x" title="Permalink to this definition">¶</a></dt>
<dd><p>return a reference to <cite>Matrix.x</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>reference to <cite>Matrix.x</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Matrix.zero2d">
<em class="property">property </em><code class="sig-name descname">zero2d</code><a class="headerlink" href="#pyemu.Matrix.zero2d" title="Permalink to this definition">¶</a></dt>
<dd><p>get an 2D instance of self with all zeros</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>Matrix of zeros</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Matrix</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.ObservationEnsemble">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">ObservationEnsemble</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">istransformed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ObservationEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.en.Ensemble</span></code></a></p>
<p>Observation noise ensemble in the PEST(++) realm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>df</strong> (<cite>pandas.DataFrame</cite>) – a pandas dataframe.  Columns
should be observation names.  Index is
treated as realization names</p></li>
<li><p><strong>istransformed</strong> (<cite>bool</cite>) – flag to indicate parameter values
are in log space.  Not used for <cite>ObservationEnsemble</cite></p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">oe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.ObservationEnsemble.add_base">
<code class="sig-name descname">add_base</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ObservationEnsemble.add_base" title="Permalink to this definition">¶</a></dt>
<dd><p>add the control file <cite>obsval</cite> values as a realization</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>replaces the last realization with the current <cite>ObservationEnsemble.pst.observation_data.obsval</cite> values</dt><dd><p>as a new realization named “base”</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ObservationEnsemble.from_gaussian_draw">
<em class="property">classmethod </em><code class="sig-name descname">from_gaussian_draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">by_groups</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">factor</span><span class="o">=</span><span class="default_value">'eigen'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ObservationEnsemble.from_gaussian_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>generate an <cite>ObservationEnsemble</cite> from a (multivariate) gaussian
distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance.</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – a covariance matrix describing the second
moment of the gaussian distribution.  If None, <cite>cov</cite> is
generated from the non-zero-weighted observation weights in <cite>pst</cite>.
Only observations listed in <cite>cov</cite> are sampled.  Other observations are
assigned the <cite>obsval</cite> value from <cite>pst</cite>.</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of stochastic realizations to generate.  Default
is 100</p></li>
<li><p><strong>by_groups</strong> (<cite>bool</cite>) – flag to generate realzations be observation group.  This
assumes no correlation (covariates) between observation groups.</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in zero-weighted observations with control file
values.  Default is False.</p></li>
<li><p><strong>factor</strong> (<cite>str</cite>) – how to factorize <cite>cov</cite> to form the projectin matrix.  Can
be “eigen” or “svd”. The “eigen” option is default and is faster.  But
for (nearly) singular cov matrices (such as those generated empirically
from ensembles), “svd” is the only way.  Ignored for diagonal <cite>cov</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the realized <cite>ObservationEnsemble</cite> instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ObservationEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only observations named in <cite>cov</cite> are sampled. Additional, <cite>cov</cite> is processed prior
to sampling to only include non-zero-weighted observations depending on the value of <cite>fill</cite>.
So users must take care to make sure observations have been assigned non-zero weights even if <cite>cov</cite>
is being passed</p>
<p>The default <cite>cov</cite> is generated from <cite>pyemu.Cov.from_observation_data</cite>, which assumes
observation noise standard deviations are the inverse of the weights listed in <cite>pst</cite></p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="c1"># the easiest way - just relying on weights in pst</span>
<span class="n">oe1</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>

<span class="c1"># generate the cov explicitly</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_observation_data</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">oe2</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">cov</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>

<span class="c1"># give all but one observation zero weight.  This will</span>
<span class="c1"># result in an oe with only one randomly sampled observation noise</span>
<span class="c1"># vector since the cov is processed to remove any zero-weighted</span>
<span class="c1"># observations before sampling</span>
<span class="n">pst</span><span class="o">.</span><span class="n">observation_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pst</span><span class="o">.</span><span class="n">nnz_obs_names</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="s2">&quot;weight] = 0.0</span>
<span class="n">oe3</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ObservationEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">cov</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ObservationEnsemble.nonzero">
<em class="property">property </em><code class="sig-name descname">nonzero</code><a class="headerlink" href="#pyemu.ObservationEnsemble.nonzero" title="Permalink to this definition">¶</a></dt>
<dd><p>get a new <cite>ObservationEnsemble</cite> of just non-zero weighted observations</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>non-zero weighted observation ensemble.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>ObservationEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>pst</cite> attribute of the returned <cite>ObservationEnsemble</cite> also only includes
non-zero weighted observations (and is therefore not valid for running
with PEST or PEST++)</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ObservationEnsemble.phi_vector">
<em class="property">property </em><code class="sig-name descname">phi_vector</code><a class="headerlink" href="#pyemu.ObservationEnsemble.phi_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>vector of L2 norm (phi) for the realizations (rows) of <cite>Ensemble</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>series of realization name (<cite>Ensemble.index</cite>) and phi values</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ObservationEnsemble.pst.weights can be updated prior to calling
this method to evaluate new weighting strategies</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.ParameterEnsemble">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">ParameterEnsemble</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">istransformed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.en.Ensemble" title="pyemu.en.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.en.Ensemble</span></code></a></p>
<p>Parameter ensembles in the PEST(++) realm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>df</strong> (<cite>pandas.DataFrame</cite>) – a pandas dataframe.  Columns
should be parameter names.  Index is
treated as realization names</p></li>
<li><p><strong>istransformed</strong> (<cite>bool</cite>) – flag to indicate parameter values
are in log space (if <cite>partrans</cite> is “log” in <cite>pst</cite>)</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.ParameterEnsemble.add_base">
<code class="sig-name descname">add_base</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.add_base" title="Permalink to this definition">¶</a></dt>
<dd><p>add the control file <cite>obsval</cite> values as a realization</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>replaces the last realization with the current <cite>ParameterEnsemble.pst.parameter_data.parval1</cite> values
as a new realization named “base”</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.adj_names">
<em class="property">property </em><code class="sig-name descname">adj_names</code><a class="headerlink" href="#pyemu.ParameterEnsemble.adj_names" title="Permalink to this definition">¶</a></dt>
<dd><p>the names of adjustable parameters in <cite>ParameterEnsemble</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>adjustable parameter names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.back_transform">
<code class="sig-name descname">back_transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.back_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>back transform parameters with respect to <cite>partrans</cite> value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place (None is returned).</p>
<p>Parameter transform is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.enforce">
<code class="sig-name descname">enforce</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">how</span><span class="o">=</span><span class="default_value">'reset'</span></em>, <em class="sig-param"><span class="n">bound_tol</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.enforce" title="Permalink to this definition">¶</a></dt>
<dd><p>entry point for bounds enforcement.  This gets called for the
draw method(s), so users shouldn’t need to call this</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>enforce_bounds</strong> (<cite>str</cite>) – can be ‘reset’ to reset offending values or ‘drop’ to drop
offending realizations</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">()</span>
<span class="n">pe</span><span class="o">.</span><span class="n">enforce</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;scale)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;par.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.fixed_indexer">
<em class="property">property </em><code class="sig-name descname">fixed_indexer</code><a class="headerlink" href="#pyemu.ParameterEnsemble.fixed_indexer" title="Permalink to this definition">¶</a></dt>
<dd><p>boolean indexer for non-adjustable parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>boolean array indicating which parameters have
<cite>partrans</cite> equal to “log” or “fixed”</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>numpy.ndarray(bool)</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.from_gaussian_draw">
<em class="property">classmethod </em><code class="sig-name descname">from_gaussian_draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">by_groups</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">factor</span><span class="o">=</span><span class="default_value">'eigen'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.from_gaussian_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a <cite>ParameterEnsemble</cite> from a (multivariate) (log) gaussian
distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance.</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – a covariance matrix describing the second
moment of the gaussian distribution.  If None, <cite>cov</cite> is
generated from the bounds of the adjustable parameters in <cite>pst</cite>.
the (log) width of the bounds is assumed to represent a multiple of
the parameter standard deviation (this is the <cite>sigma_range</cite> argument
that can be passed to <cite>pyemu.Cov.from_parameter_data</cite>).</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of stochastic realizations to generate.  Default
is 100</p></li>
<li><p><strong>by_groups</strong> (<cite>bool</cite>) – flag to generate realzations be parameter group.  This
assumes no correlation (covariates) between parameter groups.  For large
numbers of parameters, this help prevent memories but is slower.</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in fixed and/or tied parameters with control file
values.  Default is True.</p></li>
<li><p><strong>factor</strong> (<cite>str</cite>) – how to factorize <cite>cov</cite> to form the projectin matrix.  Can
be “eigen” or “svd”. The “eigen” option is default and is faster.  But
for (nearly) singular cov matrices (such as those generated empirically
from ensembles), “svd” is the only way.  Ignored for diagonal <cite>cov</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the parameter ensemble realized from the gaussian
distribution</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only parameters named in <cite>cov</cite> are sampled. Missing parameters are assigned values of
<cite>pst.parameter_data.parval1</cite> along the corresponding columns of <cite>ParameterEnsemble</cite>
according to the value of <cite>fill</cite>.</p>
<p>The default <cite>cov</cite> is generated from <cite>pyemu.Cov.from_observation_data</cite>, which assumes
parameter bounds in <cite>ParameterEnsemble.pst</cite> represent some multiple of parameter
standard deviations.  Additionally, the default Cov only includes adjustable
parameters (<cite>partrans</cite> not “tied” or “fixed”).</p>
<p>“tied” parameters are not sampled.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="c1"># the easiest way - just relying on weights in pst</span>
<span class="n">oe1</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>

<span class="c1"># generate the cov explicitly with a sigma_range</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_parameter_data</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">sigma_range</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">oe2</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">cov</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.from_mixed_draws">
<em class="property">classmethod </em><code class="sig-name descname">from_mixed_draws</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">how_dict</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">'gaussian'</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">enforce_bounds</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">partial</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.from_mixed_draws" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a <cite>ParameterEnsemble</cite> using a mixture of
distributions.  Available distributions include (log) “uniform”, (log) “triangular”,
and (log) “gaussian”. log transformation is respected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file</p></li>
<li><p><strong>how_dict</strong> (<cite>dict</cite>) – a dictionary of parameter name keys and
“how” values, where “how” can be “uniform”,”triangular”, or “gaussian”.</p></li>
<li><p><strong>default</strong> (<cite>str</cite>) – the default distribution to use for parameter not listed
in how_dict.  Default is “gaussian”.</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of realizations to draw.  Default is 100.</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – an optional Cov instance to use for drawing from gaussian distribution.
If None, and “gaussian” is listed in <cite>how_dict</cite> (and/or <cite>default</cite>), then a diagonal
covariance matrix is constructed from the parameter bounds in <cite>pst</cite> (with <cite>sigma_range</cite>).
Default is None.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – the number of standard deviations implied by the parameter bounds in the pst.
Only used if “gaussian” is in <cite>how_dict</cite> (and/or <cite>default</cite>) and <cite>cov</cite> is None.  Default is 6.</p></li>
<li><p><strong>enforce_bounds</strong> (<cite>bool</cite>) – flag to enforce parameter bounds in resulting <cite>ParameterEnsemble</cite>. Only
matters if “gaussian” is in values of <cite>how_dict</cite>.  Default is True.</p></li>
<li><p><strong>partial</strong> (<cite>bool</cite>) – flag to allow a partial ensemble (not all pars included).  If True, parameters
not name in <cite>how_dict</cite> will be sampled using the distribution named as <cite>default</cite>.
Default is <cite>False</cite>.</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in fixed and/or tied parameters with control file
values.  Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.from_parfiles">
<em class="property">classmethod </em><code class="sig-name descname">from_parfiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">parfile_names</span></em>, <em class="sig-param"><span class="n">real_names</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.from_parfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>create a parameter ensemble from PEST-style parameter value files.
Accepts parfiles with less than the parameters in the control
(get NaNs in the ensemble) or extra parameters in the
parfiles (get dropped)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – control file instance</p></li>
<li><p><strong>parfile_names</strong> (<cite>[str</cite>]) – par file names</p></li>
<li><p><strong>real_names</strong> (<cite>str</cite>) – optional list of realization names.
If None, a single integer counter is used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameter ensemble loaded from par files</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.from_triangular_draw">
<em class="property">classmethod </em><code class="sig-name descname">from_triangular_draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.from_triangular_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a <cite>ParameterEnsemble</cite> from a (multivariate) (log) triangular distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>, optional) – number of realizations to generate.  Default is 100</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in fixed and/or tied parameters with control file
values.  Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a parameter ensemble drawn from the multivariate (log) triangular
distribution defined by the parameter upper and lower bounds and initial parameter
values in <cite>pst</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>respects transformation status in <cite>pst</cite>: fixed and tied parameters are not realized,
log-transformed parameters are drawn in log space.  The returned <cite>ParameterEnsemble</cite>
is back transformed (not in log space)</p>
<p>uses numpy.random.triangular</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_triangular_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;my_tri_pe.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.from_uniform_draw">
<em class="property">classmethod </em><code class="sig-name descname">from_uniform_draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">num_reals</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.from_uniform_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a <cite>ParameterEnsemble</cite> from a (multivariate) (log) uniform
distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>, optional) – number of realizations to generate.  Default is 100</p></li>
<li><p><strong>fill</strong> (<cite>bool</cite>) – flag to fill in fixed and/or tied parameters with control file
values.  Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a parameter ensemble drawn from the multivariate (log) uniform
distribution defined by the parameter upper and lower bounds <cite>pst</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>respects transformation status in <cite>pst</cite>: fixed and tied parameters are not realized,
log-transformed parameters are drawn in log space.  The returned <cite>ParameterEnsemble</cite>
is back transformed (not in log space)</p>
<p>uses numpy.random.uniform</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_uniform_draw</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;my_uni_pe.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.lbnd">
<em class="property">property </em><code class="sig-name descname">lbnd</code><a class="headerlink" href="#pyemu.ParameterEnsemble.lbnd" title="Permalink to this definition">¶</a></dt>
<dd><p>the lower bound vector while respecting current log transform status</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(log-transformed) lower parameter bounds listed in
<cite>ParameterEnsemble.pst.parameter_data.parlbnd</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.log_indexer">
<em class="property">property </em><code class="sig-name descname">log_indexer</code><a class="headerlink" href="#pyemu.ParameterEnsemble.log_indexer" title="Permalink to this definition">¶</a></dt>
<dd><p>boolean indexer for log transform</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>boolean array indicating which parameters are log
transformed</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>numpy.ndarray(bool)</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.project">
<code class="sig-name descname">project</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">projection_matrix</span></em>, <em class="sig-param"><span class="n">center_on</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">enforce_bounds</span><span class="o">=</span><span class="default_value">'reset'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.project" title="Permalink to this definition">¶</a></dt>
<dd><p>project the ensemble using the null-space Monte Carlo method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projection_matrix</strong> (<cite>pyemu.Matrix</cite>) – null-space projection operator.</p></li>
<li><p><strong>center_on</strong> (<cite>str</cite>) – the name of the realization to use as the centering
point for the null-space differening operation.  If <cite>center_on</cite> is <cite>None</cite>,
the <cite>ParameterEnsemble</cite> mean vector is used.  Default is <cite>None</cite></p></li>
<li><p><strong>log</strong> (<cite>pyemu.Logger</cite>, optional) – for logging progress</p></li>
<li><p><strong>enforce_bounds</strong> (<cite>str</cite>) – parameter bound enforcement option to pass to
<cite>ParameterEnsemble.enforce()</cite>.  Valid options are <cite>reset</cite>, <cite>drop</cite>,
<cite>scale</cite> or <cite>None</cite>.  Default is <cite>reset</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>untransformed, null-space projected ensemble.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>ParameterEnsemble</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ev</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ErrVar</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span> <span class="c1">#assumes my.pst exists</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">ParameterEnsemble</span><span class="o">.</span><span class="n">from_gaussian_draw</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pe_proj</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">get_null_proj</span><span class="p">(</span><span class="n">maxsing</span><span class="o">=</span><span class="mi">25</span><span class="p">))</span>
<span class="n">pe_proj</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;proj_par.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.ParameterEnsemble.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transform parameters with respect to <cite>partrans</cite> value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates in place (None is returned).</p>
<p>Parameter transform is only related to log_{10} and does not
include the effects of <cite>scale</cite> and/or <cite>offset</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.ParameterEnsemble.ubnd">
<em class="property">property </em><code class="sig-name descname">ubnd</code><a class="headerlink" href="#pyemu.ParameterEnsemble.ubnd" title="Permalink to this definition">¶</a></dt>
<dd><p>the upper bound vector while respecting current log transform status</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(log-transformed) upper parameter bounds listed in
<cite>ParameterEnsemble.pst.parameter_data.parubnd</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.Pst">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">Pst</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">load</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">resfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>All things PEST(++) control file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – the name of the control file</p></li>
<li><p><strong>load</strong> (<cite>bool</cite>, optional) – flag to load the control file. Default is True</p></li>
<li><p><strong>resfile</strong> (<cite>str</cite>, optional) – corresponding residual file.  If <cite>None</cite>, a residual file
with the control file base name is sought.  Default is <cite>None</cite></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is the primary mechanism for dealing with PEST control files.  Support is provided
for constructing new control files as well as manipulating existing control files.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">control_data</span><span class="o">.</span><span class="n">noptmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;my_new.pst&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.Pst.add_observations">
<code class="sig-name descname">add_observations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ins_file</span></em>, <em class="sig-param"><span class="n">out_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pst_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inschek</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.add_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>add new observations to a control file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ins_file</strong> (<cite>str</cite>) – instruction file with exclusively new observation names</p></li>
<li><p><strong>out_file</strong> (<cite>str</cite>) – model output file.  If None, then ins_file.replace(“.ins”,””) is used.
Default is None</p></li>
<li><p><strong>pst_path</strong> (<cite>str</cite>) – the path to append to the instruction file and out file in the control file.  If
not None, then any existing path in front of the template or in file is split off
and pst_path is prepended.  If python is being run in a directory other than where the control
file will reside, it is useful to pass <cite>pst_path</cite> as <cite>.</cite>. Default is None</p></li>
<li><p><strong>inschek</strong> (<cite>bool</cite>) – flag to try to process the existing output file using the <cite>pyemu.InstructionFile</cite>
class.  If successful, processed outputs are used as obsvals</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the data for the new observations that were added</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>populates the new observation information with default values</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="s2">&quot;my.pst&quot;</span><span class="p">))</span>
<span class="n">pst</span><span class="o">.</span><span class="n">add_observations</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span><span class="s2">&quot;new_obs.dat.ins&quot;</span><span class="p">),</span> <span class="n">pst_path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="s2">&quot;my_new.pst&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.add_parameters">
<code class="sig-name descname">add_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">template_file</span></em>, <em class="sig-param"><span class="n">in_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pst_path</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.add_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>add new parameters to an existing control file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>template_file</strong> (<cite>str</cite>) – template file with (possibly) some new parameters</p></li>
<li><p><strong>in_file</strong> (<cite>str</cite>) – model input file. If None, template_file.replace(‘.tpl’,’’) is used.
Default is None.</p></li>
<li><p><strong>pst_path</strong> (<cite>str</cite>) – the path to append to the template_file and in_file in the control file.  If
not None, then any existing path in front of the template or in file is split off
and pst_path is prepended.  If python is being run in a directory other than where the control
file will reside, it is useful to pass <cite>pst_path</cite> as <cite>.</cite>.  Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the data for the new parameters that were added.
If no new parameters are in the new template file, returns None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>populates the new parameter information with default values</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span><span class="s2">&quot;my.pst&quot;</span><span class="p">))</span>
<span class="n">pst</span><span class="o">.</span><span class="n">add_parameters</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span><span class="s2">&quot;new_pars.dat.tpl&quot;</span><span class="p">,</span><span class="n">pst_path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span><span class="s2">&quot;my_new.pst&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.add_pi_equation">
<code class="sig-name descname">add_pi_equation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_names</span></em>, <em class="sig-param"><span class="n">pilbl</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rhs</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">weight</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">obs_group</span><span class="o">=</span><span class="default_value">'pi_obgnme'</span></em>, <em class="sig-param"><span class="n">coef_dict</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.add_pi_equation" title="Permalink to this definition">¶</a></dt>
<dd><p>a helper to construct a new prior information equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par_names</strong> ([<cite>str</cite>]) – parameter names in the equation</p></li>
<li><p><strong>pilbl</strong> (<cite>str</cite>) – name to assign the prior information equation.  If None,
a generic equation name is formed. Default is None</p></li>
<li><p><strong>rhs</strong> (<cite>float</cite>) – the right-hand side of the pi equation</p></li>
<li><p><strong>weight</strong> (<cite>float</cite>) – the weight of the equation</p></li>
<li><p><strong>obs_group</strong> (<cite>str</cite>) – the observation group for the equation. Default is ‘pi_obgnme’</p></li>
<li><p><strong>coef_dict</strong> (<cite>dict</cite>) – a dictionary of parameter name, coefficient pairs to assign
leading coefficients for one or more parameters in the equation.
If a parameter is not listed, 1.0 is used for its coefficients.
Default is {}</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.add_transform_columns">
<code class="sig-name descname">add_transform_columns</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.add_transform_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>add transformed values to the <cite>Pst.parameter_data</cite> attribute</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>adds <cite>parval1_trans</cite>, <cite>parlbnd_trans</cite> and <cite>parubnd_trans</cite> to
<cite>Pst.parameter_data</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.adj_par_groups">
<em class="property">property </em><code class="sig-name descname">adj_par_groups</code><a class="headerlink" href="#pyemu.Pst.adj_par_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>get the parameter groups with atleast one adjustable parameter</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of parameter groups with
at least one adjustable parameter</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.adj_par_names">
<em class="property">property </em><code class="sig-name descname">adj_par_names</code><a class="headerlink" href="#pyemu.Pst.adj_par_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the adjustable (not fixed or tied) parameter names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of adjustable (not fixed or tied)
parameter names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.adjust_weights">
<code class="sig-name descname">adjust_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">obsgrp_dict</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.adjust_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the weights of observations or observation groups to contribute a specified
amount to the composite objective function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_dict</strong> (<cite>dict</cite>, optional) – dictionary of observation name,new contribution pairs</p></li>
<li><p><strong>obsgrp_dict</strong> (<cite>dict</cite>, optional) – dictionary of obs group name,contribution pairs</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if all observations in a named obs group have zero weight, they will all be
assigned a non-zero weight so that the request phi contribution
can be met.  Similarly, any observations listed in obs_dict with zero
weight will also be reset. User beware!</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>

<span class="c1"># adjust a single observation</span>
<span class="n">pst</span><span class="o">.</span><span class="n">adjust_weights</span><span class="p">(</span><span class="n">obs_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;obs1&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>

<span class="c1"># adjust a single observation group</span>
<span class="n">pst</span><span class="o">.</span><span class="n">adjust_weights</span><span class="p">(</span><span class="n">obsgrp_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;group1&quot;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">})</span>

<span class="c1"># make all non-zero weighted groups have a contribution of 100.0</span>
<span class="n">balanced_groups</span> <span class="o">=</span> <span class="p">{</span><span class="n">grp</span><span class="p">:</span><span class="mi">100</span> <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">pst</span><span class="o">.</span><span class="n">nnz_obs_groups</span><span class="p">}</span>
<span class="n">pst</span><span class="o">.</span><span class="n">adjust_weights</span><span class="p">(</span><span class="n">obsgrp_dict</span><span class="o">=</span><span class="n">balanced_groups</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.adjust_weights_discrepancy">
<code class="sig-name descname">adjust_weights_discrepancy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">resfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">original_ceiling</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">bygroups</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.adjust_weights_discrepancy" title="Permalink to this definition">¶</a></dt>
<dd><p>adjusts the weights of each non-zero weight observation based
on the residual in the pest residual file so each observations contribution
to phi is 1.0 (e.g. Mozorov’s discrepancy principal)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resfile</strong> (<cite>str</cite>) – residual file name.  If None, try to use a residual file
with the Pst case name.  Default is None</p></li>
<li><p><strong>original_ceiling</strong> (<cite>bool</cite>) – flag to keep weights from increasing - this is
generally a good idea. Default is True</p></li>
<li><p><strong>bygroups</strong> (<cite>bool</cite>) – flag to adjust weights by groups. If False, the weight
of each non-zero weighted observation is adjusted individually. If True,
intergroup weighting is preserved (the contribution to each group is used)
but this may result in some strangeness if some observations in a group have
a really low phi already.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pst</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span> <span class="c1">#assumes &quot;my.res&quot; is colocated with &quot;my.pst&quot;</span>
<span class="n">pst</span><span class="o">.</span><span class="n">adjust_weights_discrepancy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pst</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span> <span class="c1"># phi should equal number of non-zero observations</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.bounds_report">
<code class="sig-name descname">bounds_report</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iterations</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.bounds_report" title="Permalink to this definition">¶</a></dt>
<dd><p>report how many parameters are at bounds. If ensemble, the base enbsemble member is evaluated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iterations</strong> ([<cite>int</cite>]) – a list of iterations for which a bounds report is requested
If None, all iterations for which <cite>par</cite> files are located are reported. Default
is None</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>a pandas DataFrame object with rows being parameter groups and columns</dt><dd><p>&lt;iter&gt;_num_at_ub, &lt;iter&gt;_num_at_lb, and &lt;iter&gt;_total_at_bounds
row 0 is total at bounds, subsequent rows correspond with groups</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>df</cite></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>pst = pyemu.Pst(“my.pst”)
df = pst.bound_report(iterations=[0,2,3])</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.build_increments">
<code class="sig-name descname">build_increments</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.build_increments" title="Permalink to this definition">¶</a></dt>
<dd><p>experimental method to calculate parameter increments for use
in the finite difference pertubation calculations</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>user beware!</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.calculate_pertubations">
<code class="sig-name descname">calculate_pertubations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.calculate_pertubations" title="Permalink to this definition">¶</a></dt>
<dd><p>experimental method to calculate finite difference parameter
pertubations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pertubation values are added to the
<cite>Pst.parameter_data</cite> attribute - user beware!</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Pst.control_data">
<code class="sig-name descname">control_data</code><a class="headerlink" href="#pyemu.Pst.control_data" title="Permalink to this definition">¶</a></dt>
<dd><p>‘* control data’ information.
Access with standard PEST variable names</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span><span class="o">.</span><span class="n">control_data</span><span class="o">.</span><span class="n">noptmax</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">pst</span><span class="o">.</span><span class="n">control_data</span><span class="o">.</span><span class="n">pestmode</span> <span class="o">=</span> <span class="s2">&quot;estimation&quot;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.ControlData" title="pyemu.pst.pst_controldata.ControlData">pyemu.pst.pst_controldata.ControlData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.enforce_bounds">
<code class="sig-name descname">enforce_bounds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.enforce_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>enforce bounds violation</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>cheap enforcement of simply bringing violators back in bounds</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.estimation">
<em class="property">property </em><code class="sig-name descname">estimation</code><a class="headerlink" href="#pyemu.Pst.estimation" title="Permalink to this definition">¶</a></dt>
<dd><p>check if the control_data.pestmode is set to estimation</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if <cite>control_data.pestmode</cite> is estmation, False otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.forecast_names">
<em class="property">property </em><code class="sig-name descname">forecast_names</code><a class="headerlink" href="#pyemu.Pst.forecast_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the forecast names from the pestpp options (if any).
Returns None if no forecasts are named</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of forecast names.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.from_io_files">
<em class="property">classmethod </em><code class="sig-name descname">from_io_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tpl_files</span></em>, <em class="sig-param"><span class="n">in_files</span></em>, <em class="sig-param"><span class="n">ins_files</span></em>, <em class="sig-param"><span class="n">out_files</span></em>, <em class="sig-param"><span class="n">pst_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pst_path</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.from_io_files" title="Permalink to this definition">¶</a></dt>
<dd><p>create a Pst instance from model interface files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tpl_files</strong> ([<cite>str</cite>]) – list of template file names</p></li>
<li><p><strong>in_files</strong> ([<cite>str</cite>]) – list of model input file names (pairs with template files)</p></li>
<li><p><strong>ins_files</strong> ([<cite>str</cite>]) – list of instruction file names</p></li>
<li><p><strong>out_files</strong> ([<cite>str</cite>]) – list of model output file names (pairs with instruction files)</p></li>
<li><p><strong>pst_filename</strong> (<cite>str</cite>) – name of control file to write.  If None, no file is written.
Default is None</p></li>
<li><p><strong>pst_path</strong> (<em>'str'</em>) – the path from the control file to the IO files.  For example, if the
control will be in the same directory as the IO files, then <cite>pst_path</cite> should be ‘.’.
Default is None, which doesnt do any path manipulation on the I/O file names</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new control file instance with parameter and observation names
found in <cite>tpl_files</cite> and <cite>ins_files</cite>, repsectively.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Pst</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>calls <cite>pyemu.helpers.pst_from_io_files()</cite></p>
<p>Assigns generic values for parameter info.  Tries to use INSCHEK
to set somewhat meaningful observation values</p>
<p>all file paths are relatively to where python is running.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tpl_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my.tpl&quot;</span><span class="p">]</span>
<span class="n">in_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my.in&quot;</span><span class="p">]</span>
<span class="n">ins_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my.ins&quot;</span><span class="p">]</span>
<span class="n">out_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my.out&quot;</span><span class="p">]</span>
<span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="o">.</span><span class="n">from_io_files</span><span class="p">(</span><span class="n">tpl_files</span><span class="p">,</span><span class="n">in_files</span><span class="p">,</span><span class="n">ins_files</span><span class="p">,</span><span class="n">out_files</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">control_data</span><span class="o">.</span><span class="n">noptmax</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;my.pst)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.from_par_obs_names">
<em class="property">classmethod </em><code class="sig-name descname">from_par_obs_names</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_names</span><span class="o">=</span><span class="default_value">['par1']</span></em>, <em class="sig-param"><span class="n">obs_names</span><span class="o">=</span><span class="default_value">['obs1']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.from_par_obs_names" title="Permalink to this definition">¶</a></dt>
<dd><p>construct a shell <cite>Pst</cite> instance from parameter and observation names</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par_names</strong> ([<cite>str</cite>]) – list of parameter names.  Default is [<cite>par1</cite>]</p></li>
<li><p><strong>obs_names</strong> ([<cite>str</cite>]) – list of observation names.  Default is [<cite>obs1</cite>]</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While this method works, it does not make template or instruction files.
Users are encouraged to use <cite>Pst.from_io_files()</cite> for more usefulness</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;par1&quot;</span><span class="p">,</span><span class="s2">&quot;par2&quot;</span><span class="p">]</span>
<span class="n">obs_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;obs1&quot;</span><span class="p">,</span><span class="s2">&quot;obs2&quot;</span><span class="p">]</span>
<span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="o">.</span><span class="n">from_par_obs_names</span><span class="p">(</span><span class="n">par_names</span><span class="p">,</span><span class="n">obs_names</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">obs_names</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.get" title="Permalink to this definition">¶</a></dt>
<dd><p>get a new pst object with subset of parameters and/or observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par_names</strong> ([<cite>str</cite>]) – a list of parameter names to have in the new Pst instance.
If None, all parameters are in the new Pst instance. Default
is None</p></li>
<li><p><strong>obs_names</strong> ([<cite>str</cite>]) – a list of observation names to have in the new Pst instance.
If None, all observations are in teh new Pst instance. Default
is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Pst instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Pst</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>passing <cite>par_names</cite> as <cite>None</cite> and <cite>obs_names</cite> as <cite>None</cite> effectively
generates a copy of the current <cite>Pst</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.get_adj_pars_at_bounds">
<code class="sig-name descname">get_adj_pars_at_bounds</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frac_tol</span><span class="o">=</span><span class="default_value">0.01</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.get_adj_pars_at_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>get list of adjustable parameter at/near bounds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frac_tol</strong> (<em>'float`</em>) – fractional tolerance of distance to bound.  For upper bound,
the value <cite>parubnd * (1-frac_tol)</cite> is used, lower bound uses <cite>parlbnd * (1.0 + frac_tol)</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>[`str`]</strong>: list of parameters at/near lower bound</p></li>
<li><p><strong>[`str`]</strong>: list of parameters at/near upper bound</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.get_par_change_limits">
<code class="sig-name descname">get_par_change_limits</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.get_par_change_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the various parameter change limits used in pest.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a copy of <cite>Pst.parameter_data</cite>
with columns for relative and factor change limits</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>does not yet support absolute parameter change limits!</p>
<p>Works in control file values space (not log transformed space).  Also
adds columns for effective upper and lower which account for par bounds and the
value of parchglim</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.get_res_stats">
<code class="sig-name descname">get_res_stats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nonzero</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.get_res_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>get some common residual stats by observation group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nonzero</strong> (<cite>bool</cite>) – calculate stats using only nonzero-weighted observations.  This may seem
obsvious to most users, but you never know….</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with columns for groups names and indices of statistic name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pd.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stats are derived from the current obsvals, weights and grouping in
<cite>Pst.observation_data</cite> and the <cite>modelled</cite> values in <cite>Pst.res</cite>.  The
key here is ‘current’ because if obsval, weights and/or groupings have
changed in <cite>Pst.observation_data</cite> since the residuals file was generated
then the current values for <cite>obsval</cite>, <cite>weight</cite> and <cite>group</cite> are used</p>
<p>the normalized RMSE is normalized against the obsval range (max - min)</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.greater_than_obs_constraints">
<em class="property">property </em><code class="sig-name descname">greater_than_obs_constraints</code><a class="headerlink" href="#pyemu.Pst.greater_than_obs_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>get the names of the observations that
are listed as active greater than inequality constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>names obseravtions that are non-zero weighted
greater than constraints (<cite>obgnme</cite> startsiwth “g_” or “greater”)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Zero-weighted obs are skipped</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.greater_than_pi_constraints">
<em class="property">property </em><code class="sig-name descname">greater_than_pi_constraints</code><a class="headerlink" href="#pyemu.Pst.greater_than_pi_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>get the names of the prior information eqs that
are listed as active greater than inequality constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>pandas.Series</cite> names of prior information that are non-zero weighted
greater than constraints (<cite>obgnme</cite> startsiwth “g_” or “greater”)</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Zero-weighted pi are skipped</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.less_than_obs_constraints">
<em class="property">property </em><code class="sig-name descname">less_than_obs_constraints</code><a class="headerlink" href="#pyemu.Pst.less_than_obs_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>get the names of the observations that
are listed as active less than inequality constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>names of obseravtions that are non-zero weighted less
than constraints (<cite>obgnme</cite> starts with ‘l_’ or “less”)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Zero-weighted obs are skipped</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.less_than_pi_constraints">
<em class="property">property </em><code class="sig-name descname">less_than_pi_constraints</code><a class="headerlink" href="#pyemu.Pst.less_than_pi_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>get the names of the prior information eqs that
are listed as active less than inequality constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>names of prior information that are non-zero weighted
less than constraints (<cite>obgnme</cite> starts with “l_” or “less”)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Zero-weighted pi are skipped</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.load" title="Permalink to this definition">¶</a></dt>
<dd><p>entry point load the pest control file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – pst filename</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is called from the <cite>Pst</cite> construtor unless the <cite>load</cite> arg is <cite>False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.nnz_obs">
<em class="property">property </em><code class="sig-name descname">nnz_obs</code><a class="headerlink" href="#pyemu.Pst.nnz_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>get the number of non-zero weighted observations</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of non-zeros weighted observations</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.nnz_obs_groups">
<em class="property">property </em><code class="sig-name descname">nnz_obs_groups</code><a class="headerlink" href="#pyemu.Pst.nnz_obs_groups" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the observation groups that contain at least one non-zero weighted</dt><dd><p>observation</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of observation groups that contain at
least one non-zero weighted observation</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.nnz_obs_names">
<em class="property">property </em><code class="sig-name descname">nnz_obs_names</code><a class="headerlink" href="#pyemu.Pst.nnz_obs_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the non-zero weight observation names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of non-zero weighted observation names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.nobs">
<em class="property">property </em><code class="sig-name descname">nobs</code><a class="headerlink" href="#pyemu.Pst.nobs" title="Permalink to this definition">¶</a></dt>
<dd><p>get the number of observations</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of observations</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.npar">
<em class="property">property </em><code class="sig-name descname">npar</code><a class="headerlink" href="#pyemu.Pst.npar" title="Permalink to this definition">¶</a></dt>
<dd><p>get number of parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of parameters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.npar_adj">
<em class="property">property </em><code class="sig-name descname">npar_adj</code><a class="headerlink" href="#pyemu.Pst.npar_adj" title="Permalink to this definition">¶</a></dt>
<dd><p>get the number of adjustable parameters (not fixed or tied)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of adjustable parameters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.nprior">
<em class="property">property </em><code class="sig-name descname">nprior</code><a class="headerlink" href="#pyemu.Pst.nprior" title="Permalink to this definition">¶</a></dt>
<dd><p>number of prior information equations</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of prior info equations</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.obs_groups">
<em class="property">property </em><code class="sig-name descname">obs_groups</code><a class="headerlink" href="#pyemu.Pst.obs_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>get the observation groups</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of unique observation groups</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.obs_names">
<em class="property">property </em><code class="sig-name descname">obs_names</code><a class="headerlink" href="#pyemu.Pst.obs_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the observation names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of observation names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Pst.observation_data">
<code class="sig-name descname">observation_data</code><a class="headerlink" href="#pyemu.Pst.observation_data" title="Permalink to this definition">¶</a></dt>
<dd><p>‘* observation data’ information.  Columns are standard PEST
variable names</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span><span class="o">.</span><span class="n">observation_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">pst</span><span class="o">.</span><span class="n">observation_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;obgnme&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;obs_group&quot;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.par_groups">
<em class="property">property </em><code class="sig-name descname">par_groups</code><a class="headerlink" href="#pyemu.Pst.par_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>get the parameter groups</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of parameter groups</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.par_names">
<em class="property">property </em><code class="sig-name descname">par_names</code><a class="headerlink" href="#pyemu.Pst.par_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the parameter names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of parameter names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Pst.parameter_data">
<code class="sig-name descname">parameter_data</code><a class="headerlink" href="#pyemu.Pst.parameter_data" title="Permalink to this definition">¶</a></dt>
<dd><p>‘* parameter data’ information.  Columns are
standard PEST variable names</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span><span class="o">.</span><span class="n">parameter_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;partrans&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;log&quot;</span>
<span class="n">pst</span><span class="o">.</span><span class="n">parameter_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;parubnd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.parrep">
<code class="sig-name descname">parrep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">enforce_bounds</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.parrep" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>replicates the pest parrep util. replaces the parval1 field in the</dt><dd><p>parameter data section dataframe with values in a PEST parameter file</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parfile</strong> (<cite>str</cite>, optional) – parameter file to use.  If None, try to find and use
a parameter file that corresponds to the case name.
Default is None</p></li>
<li><p><strong>enforce_bounds</strong> (<cite>bool</cite>, optional) – flag to enforce parameter bounds after parameter values are updated.
This is useful because PEST and PEST++ round the parameter values in the
par file, which may cause slight bound violations.  Default is <cite>True</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.phi">
<em class="property">property </em><code class="sig-name descname">phi</code><a class="headerlink" href="#pyemu.Pst.phi" title="Permalink to this definition">¶</a></dt>
<dd><p>get the weighted total objective function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sum of squared residuals</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>float</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires <cite>Pst.res</cite> (the residuals file) to be available</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.phi_components">
<em class="property">property </em><code class="sig-name descname">phi_components</code><a class="headerlink" href="#pyemu.Pst.phi_components" title="Permalink to this definition">¶</a></dt>
<dd><p>get the individual components of the total objective function</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of observation group, contribution to total phi</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires <cite>Pst.res</cite> (the residuals file) to be available</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.phi_components_normalized">
<em class="property">property </em><code class="sig-name descname">phi_components_normalized</code><a class="headerlink" href="#pyemu.Pst.phi_components_normalized" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>get the individual components of the total objective function</dt><dd><p>normalized to the total PHI being 1.0</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of observation group,
normalized contribution to total phi</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires <cite>Pst.res</cite> (the residuals file) to be available</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>method to plot various parts of the control.  This is sweet as!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<cite>str</cite>) – options are ‘prior’ (prior parameter histograms, ‘1to1’ (line of equality
and sim vs res), ‘obs_v_sim’ (time series using datetime suffix), ‘phi_pie’
(pie chart of phi components)</p></li>
<li><p><strong>kwargs</strong> (<cite>dict</cite>) – optional args for plots that are passed to pyemu plot helpers and ultimately
to matplotlib</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on ‘kind’ argument, a multipage pdf is written</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;1to1&quot;</span><span class="p">)</span> <span class="c1"># requires Pst.res</span>
<span class="n">pst</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;prior&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;phi_pie&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.prior_groups">
<em class="property">property </em><code class="sig-name descname">prior_groups</code><a class="headerlink" href="#pyemu.Pst.prior_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>get the prior info groups</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of prior information groups</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Pst.prior_information">
<code class="sig-name descname">prior_information</code><a class="headerlink" href="#pyemu.Pst.prior_information" title="Permalink to this definition">¶</a></dt>
<dd><p>‘* prior information’ data.  Columns are standard PEST
variable names</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.prior_names">
<em class="property">property </em><code class="sig-name descname">prior_names</code><a class="headerlink" href="#pyemu.Pst.prior_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the prior information names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of prior information names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.process_output_files">
<code class="sig-name descname">process_output_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst_path</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.process_output_files" title="Permalink to this definition">¶</a></dt>
<dd><p>processing the model output files using the instruction files
and existing model output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pst_path</strong> (<cite>str</cite>) – relative path from where python is running to
where the control file, instruction files and model output files
are located.  Default is “.” (current python directory)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>model output values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.Series</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>requires a complete set of model input files at relative path
from where python is running to <cite>pst_path</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.proportional_weights">
<code class="sig-name descname">proportional_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fraction_stdev</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">wmax</span><span class="o">=</span><span class="default_value">100.0</span></em>, <em class="sig-param"><span class="n">leave_zero</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.proportional_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>setup  weights inversely proportional to the observation value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fraction_stdev</strong> (<cite>float</cite>, optional) – the fraction portion of the observation
val to treat as the standard deviation.  set to 1.0 for
inversely proportional.  Default is 1.0</p></li>
<li><p><strong>wmax</strong> (<cite>float</cite>, optional) – maximum weight to allow.  Default is 100.0</p></li>
<li><p><strong>leave_zero</strong> (<cite>bool</cite>, optional) – flag to leave existing zero weights.
Default is True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.rectify_pgroups">
<code class="sig-name descname">rectify_pgroups</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.rectify_pgroups" title="Permalink to this definition">¶</a></dt>
<dd><p>synchronize parameter groups section with the parameter data section</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is called during <cite>Pst.write()</cite> to make sure all parameter
groups named in <cite>* parameter data</cite> are included.  This is so users
don’t have to manually keep this section up.  This method can also be
called during control file modifications to see what parameter groups
are present and prepare for modifying the default values in the <cite>* parameter
group</cite> section</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">parameter_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;par1&quot;</span><span class="p">,</span><span class="s2">&quot;pargp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;new_group&quot;</span>
<span class="n">pst</span><span class="o">.</span><span class="n">rectify_groups</span><span class="p">()</span>
<span class="n">pst</span><span class="o">.</span><span class="n">parameter_groups</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;new_group&quot;</span><span class="p">,</span><span class="s2">&quot;derinc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.rectify_pi">
<code class="sig-name descname">rectify_pi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.rectify_pi" title="Permalink to this definition">¶</a></dt>
<dd><p>rectify the prior information equation with the current state of the
parameter_data dataframe.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Equations that list fixed, tied or missing parameters
are removed completely even if adjustable parameters are also
listed in the equation. This method is called during Pst.write()</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Pst.reg_data">
<code class="sig-name descname">reg_data</code><a class="headerlink" href="#pyemu.Pst.reg_data" title="Permalink to this definition">¶</a></dt>
<dd><p>‘* regularization’ section information.
Access with standard PEST variable names.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span><span class="o">.</span><span class="n">reg_data</span><span class="o">.</span><span class="n">phimlim</span> <span class="o">=</span> <span class="mf">1.00</span> <span class="c1">#yeah right!</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.RegData" title="pyemu.pst.pst_controldata.RegData">pyemu.pst.pst_controldata.RegData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.res">
<em class="property">property </em><code class="sig-name descname">res</code><a class="headerlink" href="#pyemu.Pst.res" title="Permalink to this definition">¶</a></dt>
<dd><p>get the residuals dataframe attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe containing the
residuals information.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>if the Pst.__res attribute has not been loaded,</dt><dd><p>this call loads the res dataframe from a file</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.sanity_checks">
<code class="sig-name descname">sanity_checks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.sanity_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>some basic check for strangeness</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>checks for duplicate names, atleast 1 adjustable parameter
and at least 1 non-zero-weighted observation</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.set_res">
<code class="sig-name descname">set_res</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">res</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.set_res" title="Permalink to this definition">¶</a></dt>
<dd><p>reset the private <cite>Pst.res</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>res</strong> – (<cite>pandas.DataFrame</cite> or <cite>str</cite>): something to use as Pst.res attribute.
If <cite>res</cite> is <cite>str</cite>, a dataframe is read from file <cite>res</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.Pst.svd_data">
<code class="sig-name descname">svd_data</code><a class="headerlink" href="#pyemu.Pst.svd_data" title="Permalink to this definition">¶</a></dt>
<dd><p>‘* singular value decomposition’ section information.
Access with standard PEST variable names</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span><span class="o">.</span><span class="n">svd_data</span><span class="o">.</span><span class="n">maxsing</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pyemu.pst.html#pyemu.pst.pst_controldata.SvdData" title="pyemu.pst.pst_controldata.SvdData">pyemu.pst.pst_controldata.SvdData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.tied">
<em class="property">property </em><code class="sig-name descname">tied</code><a class="headerlink" href="#pyemu.Pst.tied" title="Permalink to this definition">¶</a></dt>
<dd><p>list of tied parameter names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe of tied parameter information.
Columns of <cite>tied</cite> are <cite>parnme</cite> and <cite>partied</cite>.  Returns <cite>None</cite> if
no tied parameters are found.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.try_parse_name_metadata">
<code class="sig-name descname">try_parse_name_metadata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.try_parse_name_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>try to add meta data columns to parameter and observation data based on
item names.  Used with the PstFrom process.</p>
<dl class="simple">
<dt>Note: metadata is identified in key-value pairs that are separated by a colon.</dt><dd><p>each key-value pair is separated from others by underscore</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">new_filename</span></em>, <em class="sig-param"><span class="n">version</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.write" title="Permalink to this definition">¶</a></dt>
<dd><p>main entry point to write a pest control file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_filename</strong> (<cite>str</cite>) – name of the new pest control file</p></li>
<li><p><strong>version</strong> (<cite>int</cite>) – flag for which version of control file to write (must be 1 or 2).
if None, uses Pst._version, which set in the constructor and modified
during the load</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">parrep</span><span class="p">(</span><span class="s2">&quot;my.par&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">my_new</span><span class="o">.</span><span class="n">pst</span><span class="s2">&quot;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.write_input_files">
<code class="sig-name descname">write_input_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst_path</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.write_input_files" title="Permalink to this definition">¶</a></dt>
<dd><p>writes model input files using template files and current <cite>parval1</cite> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pst_path</strong> (<cite>str</cite>) – the path to where control file and template files reside.
Default is ‘.’</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>adds “parval1_trans” column to Pst.parameter_data that includes the
effect of scale and offset</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>

<span class="c1"># load final parameter values</span>
<span class="n">pst</span><span class="o">.</span><span class="n">parrep</span><span class="p">(</span><span class="s2">&quot;my.par&quot;</span><span class="p">)</span>

<span class="c1"># write new model input files with final parameter values</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write_input_files</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.write_obs_summary_table">
<code class="sig-name descname">write_obs_summary_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">group_names</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.write_obs_summary_table" title="Permalink to this definition">¶</a></dt>
<dd><p>write a stand alone observation summary latex table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – latex filename. If <cite>filename</cite> is “none”, no table is written.
If None, use &lt;case&gt;.par.tex. Default is None</p></li>
<li><p><strong>group_names</strong> (<cite>dict</cite>) – obs group names : table names. For example {“hds”:”simulated groundwater level”}.
Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the summary observation group dataframe</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write_obs_summary_table</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;obs.tex&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.write_par_summary_table">
<code class="sig-name descname">write_par_summary_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">group_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">4.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Pst.write_par_summary_table" title="Permalink to this definition">¶</a></dt>
<dd><p>write a stand alone parameter summary latex table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – latex filename. If None, use &lt;case&gt;.par.tex. If <cite>filename</cite> is “none”, no table
is writtenDefault is None</p></li>
<li><p><strong>group_names</strong> (<cite>dict</cite>) – par group names : table names. For example {“w0”:”well stress period 1”}.
Default is None</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – number of standard deviations represented by parameter bounds.  Default
is 4.0, implying 95% confidence bounds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the summary parameter group dataframe</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write_par_summary_table</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;par.tex&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Pst.zero_weight_obs_names">
<em class="property">property </em><code class="sig-name descname">zero_weight_obs_names</code><a class="headerlink" href="#pyemu.Pst.zero_weight_obs_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get the zero-weighted observation names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of zero-weighted observation names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>str</cite>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.Schur">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.</code><code class="sig-name descname">Schur</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jco</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.la.LinearAnalysis" title="pyemu.la.LinearAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.la.LinearAnalysis</span></code></a></p>
<p>FOSM-based uncertainty and data-worth analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jco</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast or loaded into a <cite>pyemu.Jco</cite>.  Can be a
str for a filename or <cite>pyemu.Matrix</cite>/<cite>pyemu.Jco</cite> object.</p></li>
<li><p><strong>pst</strong> (<em>varies</em><em>, </em><em>optional</em>) – something that can be cast into a <cite>pyemu.Pst</cite>.  Can be an <cite>str</cite> for a
filename or an existing <cite>pyemu.Pst</cite>.  If <cite>None</cite>, a pst filename is sought
with the same base name as the jco argument (if passed)</p></li>
<li><p><strong>parcov</strong> (<em>varies</em><em>, </em><em>optional</em>) – prior parameter covariance matrix.  If <cite>str</cite>, a filename is assumed and
the prior parameter covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the prior parameter covariance matrix is
constructed from the parameter bounds in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>obscov</strong> (<em>varies</em><em>, </em><em>optional</em>) – observation noise covariance matrix.  If <cite>str</cite>, a filename is assumed and
the noise covariance matrix is loaded from a file using
the file extension (“.jcb”/”.jco” for binary, “.cov”/”.mat” for PEST-style ASCII matrix,
or “.unc” for uncertainty files).  If <cite>None</cite>, the noise covariance matrix is
constructed from the obsevation weights in <cite>LinearAnalysis.pst</cite>.  Can also be a <cite>pyemu.Cov</cite> instance</p></li>
<li><p><strong>forecasts</strong> (<em>varies</em><em>, </em><em>optional</em>) – forecast sensitivity vectors.  If <cite>str</cite>, first an observation name is assumed (a row
in <cite>LinearAnalysis.jco</cite>).  If that is not found, a filename is assumed and predictions are
loaded from a file using the file extension.  If [<cite>str</cite>], a list of observation names is assumed.
Can also be a <cite>pyemu.Matrix</cite> instance, a <cite>numpy.ndarray</cite> or a collection.  Note if the PEST++ option
“++forecasts()” is set in the pest control file (under the <cite>pyemu.Pst.pestpp_options</cite> dictionary),
then there is no need to pass this argument (unless you want to analyze different forecasts)
of <cite>pyemu.Matrix</cite> or <cite>numpy.ndarray</cite>.</p></li>
<li><p><strong>ref_var</strong> (<em>float</em><em>, </em><em>optional</em>) – reference variance.  Default is 1.0</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – controls screen output.  If <cite>str</cite>, a filename is assumed and
and log file is written.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>, optional) – defines range of upper bound - lower bound in terms of standard
deviation (sigma). For example, if sigma_range = 4, the bounds represent 4 * sigma.
Default is 4.0, representing approximately 95% confidence of implied normal distribution.
This arg is only used if constructing parcov from parameter bounds.</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>, optional) – flag to apply parameter scale and offset to parameter bounds
when calculating prior parameter covariance matrix from bounds.  This arg is onlyused if
constructing parcov from parameter bounds.Default is True.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is the primary entry point for FOSM-based uncertainty and
dataworth analyses</p>
<p>This class replicates and extends the behavior of the PEST PREDUNC utilities.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#assumes &quot;my.pst&quot; exists</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">,</span><span class="n">forecasts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="s2">&quot;fore2&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">get_forecast_summary</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">get_parameter_contribution</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.Schur.get_added_obs_group_importance">
<code class="sig-name descname">get_added_obs_group_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_added_obs_group_importance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A dataworth method to analyze the posterior uncertainty as a result of gaining</dt><dd><p>existing observations, tested by observation groups</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dataframe with index of observation group names and columns
of forecast names.  The values in the dataframe are the posterior
variances of the forecasts resulting from gaining the information
contained in each observation group. One row in the dataframe is labeled “base” - this is
posterior forecast variance resulting from the notional calibration with the
non-zero-weighed observations in <cite>Schur.pst</cite>.  Conceptually, the forecast variance should
either not change or decrease as a result of gaining new observations.  The magnitude
of the decrease represents the worth of the potential new observation(s) in each group
being tested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observations in <cite>Schur.pst</cite> with zero weights are not included in the analysis unless
<cite>reset_zero_weight</cite> is <cite>True</cite> or a float greater than zero.  In most cases, users
will want to reset zero-weighted observations as part dataworth testing process.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_added_obs_group_importance</span><span class="p">(</span><span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_added_obs_importance">
<code class="sig-name descname">get_added_obs_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obslist_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">base_obslist</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_added_obs_importance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A dataworth method to analyze the posterior uncertainty as a result of gathering</dt><dd><p>some additional observations</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obslist_dict</strong> (<cite>dict</cite>, optional) – a nested dictionary-list of groups of observations
that are to be treated as gained/collected.  key values become
row labels in returned dataframe. If <cite>None</cite>, then every zero-weighted
observation is tested sequentially. Default is <cite>None</cite></p></li>
<li><p><strong>base_obslist</strong> ([<cite>str</cite>], optional) – observation names to treat as the “existing” observations.
The values of <cite>obslist_dict</cite> will be added to this list during
each test.  If <cite>None</cite>, then the values in each <cite>obslist_dict</cite> entry will
be treated as the entire calibration dataset.  That is, there
are no existing observations. Default is <cite>None</cite>.  Standard practice would
be to pass this argument as <cite>pyemu.Schur.pst.nnz_obs_names</cite> so that existing,
non-zero-weighted observations are accounted for in evaluating the worth of
new yet-to-be-collected observations.</p></li>
<li><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with row labels (index) of <cite>obslist_dict.keys()</cite> and
columns of forecast names.  The values in the dataframe are the
posterior variance of the forecasts resulting from notional inversion
using the observations in <cite>obslist_dict[key value]</cite> plus the observations
in <cite>base_obslist</cite> (if any).  One row in the dataframe is labeled “base” - this is
posterior forecast variance resulting from the notional calibration with the
observations in <cite>base_obslist</cite> (if <cite>base_obslist</cite> is <cite>None</cite>, then the “base” row is the
prior forecast variance).  Conceptually, the forecast variance should either not change or
decrease as a result of gaining additional observations.  The magnitude of the decrease
represents the worth of the potential new observation(s) being tested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observations listed in <cite>obslist_dict</cite> and <cite>base_obslist</cite> with zero
weights are not included in the analysis unless <cite>reset_zero_weight</cite> is <cite>True</cite> or a float
greater than zero.  In most cases, users will want to reset zero-weighted observations as part
dataworth testing process.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">obslist_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;hds&quot;</span><span class="p">:[</span><span class="s2">&quot;head1&quot;</span><span class="p">,</span><span class="s2">&quot;head2&quot;</span><span class="p">],</span><span class="s2">&quot;flux&quot;</span><span class="p">:[</span><span class="s2">&quot;flux1&quot;</span><span class="p">,</span><span class="s2">&quot;flux2&quot;</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_added_obs_importance</span><span class="p">(</span><span class="n">obslist_dict</span><span class="o">=</span><span class="n">obslist_dict</span><span class="p">,</span>
                                 <span class="n">base_obslist</span><span class="o">=</span><span class="n">sc</span><span class="o">.</span><span class="n">pst</span><span class="o">.</span><span class="n">nnz_obs_names</span><span class="p">,</span>
                                 <span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_conditional_instance">
<code class="sig-name descname">get_conditional_instance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parameter_names</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_conditional_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>get a new <cite>pyemu.Schur</cite> instance that includes conditional update from
some parameters becoming known perfectly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parameter_names</strong> ([<cite>str</cite>]) – list of parameters that are to be treated as
notionally perfectly known</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Schur instance conditional on perfect knowledge
of some parameters. The new instance has an updated <cite>parcov</cite> that is less
the names listed in <cite>parameter_names</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Schur</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is primarily for use by the <cite>LinearAnalysis.get_parameter_contribution()</cite>
dataworth method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_forecast_summary">
<code class="sig-name descname">get_forecast_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_forecast_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>summary of the FOSM-based forecast uncertainty (variance) estimate(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataframe of prior,posterior variances and percent
uncertainty reduction of each forecast (e.g. prediction)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the primary entry point for accessing forecast uncertainty estimates
“precent_reduction” column in dataframe is calculated as
100.0 * (1.0 - (posterior variance / prior variance)</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jcb&quot;</span><span class="p">,</span><span class="n">forecasts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="s2">&quot;fore2&quot;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_parameter_summary</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s2">&quot;prior&quot;</span><span class="p">,</span><span class="s2">&quot;posterior&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">percent_reduction</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_obs_group_dict">
<code class="sig-name descname">get_obs_group_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_obs_group_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>get a dictionary of observations grouped by observation group name</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary of observations grouped by observation group name.
Useful for dataworth processing in <cite>pyemu.Schur</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>only includes observations that are listed in <cite>Schur.jco.row_names</cite></p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">obsgrp_dict</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_obs_group_dict</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_removed_obs_importance</span><span class="p">(</span><span class="n">obsgrp_dict</span><span class="o">=</span><span class="n">obsgrp_dict</span><span class="p">,</span> <span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_par_contribution">
<code class="sig-name descname">get_par_contribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parlist_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_prior_results</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_par_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>A dataworth method to get a dataframe the prior and posterior uncertainty
reduction as a result of some parameter becoming perfectly known</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parlist_dict</strong> – (<cite>dict</cite>, optional): a nested dictionary-list of groups of parameters
that are to be treated as perfectly known.  key values become
row labels in returned dataframe.  If <cite>None</cite>, each adjustable parameter
is sequentially treated as known and the returned dataframe
has row labels for each adjustable parameter</p></li>
<li><p><strong>include_prior_results</strong> (<cite>bool</cite>, optional) – flag to return a multi-indexed dataframe with both conditional
prior and posterior forecast uncertainty estimates.  This is because
the notional learning about parameters potentially effects both the prior
and posterior forecast uncertainty estimates. If <cite>False</cite>, only posterior
results are returned.  Default is <cite>False</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe that summarizes the parameter contribution
dataworth analysis. The dataframe has index (row labels) of the keys in parlist_dict
and a column labels of forecast names.  The values in the dataframe
are the posterior variance of the forecast conditional on perfect
knowledge of the parameters in the values of parlist_dict.  One row in the
dataframe will be labeled <cite>base</cite> - this is the forecast uncertainty estimates
that include the effects of all adjustable parameters.  Percent decreases in
forecast uncertainty can be calculated by differencing all rows against the
“base” row.  Varies depending on <cite>include_prior_results</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the primary dataworth method for assessing the contribution of one or more
parameters to forecast uncertainty.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">parlist_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;hk&quot;</span><span class="p">:[</span><span class="s2">&quot;hk1&quot;</span><span class="p">,</span><span class="s2">&quot;hk2&quot;</span><span class="p">],</span><span class="s2">&quot;rech&quot;</span><span class="p">[</span><span class="s2">&quot;rech1&quot;</span><span class="p">,</span><span class="s2">&quot;rech2&quot;</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_par_contribution</span><span class="p">(</span><span class="n">parlist_dict</span><span class="o">=</span><span class="n">parlist_dict</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_par_group_contribution">
<code class="sig-name descname">get_par_group_contribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">include_prior_results</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_par_group_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>A dataworth method to get the forecast uncertainty contribution from each parameter
group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>include_prior_results</strong> (<cite>bool</cite>, optional) – flag to return a multi-indexed dataframe with both conditional
prior and posterior forecast uncertainty estimates.  This is because
the notional learning about parameters potentially effects both the prior
and posterior forecast uncertainty estimates. If <cite>False</cite>, only posterior
results are returned.  Default is <cite>False</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe that summarizes the parameter contribution analysis.
The dataframe has index (row labels) that are the parameter group names
and a column labels of forecast names.  The values in the dataframe
are the posterior variance of the forecast conditional on perfect
knowledge of the adjustable parameters in each parameter group.  One
row is labelled “base” - this is the variance of the forecasts that includes
the effects of all adjustable parameters. Varies depending on <cite>include_prior_results</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is just a thin wrapper around get_contribution_dataframe() - this method
automatically constructs the parlist_dict argument where the keys are the
group names and the values are the adjustable parameters in the groups</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_par_group_contribution</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_parameter_summary">
<code class="sig-name descname">get_parameter_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_parameter_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>summary of the FOSM-based parameter uncertainty (variance) estimate(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataframe of prior,posterior variances and percent
uncertainty reduction of each parameter</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the primary entry point for accessing parameter uncertainty estimates</p>
<p>The “Prior” column in dataframe is the diagonal of <cite>LinearAnalysis.parcov</cite>
“precent_reduction” column in dataframe is calculated as 100.0 * (1.0 -
(posterior variance / prior variance)</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jcb&quot;</span><span class="p">,</span><span class="n">forecasts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="s2">&quot;fore2&quot;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_parameter_summary</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s2">&quot;prior&quot;</span><span class="p">,</span><span class="s2">&quot;posterior&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">percent_reduction</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_removed_obs_group_importance">
<code class="sig-name descname">get_removed_obs_group_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_removed_obs_group_importance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A dataworth method to analyze the posterior uncertainty as a result of losing</dt><dd><p>existing observations, tested by observation groups</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dataframe with index of observation group names and columns
of forecast names.  The values in the dataframe are the posterior
variances of the forecasts resulting from losing the information
contained in each observation group. One row in the dataframe is labeled “base” - this is
posterior forecast variance resulting from the notional calibration with the
non-zero-weighed observations in <cite>Schur.pst</cite>.  Conceptually, the forecast variance should
either not change or increase as a result of losing existing observations.  The magnitude
of the increase represents the worth of the existing observation(s) in each group being tested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observations in <cite>Schur.pst</cite> with zero weights are not included in the analysis unless
<cite>reset_zero_weight</cite> is <cite>True</cite> or a float greater than zero.  In most cases, users
will want to reset zero-weighted observations as part dataworth testing process.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_removed_obs_group_importance</span><span class="p">(</span><span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.get_removed_obs_importance">
<code class="sig-name descname">get_removed_obs_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obslist_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.get_removed_obs_importance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A dataworth method to analyze the posterior uncertainty as a result of losing</dt><dd><p>some existing observations</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obslist_dict</strong> (<cite>dict</cite>, optional) – a nested dictionary-list of groups of observations
that are to be treated as lost.  key values become
row labels in returned dataframe. If <cite>None</cite>, then every zero-weighted
observation is tested sequentially. Default is <cite>None</cite></p></li>
<li><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dataframe with index of obslist_dict.keys() and columns
of forecast names.  The values in the dataframe are the posterior
variances of the forecasts resulting from losing the information
contained in obslist_dict[key value]. One row in the dataframe is labeled “base” - this is
posterior forecast variance resulting from the notional calibration with the
non-zero-weighed observations in <cite>Schur.pst</cite>.  Conceptually, the forecast variance should
either not change or increase as a result of losing existing observations.  The magnitude
of the increase represents the worth of the existing observation(s) being tested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observations listed in <cite>obslist_dict</cite> and <cite>base_obslist</cite> with zero
weights are not included in the analysis unless <cite>reset_zero_weight</cite> is <cite>True</cite> or a float
greater than zero.  In most cases, users will want to reset zero-weighted observations as part
dataworth testing process.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_removed_obs_importance</span><span class="p">(</span><span class="n">reset_zero_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.next_most_important_added_obs">
<code class="sig-name descname">next_most_important_added_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">forecast</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">obslist_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">base_obslist</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reset_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.next_most_important_added_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>find the most important observation(s) by sequentially evaluating
the importance of the observations in <cite>obslist_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forecast</strong> (<cite>str</cite>, optional) – name of the forecast to use in the ranking process.  If
more than one forecast has been listed, this argument is required.  This is because
the data worth must be ranked with respect to the variance reduction for a single
forecast</p></li>
<li><p><strong>niter</strong> (<cite>int</cite>, optional) – number of sequential dataworth testing iterations.  Default is 3</p></li>
<li><p><strong>obslist_dict</strong> (<cite>dict</cite>, optional) – a nested dictionary-list of groups of observations
that are to be treated as gained/collected.  key values become
row labels in returned dataframe. If <cite>None</cite>, then every zero-weighted
observation is tested sequentially. Default is <cite>None</cite></p></li>
<li><p><strong>base_obslist</strong> ([<cite>str</cite>], optional) – observation names to treat as the “existing” observations.
The values of <cite>obslist_dict</cite> will be added to this list during
each test.  If <cite>None</cite>, then the values in each <cite>obslist_dict</cite> entry will
be treated as the entire calibration dataset.  That is, there
are no existing observations. Default is <cite>None</cite>.  Standard practice would
be to pass this argument as <cite>pyemu.Schur.pst.nnz_obs_names</cite> so that existing,
non-zero-weighted observations are accounted for in evaluating the worth of
new yet-to-be-collected observations.</p></li>
<li><p><strong>reset_zero_weight</strong> (<cite>bool</cite>, optional) – a flag to reset observations with zero weight in either
<cite>obslist_dict</cite> or <cite>base_obslist</cite>. If <cite>reset_zero_weights</cite>
passed as a <cite>float</cite>,then that value will be assigned to
zero weight obs.  Otherwise, zero-weight obs will be given a
weight of 1.0.  Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataFrame with columns of <cite>obslist_dict</cite> key for each iteration
the yields the largest variance reduction for the named <cite>forecast</cite>. Columns are forecast
variance percent reduction for each iteration (percent reduction compared to initial “base”
case with all non-zero weighted observations included in the notional calibration)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The most important observations from each iteration is added to <cite>base_obslist</cite>
and removed <cite>obslist_dict</cite> for the next iteration.  In this way, the added
observation importance values include the conditional information from
the last iteration.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jco&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">next_most_important_added_obs</span><span class="p">(</span><span class="n">forecast</span><span class="o">=</span><span class="s2">&quot;fore1&quot;</span><span class="p">,</span><span class="n">base_obslist</span><span class="o">=</span><span class="n">sc</span><span class="o">.</span><span class="n">pst</span><span class="o">.</span><span class="n">nnz_obs_names</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.next_most_par_contribution">
<code class="sig-name descname">next_most_par_contribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">forecast</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parlist_dict</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.Schur.next_most_par_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>find the parameter(s) contributing most to posterior
forecast  by sequentially evaluating the contribution of parameters in
<cite>parlist_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forecast</strong> (<cite>str</cite>, optional) – name of the forecast to use in the ranking process.  If
more than one forecast has been listed, this argument is required.  This is because
the data worth must be ranked with respect to the variance reduction for a single
forecast</p></li>
<li><p><strong>niter</strong> (<cite>int</cite>, optional) – number of sequential dataworth testing iterations.  Default is 3</p></li>
<li><p><strong>parlist_dict</strong> (<cite>dict</cite>, optional) – dict
a nested dictionary-list of groups of parameters
that are to be treated as perfectly known.  key values become
row labels in dataframe</p></li>
<li><p><strong>parlist_dict</strong> – a nested dictionary-list of groups of parameters
that are to be treated as perfectly known (zero uncertainty).  key values become
row labels in returned dataframe. If <cite>None</cite>, then every adustable parameter is tested
sequentially. Default is <cite>None</cite>. Conceptually, the forecast variance should
either not change or decrease as a result of knowing parameter perfectly.  The magnitude
of the decrease represents the worth of gathering information about the parameter(s) being
tested.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The largest contributing parameters from each iteration are
treated as known perfectly for the remaining iterations.  In this way, the
next iteration seeks the next most influential group of parameters.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe with index of iteration number and columns
of <cite>parlist_dict.keys()</cite>.  The values are the results of the knowing
each parlist_dict entry expressed as posterior variance reduction</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.posterior_forecast">
<em class="property">property </em><code class="sig-name descname">posterior_forecast</code><a class="headerlink" href="#pyemu.Schur.posterior_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>posterior forecast (e.g. prediction) variance(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of forecast names and FOSM-estimated posterior
variances</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sames as <cite>LinearAnalysis.posterior_prediction</cite></p>
<p>See <cite>Schur.get_forecast_summary()</cite> for a dataframe-based container of prior and posterior
variances</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.posterior_parameter">
<em class="property">property </em><code class="sig-name descname">posterior_parameter</code><a class="headerlink" href="#pyemu.Schur.posterior_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>posterior parameter covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the posterior parameter covariance matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">jco</span><span class="o">=</span><span class="s2">&quot;my.jcb&quot;</span><span class="p">)</span>
<span class="n">post_cov</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">posterior_parameter</span>
<span class="n">post_cov</span><span class="o">.</span><span class="n">to_ascii</span><span class="p">(</span><span class="s2">&quot;post.cov&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.Schur.posterior_prediction">
<em class="property">property </em><code class="sig-name descname">posterior_prediction</code><a class="headerlink" href="#pyemu.Schur.posterior_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>posterior prediction (e.g. forecast) variance estimate(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of forecast names and FOSM-estimated posterior
variances</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><p><cite>dict</cite></p>
<dl>
<dt>Note:</dt><dd><p>sames as <cite>LinearAnalysis.posterior_forecast</cite></p>
<p>See <cite>Schur.get_forecast_summary()</cite> for a dataframe-based container of prior and posterior
variances</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jeremy White, Mike Fienen, Brioch Hemmings, and others

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>