

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyemu.utils package &mdash; pyEMU 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyEMU
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">pyemu.utils package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.geostats">pyemu.utils.geostats module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.gw_utils">pyemu.utils.gw_utils module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.helpers">pyemu.utils.helpers module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.optimization">pyemu.utils.optimization module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.os_utils">pyemu.utils.os_utils module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.pp_utils">pyemu.utils.pp_utils module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.pst_from">pyemu.utils.pst_from module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.smp_utils">pyemu.utils.smp_utils module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils">Module contents</a><ul>
<li><a class="reference internal" href="#pyemu.utils.geostats.ExpVario">ExpVario</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GauVario">GauVario</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct">GeoStruct</a><ul>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.covariance">covariance</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.covariance_matrix">covariance_matrix</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.covariance_points">covariance_points</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.nugget">nugget</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.plot">plot</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.same_as_other">same_as_other</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.sill">sill</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.to_struct_file">to_struct_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.transform">transform</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct.variograms">variograms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.utils.geostats.OrdinaryKrige">OrdinaryKrige</a><ul>
<li><a class="reference internal" href="#pyemu.utils.geostats.OrdinaryKrige.calc_factors">calc_factors</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.OrdinaryKrige.calc_factors_grid">calc_factors_grid</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.OrdinaryKrige.check_point_data_dist">check_point_data_dist</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.OrdinaryKrige.to_grid_factors_file">to_grid_factors_file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.utils.geostats.SpecSim2d">SpecSim2d</a><ul>
<li><a class="reference internal" href="#pyemu.utils.geostats.SpecSim2d.draw_arrays">draw_arrays</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.SpecSim2d.draw_conditional">draw_conditional</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.SpecSim2d.grid_is_regular">grid_is_regular</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.SpecSim2d.grid_par_ensemble_helper">grid_par_ensemble_helper</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.SpecSim2d.initialize">initialize</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.utils.geostats.SphVario">SphVario</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d">Vario2d</a><ul>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.bearing_rads">bearing_rads</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.covariance">covariance</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.covariance_matrix">covariance_matrix</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.covariance_points">covariance_points</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.inv_h">inv_h</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.plot">plot</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.rotation_coefs">rotation_coefs</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.same_as_other">same_as_other</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.Vario2d.to_struct_file">to_struct_file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.utils.geostats.fac2real">fac2real</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.gslib_2_dataframe">gslib_2_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.load_sgems_exp_var">load_sgems_exp_var</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.read_sgems_variogram_xml">read_sgems_variogram_xml</a></li>
<li><a class="reference internal" href="#pyemu.utils.geostats.read_struct_file">read_struct_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_gage_obs">apply_gage_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_hds_obs">apply_hds_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_hds_timeseries">apply_hds_timeseries</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_hfb_pars">apply_hfb_pars</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_mflist_budget_obs">apply_mflist_budget_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_mtlist_budget_obs">apply_mtlist_budget_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_sfr_obs">apply_sfr_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_sfr_parameters">apply_sfr_parameters</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_sfr_reach_obs">apply_sfr_reach_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_sfr_seg_parameters">apply_sfr_seg_parameters</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.apply_sft_obs">apply_sft_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.last_kstp_from_kper">last_kstp_from_kper</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.load_sfr_out">load_sfr_out</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.modflow_hob_to_instruction_file">modflow_hob_to_instruction_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.modflow_hydmod_to_instruction_file">modflow_hydmod_to_instruction_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.modflow_pval_to_template_file">modflow_pval_to_template_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.modflow_read_hydmod_file">modflow_read_hydmod_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.modflow_sfr_gag_to_instruction_file">modflow_sfr_gag_to_instruction_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_gage_obs">setup_gage_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_hds_obs">setup_hds_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_hds_timeseries">setup_hds_timeseries</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_mflist_budget_obs">setup_mflist_budget_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_mtlist_budget_obs">setup_mtlist_budget_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_sfr_obs">setup_sfr_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_sfr_reach_obs">setup_sfr_reach_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_sfr_reach_parameters">setup_sfr_reach_parameters</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_sfr_seg_parameters">setup_sfr_seg_parameters</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.setup_sft_obs">setup_sft_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.write_hfb_template">write_hfb_template</a></li>
<li><a class="reference internal" href="#pyemu.utils.gw_utils.write_hfb_zone_multipliers_template">write_hfb_zone_multipliers_template</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.PstFromFlopyModel">PstFromFlopyModel</a><ul>
<li><a class="reference internal" href="#pyemu.utils.helpers.PstFromFlopyModel.build_prior">build_prior</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.PstFromFlopyModel.build_pst">build_pst</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.PstFromFlopyModel.draw">draw</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.PstFromFlopyModel.write_forward_run">write_forward_run</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference">SpatialReference</a><ul>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.xedge">xedge</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.yedge">yedge</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.xgrid">xgrid</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.ygrid">ygrid</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.xcenter">xcenter</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.ycenter">ycenter</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.xcentergrid">xcentergrid</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.ycentergrid">ycentergrid</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.vertices">vertices</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.attribs_from_namfile_header">attribs_from_namfile_header</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.attribute_dict">attribute_dict</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.bounds">bounds</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.defaults">defaults</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.epsg">epsg</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.from_gridspec">from_gridspec</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.from_namfile">from_namfile</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_extent">get_extent</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_grid_lines">get_grid_lines</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_ij">get_ij</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_rc">get_rc</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_vertices">get_vertices</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_xcenter_array">get_xcenter_array</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_xedge_array">get_xedge_array</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_ycenter_array">get_ycenter_array</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.get_yedge_array">get_yedge_array</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.length_multiplier">length_multiplier</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.lenuni">lenuni</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.lenuni_text">lenuni_text</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.lenuni_values">lenuni_values</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.load">load</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.model_length_units">model_length_units</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.ncol">ncol</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.nrow">nrow</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.origin_loc">origin_loc</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.proj4_str">proj4_str</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.read_usgs_model_reference_file">read_usgs_model_reference_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.reset">reset</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.rotate">rotate</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.rotation">rotation</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.set_spatialreference">set_spatialreference</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.theta">theta</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.transform">transform</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.units">units</a></li>
<li><a class="reference internal" href="#id0">vertices</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.write_gridspec">write_gridspec</a></li>
<li><a class="reference internal" href="#id1">xcenter</a></li>
<li><a class="reference internal" href="#id2">xcentergrid</a></li>
<li><a class="reference internal" href="#id3">xedge</a></li>
<li><a class="reference internal" href="#id4">xgrid</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.xll">xll</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.xul">xul</a></li>
<li><a class="reference internal" href="#id5">ycenter</a></li>
<li><a class="reference internal" href="#id6">ycentergrid</a></li>
<li><a class="reference internal" href="#id7">yedge</a></li>
<li><a class="reference internal" href="#id8">ygrid</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.yll">yll</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.SpatialReference.yul">yul</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.utils.helpers.apply_array_pars">apply_array_pars</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.apply_genericlist_pars">apply_genericlist_pars</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.apply_list_and_array_pars">apply_list_and_array_pars</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.apply_list_pars">apply_list_pars</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.apply_temporal_diff_obs">apply_temporal_diff_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.build_jac_test_csv">build_jac_test_csv</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.calc_observation_ensemble_quantiles">calc_observation_ensemble_quantiles</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.calc_rmse_ensemble">calc_rmse_ensemble</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.first_order_pearson_tikhonov">first_order_pearson_tikhonov</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.geostatistical_draws">geostatistical_draws</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.geostatistical_prior_builder">geostatistical_prior_builder</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.get_maha_obs_summary">get_maha_obs_summary</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.jco_from_pestpp_runstorage">jco_from_pestpp_runstorage</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.kl_apply">kl_apply</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.kl_setup">kl_setup</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.parse_dir_for_io_files">parse_dir_for_io_files</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.pst_from_io_files">pst_from_io_files</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.pst_from_parnames_obsnames">pst_from_parnames_obsnames</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.read_pestpp_runstorage">read_pestpp_runstorage</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.setup_fake_forward_run">setup_fake_forward_run</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.setup_temporal_diff_obs">setup_temporal_diff_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.simple_ins_from_obs">simple_ins_from_obs</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.simple_tpl_from_pars">simple_tpl_from_pars</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.write_const_tpl">write_const_tpl</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.write_grid_tpl">write_grid_tpl</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.write_zone_tpl">write_zone_tpl</a></li>
<li><a class="reference internal" href="#pyemu.utils.helpers.zero_order_tikhonov">zero_order_tikhonov</a></li>
<li><a class="reference internal" href="#pyemu.utils.optimization.add_pi_obj_func">add_pi_obj_func</a></li>
<li><a class="reference internal" href="#pyemu.utils.os_utils.run">run</a></li>
<li><a class="reference internal" href="#pyemu.utils.os_utils.start_workers">start_workers</a></li>
<li><a class="reference internal" href="#pyemu.utils.pp_utils.pilot_points_to_tpl">pilot_points_to_tpl</a></li>
<li><a class="reference internal" href="#pyemu.utils.pp_utils.pp_file_to_dataframe">pp_file_to_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.utils.pp_utils.pp_tpl_to_dataframe">pp_tpl_to_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.utils.pp_utils.setup_pilotpoints_grid">setup_pilotpoints_grid</a></li>
<li><a class="reference internal" href="#pyemu.utils.pp_utils.write_pp_file">write_pp_file</a></li>
<li><a class="reference internal" href="#pyemu.utils.pp_utils.write_pp_shapfile">write_pp_shapfile</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom">PstFrom</a><ul>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.add_observations">add_observations</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.add_observations_from_ins">add_observations_from_ins</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.add_parameters">add_parameters</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.add_py_function">add_py_function</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.build_prior">build_prior</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.build_pst">build_pst</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.draw">draw</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.initialize_spatial_reference">initialize_spatial_reference</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.parfile_relations">parfile_relations</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.parse_kij_args">parse_kij_args</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.PstFrom.write_forward_run">write_forward_run</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.write_array_tpl">write_array_tpl</a></li>
<li><a class="reference internal" href="#pyemu.utils.pst_from.write_list_tpl">write_list_tpl</a></li>
<li><a class="reference internal" href="#pyemu.utils.smp_utils.dataframe_to_smp">dataframe_to_smp</a></li>
<li><a class="reference internal" href="#pyemu.utils.smp_utils.smp_to_dataframe">smp_to_dataframe</a></li>
<li><a class="reference internal" href="#pyemu.utils.smp_utils.smp_to_ins">smp_to_ins</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyEMU</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>pyemu.utils package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pyemu.utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pyemu-utils-package">
<h1>pyemu.utils package<a class="headerlink" href="#pyemu-utils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyemu.utils.geostats">
<span id="pyemu-utils-geostats-module"></span><h2>pyemu.utils.geostats module<a class="headerlink" href="#module-pyemu.utils.geostats" title="Permalink to this headline">¶</a></h2>
<p>Geostatistics in the PEST(++) realm</p>
<dl class="py class">
<dt id="pyemu.utils.geostats.ExpVario">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">ExpVario</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contribution</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">anisotropy</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">bearing</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'var1'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.ExpVario" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.utils.geostats.Vario2d" title="pyemu.utils.geostats.Vario2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.utils.geostats.Vario2d</span></code></a></p>
<p>Gaussian variogram derived type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contribution</strong> (<em>float</em>) – sill of the variogram</p></li>
<li><p><strong>a</strong> (<cite>float</cite>) – (practical) range of correlation</p></li>
<li><p><strong>anisotropy</strong> (<cite>float</cite>, optional) – Anisotropy ratio. Default is 1.0</p></li>
<li><p><strong>bearing</strong> – (<cite>float</cite>, optional): angle in degrees East of North corresponding
to anisotropy ellipse. Default is 0.0</p></li>
<li><p><strong>name</strong> (<cite>str</cite>, optinoal) – name of the variogram.  Default is “var1”</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">ExpVario</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">contribution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="pyemu.utils.geostats.GauVario">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">GauVario</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contribution</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">anisotropy</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">bearing</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'var1'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.GauVario" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.utils.geostats.Vario2d" title="pyemu.utils.geostats.Vario2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.utils.geostats.Vario2d</span></code></a></p>
<p>Gaussian variogram derived type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contribution</strong> (<em>float</em>) – sill of the variogram</p></li>
<li><p><strong>a</strong> (<cite>float</cite>) – (practical) range of correlation</p></li>
<li><p><strong>anisotropy</strong> (<cite>float</cite>, optional) – Anisotropy ratio. Default is 1.0</p></li>
<li><p><strong>bearing</strong> – (<cite>float</cite>, optional): angle in degrees East of North corresponding
to anisotropy ellipse. Default is 0.0</p></li>
<li><p><strong>name</strong> (<cite>str</cite>, optinoal) – name of the variogram.  Default is “var1”</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">GauVario</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">contribution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the Gaussian variogram can be unstable (not invertible) for long ranges.</p>
</div>
</dd></dl>

<dl class="py class">
<dt id="pyemu.utils.geostats.GeoStruct">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">GeoStruct</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nugget</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">variograms</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'struct1'</span></em>, <em class="sig-param"><span class="n">transform</span><span class="o">=</span><span class="default_value">'none'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>a geostatistical structure object that mimics the behavior of a PEST
geostatistical structure.  The object contains variogram instances and
(optionally) nugget information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nugget</strong> (<cite>float</cite> (optional)) – nugget contribution. Default is 0.0</p></li>
<li><p><strong>variograms</strong> – ([<cite>pyemu.Vario2d</cite>] (optional)): variogram(s) associated
with this GeoStruct instance. Default is empty list</p></li>
<li><p><strong>name</strong> (<cite>str</cite> (optional)) – name to assign the structure.  Default
is “struct1”.</p></li>
<li><p><strong>transform</strong> (<cite>str</cite> (optional)) – the transformation to apply to
the GeoStruct.  Can be “none” or “log”, depending on the
transformation of the property being represented by the <cite>GeoStruct</cite>.
Default is “none”</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">ExpVario</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">contribution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">GeoStruct</span><span class="p">(</span><span class="n">variograms</span><span class="o">=</span><span class="n">v</span><span class="p">,</span><span class="n">nugget</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.utils.geostats.GeoStruct.covariance">
<code class="sig-name descname">covariance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pt0</span></em>, <em class="sig-param"><span class="n">pt1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>get the covariance between two points implied by the <cite>GeoStruct</cite>.
This is used during the ordinary kriging process to get the RHS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pt0</strong> ([<cite>float</cite>]) – xy-pair</p></li>
<li><p><strong>pt1</strong> ([<cite>float</cite>]) – xy-pair</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the covariance between pt0 and pt1 implied
by the GeoStruct</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.GeoStruct.covariance_matrix">
<code class="sig-name descname">covariance_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>build a <cite>pyemu.Cov</cite> instance from <cite>GeoStruct</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> ([<cite>floats</cite>]) – x-coordinate locations</p></li>
<li><p><strong>y</strong> ([<cite>float</cite>]) – y-coordinate locations</p></li>
<li><p><strong>names</strong> ([<cite>str</cite>] (optional)) – names of location. If None,
cov must not be None.  Default is None.</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – an existing Cov instance.  The contribution
of this GeoStruct is added to cov.  If cov is None,
names must not be None. Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the covariance matrix implied by this
GeoStruct for the x,y pairs. <cite>cov</cite> has row and column
names supplied by the names argument unless the “cov”
argument was passed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>either “names” or “cov” must be passed.  If “cov” is passed, cov.shape
must equal len(x) and len(y).</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pp_df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">pp_utils</span><span class="o">.</span><span class="n">pp_file_to_dataframe</span><span class="p">(</span><span class="s2">&quot;hkpp.dat&quot;</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">(</span><span class="n">pp_df</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pp_df</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pp_df</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="n">cov</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s2">&quot;cov.jcb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.GeoStruct.covariance_points">
<code class="sig-name descname">covariance_points</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">y0</span></em>, <em class="sig-param"><span class="n">xother</span></em>, <em class="sig-param"><span class="n">yother</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.covariance_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the covariance between point (x0,y0) and the points
contained in xother, yother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<cite>float</cite>) – x-coordinate</p></li>
<li><p><strong>y0</strong> (<cite>float</cite>) – y-coordinate</p></li>
<li><p><strong>xother</strong> ([<cite>float</cite>]) – x-coordinates of other points</p></li>
<li><p><strong>yother</strong> ([<cite>float</cite>]) – y-coordinates of other points</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a 1-D array of covariance between point x0,y0 and the
points contained in xother, yother.  len(cov) = len(xother) =
len(yother)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.geostats.GeoStruct.nugget">
<code class="sig-name descname">nugget</code><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.nugget" title="Permalink to this definition">¶</a></dt>
<dd><p>the nugget effect contribution</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.GeoStruct.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>make a cheap plot of the <cite>GeoStruct</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – (dict)
keyword arguments to use for plotting.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the axis with the GeoStruct plot</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>matplotlib.pyplot.axis</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>optional arguments include “ax” (an existing axis),
“individuals” (plot each variogram on a separate axis),
“legend” (add a legend to the plot(s)).  All other kwargs
are passed to matplotlib.pyplot.plot()</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.GeoStruct.same_as_other">
<code class="sig-name descname">same_as_other</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.same_as_other" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.GeoStruct.sill">
<em class="property">property </em><code class="sig-name descname">sill</code><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.sill" title="Permalink to this definition">¶</a></dt>
<dd><p>get the sill of the <cite>GeoStruct</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the sill of the (nested) <cite>GeoStruct</cite>, including
nugget and contribution from each variogram</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.GeoStruct.to_struct_file">
<code class="sig-name descname">to_struct_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.to_struct_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a PEST-style structure file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<cite>str</cite>) – file to write the GeoStruct information in to.  Can
also be an open file handle</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.geostats.GeoStruct.transform">
<code class="sig-name descname">transform</code><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>the transformation of the <cite>GeoStruct</cite>.  Can be ‘log’ or ‘none’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.geostats.GeoStruct.variograms">
<code class="sig-name descname">variograms</code><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.variograms" title="Permalink to this definition">¶</a></dt>
<dd><p>a list of variogram instances</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>[<cite>pyemu.utils.geostats.Vario2d</cite>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.utils.geostats.OrdinaryKrige">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">OrdinaryKrige</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">geostruct</span></em>, <em class="sig-param"><span class="n">point_data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Ordinary Kriging using Pandas and Numpy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geostruct</strong> (<cite>GeoStruct</cite>) – a pyemu.geostats.GeoStruct to use for the kriging</p></li>
<li><p><strong>point_data</strong> (<cite>pandas.DataFrame</cite>) – the conditioning points to use for kriging.
<cite>point_data</cite> must contain columns “name”, “x”, “y”.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if <cite>point_data</cite> is an <cite>str</cite>, then it is assumed to be a pilot points file
and is loaded as such using <cite>pyemu.pp_utils.pp_file_to_dataframe()</cite></p>
<p>If zoned interpolation is used for grid-based interpolation, then
<cite>point_data</cite> must also contain a “zone” column</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyemu</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">ExpVario</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">contribution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">GeoStruct</span><span class="p">(</span><span class="n">variograms</span><span class="o">=</span><span class="n">v</span><span class="p">,</span><span class="n">nugget</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">pp_df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">pp_utils</span><span class="o">.</span><span class="n">pp_file_to_dataframe</span><span class="p">(</span><span class="s2">&quot;hkpp.dat&quot;</span><span class="p">)</span>
<span class="n">ok</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">OrdinaryKrige</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="n">pp_df</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.utils.geostats.OrdinaryKrige.calc_factors">
<code class="sig-name descname">calc_factors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">minpts_interp</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">maxpts_interp</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">search_radius</span><span class="o">=</span><span class="default_value">10000000000.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pt_zone</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">forgive</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_threads</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige.calc_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate ordinary kriging factors (weights) for the points
represented by arguments x and y</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> ([<cite>float</cite>]) – x-coordinates to calculate kriging factors for</p></li>
<li><p><strong>y</strong> (([<cite>float</cite>]) – y-coordinates to calculate kriging factors for</p></li>
<li><p><strong>minpts_interp</strong> (<cite>int</cite>) – minimum number of point_data entires to use for interpolation at
a given x,y interplation point.  interpolation points with less
than <cite>minpts_interp</cite> <cite>point_data</cite> found will be skipped
(assigned np.NaN).  Defaut is 1</p></li>
<li><p><strong>maxpts_interp</strong> (<cite>int</cite>) – maximum number of point_data entries to use for interpolation at
a given x,y interpolation point.  A larger <cite>maxpts_interp</cite> will
yield “smoother” interplation, but using a large <cite>maxpts_interp</cite>
will slow the (already) slow kriging solution process and may
lead to memory errors. Default is 20.</p></li>
<li><p><strong>search_radius</strong> (<cite>float</cite>) – the size of the region around a given x,y
interpolation point to search for <cite>point_data</cite> entries. Default is 1.0e+10</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – a flag to  echo process to stdout during the interpolatino process.
Default is False</p></li>
<li><p><strong>forgive</strong> (<cite>bool</cite>) – flag to continue if inversion of the kriging matrix failes at one or more
interpolation points.  Inversion usually fails if the kriging matrix is singular,
resulting from <cite>point_data</cite> entries closer than EPSILON distance.  If True,
warnings are issued for each failed inversion.  If False, an exception
is raised for failed matrix inversion.</p></li>
<li><p><strong>num_threads</strong> (<cite>int</cite>) – number of multiprocessing workers to use to try to speed up
kriging in python.  Default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with information summarizing the ordinary kriging
process for each interpolation points</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this method calls either <cite>OrdinaryKrige.calc_factors_org()</cite> or
<cite>OrdinaryKrige.calc_factors_mp()</cite> depending on the value of <cite>num_threads</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.OrdinaryKrige.calc_factors_grid">
<code class="sig-name descname">calc_factors_grid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spatial_reference</span></em>, <em class="sig-param"><span class="n">zone_array</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">minpts_interp</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">maxpts_interp</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">search_radius</span><span class="o">=</span><span class="default_value">10000000000.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">var_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">forgive</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_threads</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige.calc_factors_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate kriging factors (weights) for a structured grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_reference</strong> (<cite>flopy.utils.reference.SpatialReference</cite>) – a spatial
reference that describes the orientation and
spatail projection of the the structured grid</p></li>
<li><p><strong>zone_array</strong> (<cite>numpy.ndarray</cite>) – an integer array of zones to use for kriging.
If not None, then <cite>point_data</cite> must also contain a “zone” column.  <cite>point_data</cite>
entries with a zone value not found in zone_array will be skipped.
If None, then all <cite>point_data</cite> will (potentially) be used for
interpolating each grid node. Default is None</p></li>
<li><p><strong>minpts_interp</strong> (<cite>int</cite>) – minimum number of <cite>point_data</cite> entires to use for interpolation at
a given grid node.  grid nodes with less than <cite>minpts_interp</cite>
<cite>point_data</cite> found will be skipped (assigned np.NaN).  Defaut is 1</p></li>
<li><p><strong>maxpts_interp</strong> (<cite>int</cite>) – a given grid node.  A larger <cite>maxpts_interp</cite> will yield “smoother”
interplation, but using a large <cite>maxpts_interp</cite> will slow the
(already) slow kriging solution process and may lead to
memory errors. Default is 20.</p></li>
<li><p><strong>search_radius</strong> (<cite>float</cite>) – <cite>point_data</cite> entries. Default is 1.0e+10</p></li>
<li><p><strong>verbose</strong> – (<cite>bool</cite>): a flag to  echo process to stdout during the interpolatino process.
Default is False</p></li>
<li><p><strong>var_filename</strong> (<cite>str</cite>) – a filename to save the kriging variance for each interpolated grid node.
Default is None.</p></li>
<li><p><strong>forgive</strong> (<cite>bool</cite>) – flag to continue if inversion of the kriging matrix failes at one or more
grid nodes.  Inversion usually fails if the kriging matrix is singular,
resulting from <cite>point_data</cite> entries closer than EPSILON distance.  If True,
warnings are issued for each failed inversion.  If False, an exception
is raised for failed matrix inversion.</p></li>
<li><p><strong>num_threads</strong> (<cite>int</cite>) – number of multiprocessing workers to use to try to speed up
kriging in python.  Default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with information summarizing the ordinary kriging
process for each grid node</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this method calls OrdinaryKrige.calc_factors()</p>
<p>this method is the main entry point for grid-based kriging factor generation</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flopy</span>

<span class="kn">import</span> <span class="nn">pyemu</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">ExpVario</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">contribution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">GeoStruct</span><span class="p">(</span><span class="n">variograms</span><span class="o">=</span><span class="n">v</span><span class="p">,</span><span class="n">nugget</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">pp_df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">pp_utils</span><span class="o">.</span><span class="n">pp_file_to_dataframe</span><span class="p">(</span><span class="s2">&quot;hkpp.dat&quot;</span><span class="p">)</span>
<span class="n">ok</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">OrdinaryKrige</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="n">pp_df</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;mymodel.nam&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ok</span><span class="o">.</span><span class="n">calc_factors_grid</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span><span class="n">zone_array</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">bas6</span><span class="o">.</span><span class="n">ibound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
                          <span class="n">var_filename</span><span class="o">=</span><span class="s2">&quot;ok_var.dat&quot;</span><span class="p">)</span>
<span class="n">ok</span><span class="o">.</span><span class="n">to_grid_factor_file</span><span class="p">(</span><span class="s2">&quot;factors.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.OrdinaryKrige.check_point_data_dist">
<code class="sig-name descname">check_point_data_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rectify</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige.check_point_data_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>check for point_data entries that are closer than
EPSILON distance - this will cause a singular kriging matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rectify</strong> (<cite>bool</cite>) – flag to fix the problems with point_data
by dropping additional points that are
closer than EPSILON distance.  Default is False</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this method will issue warnings for points that are closer
than EPSILON distance</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.OrdinaryKrige.to_grid_factors_file">
<code class="sig-name descname">to_grid_factors_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">points_file</span><span class="o">=</span><span class="default_value">'points.junk'</span></em>, <em class="sig-param"><span class="n">zone_file</span><span class="o">=</span><span class="default_value">'zone.junk'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige.to_grid_factors_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a grid-based PEST-style factors file.  This file can be used with
the fac2real() method to write an interpolated structured array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – factor filename</p></li>
<li><p><strong>points_file</strong> (<cite>str</cite>) – points filename to add to the header of the factors file.
This is not used by the fac2real() method.  Default is “points.junk”</p></li>
<li><p><strong>zone_file</strong> (<cite>str</cite>) – zone filename to add to the header of the factors file.
This is notused by the fac2real() method.  Default is “zone.junk”</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this method should be called after OrdinaryKirge.calc_factors_grid()</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.utils.geostats.SpecSim2d">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">SpecSim2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delx</span></em>, <em class="sig-param"><span class="n">dely</span></em>, <em class="sig-param"><span class="n">geostruct</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.SpecSim2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>2-D unconditional spectral simulation for regular grids</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delx</strong> (<cite>numpy.ndarray</cite>) – a 1-D array of x-dimension cell centers
(or leading/trailing edges).  Only the distance between points
is important</p></li>
<li><p><strong>dely</strong> (<cite>numpy.ndarray</cite>) – a 1-D array of y-dimension cell centers
(or leading/trailing edges).  Only the distance between points
is important</p></li>
<li><p><strong>geostruct</strong> (<cite>pyemu.geostats.Geostruct</cite>) – geostatistical structure instance</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">ExpVario</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">contribution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">GeoStruct</span><span class="p">(</span><span class="n">variograms</span><span class="o">=</span><span class="n">v</span><span class="p">,</span><span class="n">nugget</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">delx</span><span class="p">,</span><span class="n">dely</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arrange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">SpecSim2d</span><span class="p">(</span><span class="n">delx</span><span class="p">,</span><span class="n">dely</span><span class="p">,</span><span class="n">gs</span><span class="p">)</span>
<span class="n">arrays</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">num_reals</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyemu.utils.geostats.SpecSim2d.draw_arrays">
<code class="sig-name descname">draw_arrays</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">mean_value</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.SpecSim2d.draw_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>draw realizations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of realizations to generate</p></li>
<li><p><strong>mean_value</strong> (<cite>float</cite>) – the mean value of the realizations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a 3-D array of realizations.  Shape
is (num_reals,self.dely.shape[0],self.delx.shape[0])</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>log transformation is respected and the returned <cite>reals</cite> array is
in arithmatic space</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.SpecSim2d.draw_conditional">
<code class="sig-name descname">draw_conditional</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span></em>, <em class="sig-param"><span class="n">obs_points</span></em>, <em class="sig-param"><span class="n">sg</span></em>, <em class="sig-param"><span class="n">base_values_file</span></em>, <em class="sig-param"><span class="n">local</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">factors_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">mean_value</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">R_factor</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.SpecSim2d.draw_conditional" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Generate a conditional, correlated random field using the Spec2dSim</dt><dd><p>object, a set of observation points, and a factors file.</p>
<p>The conditional field is made by generating an unconditional correlated random
field that captures the covariance in the variogram and conditioning it by kriging
a second surface using the value of the random field as observations.
This second conditioning surface provides an estimate of uncertainty (kriging error)
away from the observation points. At the observation points, the kriged surface is
equal to (less nugget effects) the observation. The conditioned correlated field
is then generated using: T(x) = Z(x) + [S(x) − S∗(x)]
where T(x) is the conditioned simulation, Z(x) is a kriging estimator of the
unknown field, S(x) is an unconditioned random field with the same covariance
structure as the desired field, and S∗(x) is a kriging estimate of the unconditioned
random field using its values at the observation points (pilot points).
[S(x) − S∗(x)] is an estimate of the kriging error.</p>
<p>This approach makes T(x) match the observed values at the observation points
(x_a, y_z), T(a) = Z(a), and have a structure away from the observation points that
follows the variogram used to generate Z, S, and S∗.</p>
<dl class="simple">
<dt>Chiles, J-P, and Delfiner, P., Geostatistics- Modeling Spatial Uncertainty: Wiley,</dt><dd><p>London, 695 p.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<cite>int</cite>) – integer used for random seed.  If seed is used as a PEST parameter,
then passing the same value for seed will yield the same
conditioned random fields. This allows runs to be recreated
given an ensemble of seeds.</p></li>
<li><p><strong>obs_points</strong> (<cite>str</cite> or <cite>dataframe</cite>) – locations for observation points.
Either filename in pyemupilot point file format:
[“name”,”x”,”y”,”zone”,”parval1”] ora dataframe with these columns.
Note that parval1 is not used.</p></li>
<li><p><strong>base_values_file</strong> (<cite>str</cite>) – filename containing 2d array with the base
parameter values from which the random field will depart (Z(x)) above.
Values of Z(x) are used for conditioning, not parval1 in the
observation point file.</p></li>
<li><p><strong>factors_file</strong> (<cite>str</cite>) – name of the factors file generated using the
locations of the observation points and the target grid.
If None this file will be generated and called conditional_factors.dat;
but this is a slow step and should not generally be called for every simulation.</p></li>
<li><p><strong>sg</strong> – flopy StructuredGrid object</p></li>
<li><p><strong>local</strong> (<cite>boolean</cite>) – whether coordinates in obs_points are in local (model) or map coordinates</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of realizations to generate</p></li>
<li><p><strong>mean_value</strong> (<cite>float</cite>) – the mean value of the realizations</p></li>
<li><p><strong>R_factor</strong> (<cite>float</cite>) – a factor to scale the field, sometimes the variation from the
geostruct parameters is larger or smaller than desired.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 3-D array of realizations.  Shape is</dt><dd><p>(num_reals, self.dely.shape[0], self.delx.shape[0])</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>log transformation is respected and the returned <cite>reals</cite></dt><dd><p>array is in arithmetic space</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.SpecSim2d.grid_is_regular">
<em class="property">static </em><code class="sig-name descname">grid_is_regular</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delx</span></em>, <em class="sig-param"><span class="n">dely</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.0001</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.SpecSim2d.grid_is_regular" title="Permalink to this definition">¶</a></dt>
<dd><p>check that a grid is regular using delx and dely vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delx</strong> – <cite>numpy.ndarray</cite>
a 1-D array of x-dimension cell centers (or leading/trailing edges).  Only the
distance between points is important</p></li>
<li><p><strong>dely</strong> – <cite>numpy.ndarray</cite>
a 1-D array of y-dimension cell centers (or leading/trailing edges).  Only the
distance between points is important</p></li>
<li><p><strong>tol</strong> – <cite>float</cite> (optional)
tolerance to determine grid regularity.  Default is 1.0e-4</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flag indicating if the grid defined by <cite>delx</cite> and <cite>dely</cite> is regular</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.SpecSim2d.grid_par_ensemble_helper">
<code class="sig-name descname">grid_par_ensemble_helper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">gr_df</span></em>, <em class="sig-param"><span class="n">num_reals</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">logger</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.SpecSim2d.grid_par_ensemble_helper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>wrapper around <cite>SpecSim2d.draw()</cite> designed to support <cite>pyemu.PstFromFlopy</cite></dt><dd><p>grid-based parameters</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance</p></li>
<li><p><strong>gr_df</strong> (<cite>pandas.DataFrame</cite>) – a dataframe listing <cite>parval1</cite>,
<cite>pargp</cite>, <cite>i</cite>, <cite>j</cite> for each grid based parameter</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of realizations to generate</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite> (optional)) – number of standard deviations
implied by parameter bounds in control file. Default is 6</p></li>
<li><p><strong>logger</strong> (<cite>pyemu.Logger</cite> (optional)) – a logger instance for logging</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an untransformed parameter ensemble of
realized grid-parameter values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.ParameterEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the method processes each unique <cite>pargp</cite> value in <cite>gr_df</cite> and resets the sill of <cite>self.geostruct</cite> by
the maximum bounds-implied variance of each <cite>pargp</cite>.  This method makes repeated calls to
<cite>self.initialize()</cite> to deal with the geostruct changes.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.SpecSim2d.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.SpecSim2d.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare for spectral simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>initialize()</cite> prepares for simulation by undertaking
the fast FFT on the wave number matrix and should be called
if the <cite>SpecSim2d.geostruct</cite> is changed.</p>
<p>This method is called by the constructor.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.utils.geostats.SphVario">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">SphVario</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contribution</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">anisotropy</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">bearing</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'var1'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.SphVario" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.utils.geostats.Vario2d" title="pyemu.utils.geostats.Vario2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.utils.geostats.Vario2d</span></code></a></p>
<p>Spherical variogram derived type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contribution</strong> (<em>float</em>) – sill of the variogram</p></li>
<li><p><strong>a</strong> (<cite>float</cite>) – (practical) range of correlation</p></li>
<li><p><strong>anisotropy</strong> (<cite>float</cite>, optional) – Anisotropy ratio. Default is 1.0</p></li>
<li><p><strong>bearing</strong> – (<cite>float</cite>, optional): angle in degrees East of North corresponding
to anisotropy ellipse. Default is 0.0</p></li>
<li><p><strong>name</strong> – name of the variogram.  Default is “var1”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="pyemu.utils.geostats.Vario2d">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">Vario2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contribution</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">anisotropy</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">bearing</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'var1'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.Vario2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>base class for 2-D variograms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contribution</strong> (<em>float</em>) – sill of the variogram</p></li>
<li><p><strong>a</strong> (<cite>float</cite>) – (practical) range of correlation</p></li>
<li><p><strong>anisotropy</strong> (<cite>float</cite>, optional) – Anisotropy ratio. Default is 1.0</p></li>
<li><p><strong>bearing</strong> – (<cite>float</cite>, optional): angle in degrees East of North corresponding
to anisotropy ellipse. Default is 0.0</p></li>
<li><p><strong>name</strong> (<cite>str</cite>, optinoal) – name of the variogram.  Default is “var1”</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This base class should not be instantiated directly as it does not implement
an h_function() method.</p>
</div>
<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.bearing_rads">
<em class="property">property </em><code class="sig-name descname">bearing_rads</code><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.bearing_rads" title="Permalink to this definition">¶</a></dt>
<dd><p>get the bearing of the Vario2d in radians</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the Vario2d bearing in radians</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.covariance">
<code class="sig-name descname">covariance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pt0</span></em>, <em class="sig-param"><span class="n">pt1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>get the covarince between two points implied by Vario2d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pt0</strong> – ([<cite>float</cite>]): first point x and y</p></li>
<li><p><strong>pt1</strong> – ([<cite>float</cite>]): second point x and y</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>covariance between pt0 and pt1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.covariance_matrix">
<code class="sig-name descname">covariance_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cov</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>build a pyemu.Cov instance implied by Vario2d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> ([<cite>float</cite>]) – x-coordinate locations</p></li>
<li><p><strong>y</strong> ([<cite>float</cite>]) – y-coordinate locations</p></li>
<li><p><strong>names</strong> ([<cite>str</cite>]) – names of locations. If None, cov must not be None</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – an existing Cov instance.  Vario2d contribution is added to cov</p></li>
<li><p><strong>place</strong> (<em>in</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the covariance matrix for <cite>x</cite>, <cite>y</cite> implied by <cite>Vario2d</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>either <cite>names</cite> or <cite>cov</cite> must not be None.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.covariance_points">
<code class="sig-name descname">covariance_points</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">y0</span></em>, <em class="sig-param"><span class="n">xother</span></em>, <em class="sig-param"><span class="n">yother</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.covariance_points" title="Permalink to this definition">¶</a></dt>
<dd><p>get the covariance between base point (x0,y0) and
other points xother,yother implied by <cite>Vario2d</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<cite>float</cite>) – x-coordinate</p></li>
<li><p><strong>y0</strong> (<cite>float</cite>) – y-coordinate</p></li>
<li><p><strong>xother</strong> ([<cite>float</cite>]) – x-coordinates of other points</p></li>
<li><p><strong>yother</strong> ([<cite>float</cite>]) – y-coordinates of other points</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a 1-D array of covariance between point x0,y0 and the
points contained in xother, yother.  len(cov) = len(xother) =
len(yother)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.inv_h">
<code class="sig-name descname">inv_h</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.inv_h" title="Permalink to this definition">¶</a></dt>
<dd><p>the inverse of the h_function.  Used for plotting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>h</strong> (<cite>float</cite>) – the value of h_function to invert</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the inverse of h</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>get a cheap plot of the Vario2d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<cite>dict</cite>) – keyword arguments to use for plotting</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>matplotlib.pyplot.axis</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>optional arguments in kwargs include
“ax” (existing <cite>matplotlib.pyplot.axis</cite>).  Other
kwargs are passed to <cite>matplotlib.pyplot.plot()</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.rotation_coefs">
<em class="property">property </em><code class="sig-name descname">rotation_coefs</code><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.rotation_coefs" title="Permalink to this definition">¶</a></dt>
<dd><p>get the rotation coefficents in radians</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the rotation coefficients implied by <cite>Vario2d.bearing</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<cite>float</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.same_as_other">
<code class="sig-name descname">same_as_other</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.same_as_other" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.geostats.Vario2d.to_struct_file">
<code class="sig-name descname">to_struct_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.to_struct_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write the <cite>Vario2d</cite> to a PEST-style structure file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<cite>str</cite>) – filename to write to.  <cite>f</cite> can also be an open
file handle.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.geostats.fac2real">
<code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">fac2real</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pp_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">factors_file</span><span class="o">=</span><span class="default_value">'factors.dat'</span></em>, <em class="sig-param"><span class="n">out_file</span><span class="o">=</span><span class="default_value">'test.ref'</span></em>, <em class="sig-param"><span class="n">upper_lim</span><span class="o">=</span><span class="default_value">1e+30</span></em>, <em class="sig-param"><span class="n">lower_lim</span><span class="o">=</span><span class="default_value">- 1e+30</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">1e+30</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.fac2real" title="Permalink to this definition">¶</a></dt>
<dd><p>A python replication of the PEST fac2real utility for creating a
structure grid array from previously calculated kriging factors (weights)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pp_file</strong> (<cite>str</cite>) – PEST-type pilot points file</p></li>
<li><p><strong>factors_file</strong> (<cite>str</cite>) – PEST-style factors file</p></li>
<li><p><strong>out_file</strong> (<cite>str</cite>) – filename of array to write.  If None, array is returned, else
value of out_file is returned.  Default is “test.ref”.</p></li>
<li><p><strong>upper_lim</strong> (<cite>float</cite>) – maximum interpolated value in the array.  Values greater than
<cite>upper_lim</cite> are set to fill_value</p></li>
<li><p><strong>lower_lim</strong> (<cite>float</cite>) – minimum interpolated value in the array.  Values less than
<cite>lower_lim</cite> are set to fill_value</p></li>
<li><p><strong>fill_value</strong> (<cite>float</cite>) – the value to assign array nodes that are not interpolated</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>if out_file is None</p>
<p><cite>str</cite>: if out_file it not None</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">fac2real</span><span class="p">(</span><span class="s2">&quot;hkpp.dat&quot;</span><span class="p">,</span><span class="n">out_file</span><span class="o">=</span><span class="s2">&quot;hk_layer_1.ref&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.geostats.gslib_2_dataframe">
<code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">gslib_2_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">attr_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_idx</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">y_idx</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.gslib_2_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>function to read a GSLIB point data file into a pandas.DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – GSLIB file</p></li>
<li><p><strong>attr_name</strong> (<cite>str</cite>) – the column name in the dataframe for the attribute.
If None, GSLIB file can have only 3 columns.  <cite>attr_name</cite> must be in
the GSLIB file header</p></li>
<li><p><strong>x_idx</strong> (<cite>int</cite>) – the index of the x-coordinate information in the GSLIB file. Default is
0 (first column)</p></li>
<li><p><strong>y_idx</strong> (<cite>int</cite>) – the index of the y-coordinate information in the GSLIB file.
Default is 1 (second column)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe of info from the GSLIB file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>assigns generic point names (“pt0, pt1, etc)</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utiils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">gslib_2_dataframe</span><span class="p">(</span><span class="s2">&quot;prop.gslib&quot;</span><span class="p">,</span><span class="n">attr_name</span><span class="o">=</span><span class="s2">&quot;hk&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.geostats.load_sgems_exp_var">
<code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">load_sgems_exp_var</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.load_sgems_exp_var" title="Permalink to this definition">¶</a></dt>
<dd><p>read an SGEM experimental variogram into a sequence of
pandas.DataFrames</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – an SGEMS experimental variogram XML file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of pandas.DataFrames of x, y, pairs for each
division in the experimental variogram</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<cite>pandas.DataFrame</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.geostats.read_sgems_variogram_xml">
<code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">read_sgems_variogram_xml</code><span class="sig-paren">(</span><em class="sig-param">xml_file</em>, <em class="sig-param">return_type=&lt;class 'pyemu.utils.geostats.GeoStruct'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.read_sgems_variogram_xml" title="Permalink to this definition">¶</a></dt>
<dd><p>function to read an SGEMS-type variogram XML file into
a <cite>GeoStruct</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xml_file</strong> (<cite>str</cite>) – SGEMS variogram XML file</p></li>
<li><p><strong>return_type</strong> (<cite>object</cite>) – the instance type to return.  Default is <cite>GeoStruct</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>GeoStruct</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gs</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">read_sgems_variogram_xml</span><span class="p">(</span><span class="s2">&quot;sgems.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.geostats.read_struct_file">
<code class="sig-prename descclassname">pyemu.utils.geostats.</code><code class="sig-name descname">read_struct_file</code><span class="sig-paren">(</span><em class="sig-param">struct_file</em>, <em class="sig-param">return_type=&lt;class 'pyemu.utils.geostats.GeoStruct'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.geostats.read_struct_file" title="Permalink to this definition">¶</a></dt>
<dd><p>read an existing PEST-type structure file into a GeoStruct instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struct_file</strong> (<cite>str</cite>) – existing pest-type structure file</p></li>
<li><p><strong>return_type</strong> (<cite>object</cite>) – the instance type to return.  Default is GeoStruct</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of <cite>GeoStruct</cite> instances.  If
only one <cite>GeoStruct</cite> is in the file, then a <cite>GeoStruct</cite> is returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<cite>pyemu.GeoStruct</cite>]</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">geostats</span><span class="o">.</span><span class="n">reads_struct_file</span><span class="p">(</span><span class="s2">&quot;struct.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.gw_utils">
<span id="pyemu-utils-gw-utils-module"></span><h2>pyemu.utils.gw_utils module<a class="headerlink" href="#module-pyemu.utils.gw_utils" title="Permalink to this headline">¶</a></h2>
<p>MODFLOW support utilities</p>
<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_gage_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_gage_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">return_obs_file</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_gage_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the modflow gage obs post-processor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>return_obs_file</strong> (<cite>bool</cite>) – flag to return the processed
observation file.  Default is <cite>False</cite>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the companion function of <cite>gw_utils.setup_gage_obs()</cite></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_hds_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_hds_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hds_file</span></em>, <em class="sig-param"><span class="n">inact_abs_val</span><span class="o">=</span><span class="default_value">1e+20</span></em>, <em class="sig-param"><span class="n">precision</span><span class="o">=</span><span class="default_value">'single'</span></em>, <em class="sig-param"><span class="n">text</span><span class="o">=</span><span class="default_value">'head'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_hds_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>process a modflow head save file.  A companion function to
<cite>gw_utils.setup_hds_obs()</cite> that is called during the forward run process</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hds_file</strong> (<cite>str</cite>) – a modflow head save filename. if hds_file ends with ‘ucn’,
then the file is treated as a UcnFile type.</p></li>
<li><p><strong>inact_abs_val</strong> (<cite>float</cite>, optional) – the value that marks the mininum and maximum
active value.  values in the headsave file greater than <cite>inact_abs_val</cite> or less
than -<cite>inact_abs_val</cite> are reset to <cite>inact_abs_val</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with extracted simulated values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the companion function to <cite>gw_utils.setup_hds_obs()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_hds_timeseries">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_hds_timeseries</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">postprocess_inact</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_hds_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>process a modflow binary file using a previously written
configuration file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_file</strong> (<cite>str</cite>, optional) – configuration file written by <cite>pyemu.gw_utils.setup_hds_timeseries</cite>.
If <cite>None</cite>, looks for <cite>hds_timeseries.config</cite></p></li>
<li><p><strong>postprocess_inact</strong> (<cite>float</cite>, optional) – Inactive value in heads/ucn file e.g. mt.btn.cinit.  If <cite>None</cite>, no
inactive value processing happens.  Default is <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this is the companion function of <cite>gw_utils.setup_hds_timeseries()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_hfb_pars">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_hfb_pars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_file</span><span class="o">=</span><span class="default_value">'hfb6_pars.csv'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_hfb_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to apply HFB multiplier parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>par_file</strong> (<cite>str</cite>) – the HFB parameter info file.
Default is <cite>hfb_pars.csv</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the companion function to
<cite>gw_utils.write_hfb_zone_multipliers_template()</cite></p>
<p>This is to account for the horrible HFB6 format that differs from other
BCs making this a special case</p>
<p>Requires “hfb_pars.csv”</p>
<p>Should be added to the forward_run.py script</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_mflist_budget_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_mflist_budget_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_filename</span></em>, <em class="sig-param"><span class="n">flx_filename</span><span class="o">=</span><span class="default_value">'flux.dat'</span></em>, <em class="sig-param"><span class="n">vol_filename</span><span class="o">=</span><span class="default_value">'vol.dat'</span></em>, <em class="sig-param"><span class="n">start_datetime</span><span class="o">=</span><span class="default_value">'1-1-1970'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_mflist_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>process a MODFLOW list file to extract flux and volume water budget entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_filename</strong> (<cite>str</cite>) – path and name of the existing modflow list file</p></li>
<li><p><strong>flx_filename</strong> (<cite>str</cite>, optional) – output filename that will contain the budget flux
observations. Default is “flux.dat”</p></li>
<li><p><strong>vol_filename</strong> (<cite>str</cite>, optional) – output filename that will contain the budget volume
observations.  Default is “vol.dat”</p></li>
<li><p><strong>start_datetime</strong> (<cite>str</cite>, optional) – a string that can be parsed into a pandas.TimeStamp.
This is used to give budget observations meaningful names.  Default is “1-1-1970”.</p></li>
<li><p><strong>prefix</strong> (<cite>str</cite>, optional) – a prefix to add to the water budget observations.  Useful if
processing more than one list file as part of the forward run process. Default is ‘’.</p></li>
<li><p><strong>save_setup_file</strong> – a flag to save _setup_&lt;list_filename&gt;.csv file that contains useful
control file information</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_mtlist_budget_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_mtlist_budget_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_filename</span></em>, <em class="sig-param"><span class="n">gw_filename</span><span class="o">=</span><span class="default_value">'mtlist_gw.dat'</span></em>, <em class="sig-param"><span class="n">sw_filename</span><span class="o">=</span><span class="default_value">'mtlist_sw.dat'</span></em>, <em class="sig-param"><span class="n">start_datetime</span><span class="o">=</span><span class="default_value">'1-1-1970'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_mtlist_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>process an MT3D-USGS list file to extract mass budget entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_filename</strong> (<cite>str</cite>) – the path and name of an existing MT3D-USGS list file</p></li>
<li><p><strong>gw_filename</strong> (<cite>str</cite>, optional) – the name of the output file with gw mass
budget information. Default is “mtlist_gw.dat”</p></li>
<li><p><strong>sw_filename</strong> (<cite>str</cite>) – the name of the output file with sw mass budget information.
Default is “mtlist_sw.dat”</p></li>
<li><p><strong>start_datatime</strong> (<cite>str</cite>) – an str that can be cast to a pandas.TimeStamp.  Used to give
observations a meaningful name</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>2-element tuple containing</p>
<ul class="simple">
<li><p><strong>pandas.DataFrame</strong>: the gw mass budget dataframe</p></li>
<li><p><strong>pandas.DataFrame</strong>: (optional) the sw mass budget dataframe.
If the SFT process is not active, this returned value is <cite>None</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this is the companion function of <cite>gw_utils.setup_mtlist_budget_obs()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_sfr_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_sfr_obs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sfr_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the sfr observation process</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the companion function of <cite>gw_utils.setup_sfr_obs()</cite>.</p>
<p>requires <cite>sfr_obs.config</cite>.</p>
<p>Writes <cite>sfr_out_file`+”.processed”, where `sfr_out_file</cite> is defined in “sfr_obs.config”</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe of aggregrated sfr segment aquifer and outflow</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_sfr_parameters">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_sfr_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seg_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reach_pars</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sfr_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>thin wrapper around <cite>gw_utils.apply_sfr_seg_parameters()</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_pars</strong> (<cite>bool</cite>, optional) – flag to apply segment-based parameters.
Default is True</p></li>
<li><p><strong>reach_pars</strong> (<cite>bool</cite>, optional) – flag to apply reach-based parameters.
Default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the modified SFR package instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>flopy.modflow.ModflowSfr</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>expects “sfr_seg_pars.config” to exist</p>
<p>expects <cite>nam_file</cite> +”_backup_.sfr” to exist</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_sfr_reach_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_sfr_reach_obs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sfr_reach_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the sfr reach observation process.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the companion function of <cite>gw_utils.setup_sfr_reach_obs()</cite>.</p>
<p>Requires sfr_reach_obs.config.</p>
<p>Writes &lt;sfr_out_file&gt;.processed, where &lt;sfr_out_file&gt; is defined in
“sfr_reach_obs.config”</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe of sfr aquifer and outflow ad segment,reach locations</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pd.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_sfr_seg_parameters">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_sfr_seg_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seg_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reach_pars</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sfr_seg_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the SFR segement multiplier parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_pars</strong> (<cite>bool</cite>, optional) – flag to apply segment-based parameters.
Default is True</p></li>
<li><p><strong>reach_pars</strong> (<cite>bool</cite>, optional) – flag to apply reach-based parameters.
Default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the modified SFR package instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>flopy.modflow.ModflowSfr</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>expects “sfr_seg_pars.config” to exist</p>
<p>expects <cite>nam_file</cite> +”_backup_.sfr” to exist</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.apply_sft_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">apply_sft_obs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sft_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>process an mt3d-usgs sft ASCII output file using a previous-written
config file</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe of extracted simulated outputs</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this is the companion function to <cite>gw_utils.setup_sft_obs()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.last_kstp_from_kper">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">last_kstp_from_kper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hds</span></em>, <em class="sig-param"><span class="n">kper</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.last_kstp_from_kper" title="Permalink to this definition">¶</a></dt>
<dd><p>function to find the last time step (kstp) for a
give stress period (kper) in a modflow head save file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hds</strong> (<cite>flopy.utils.HeadFile</cite>) – head save file</p></li>
<li><p><strong>kper</strong> (<cite>int</cite>) – the zero-index stress period number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the zero-based last time step during stress period
kper in the head save file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>int</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.load_sfr_out">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">load_sfr_out</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sfr_out_file</span></em>, <em class="sig-param"><span class="n">selection</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.load_sfr_out" title="Permalink to this definition">¶</a></dt>
<dd><p>load an ASCII SFR output file into a dictionary of kper: dataframes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfr_out_file</strong> (<cite>str</cite>) – SFR ASCII output file</p></li>
<li><p><strong>selection</strong> (<cite>pandas.DataFrame</cite>) – a dataframe of <cite>reach</cite> and <cite>segment</cite> pairs to
load.  If <cite>None</cite>, all reach-segment pairs are loaded.  Default is <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>aggregates flow to aquifer for segments and returns and flow out at
downstream end of segment.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of {kper:<cite>pandas.DataFrame</cite>} of SFR output.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><strong>dict</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.modflow_hob_to_instruction_file">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">modflow_hob_to_instruction_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hob_file</span></em>, <em class="sig-param"><span class="n">ins_file</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_hob_to_instruction_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write an instruction file for a modflow head observation file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hob_file</strong> (<cite>str</cite>) – the path and name of the existing modflow hob file</p></li>
<li><p><strong>ins_file</strong> (<cite>str</cite>, optional) – the name of the instruction file to write.
If <cite>None</cite>, <cite>hob_file</cite> +”.ins” is used.  Default is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataFrame with control file observation information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.modflow_hydmod_to_instruction_file">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">modflow_hydmod_to_instruction_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hydmod_file</span></em>, <em class="sig-param"><span class="n">ins_file</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_hydmod_to_instruction_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write an instruction file for a modflow hydmod file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hydmod_file</strong> (<cite>str</cite>) – the path and name of the existing modflow hob file</p></li>
<li><p><strong>ins_file</strong> (<cite>str</cite>, optional) – the name of the instruction file to write.
If <cite>None</cite>, <cite>hydmod_file</cite> +”.ins” is used.  Default is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataFrame with control file observation information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>calls <cite>pyemu.gw_utils.modflow_read_hydmod_file()</cite></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.modflow_pval_to_template_file">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">modflow_pval_to_template_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pval_file</span></em>, <em class="sig-param"><span class="n">tpl_file</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_pval_to_template_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for a modflow parameter value file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pval_file</strong> (<cite>str</cite>) – the path and name of the existing modflow pval file</p></li>
<li><p><strong>tpl_file</strong> (<cite>str</cite>, optional) – template file to write. If None, use
<cite>pval_file</cite> +”.tpl”. Default is None</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses names in the first column in the pval file as par names.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataFrame with control file parameter information</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.modflow_read_hydmod_file">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">modflow_read_hydmod_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hydmod_file</span></em>, <em class="sig-param"><span class="n">hydmod_outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_read_hydmod_file" title="Permalink to this definition">¶</a></dt>
<dd><p>read a binary hydmod file and return a dataframe of the results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hydmod_file</strong> (<cite>str</cite>) – The path and name of the existing modflow hydmod binary file</p></li>
<li><p><strong>hydmod_outfile</strong> (<cite>str</cite>, optional) – output file to write.  If <cite>None</cite>, use <cite>hydmod_file</cite> +”.dat”.
Default is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataFrame with hymod_file values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.modflow_sfr_gag_to_instruction_file">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">modflow_sfr_gag_to_instruction_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gage_output_file</span></em>, <em class="sig-param"><span class="n">ins_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parse_filename</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_sfr_gag_to_instruction_file" title="Permalink to this definition">¶</a></dt>
<dd><p>writes an instruction file for an SFR gage output file to read Flow only at all times</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gage_output_file</strong> (<cite>str</cite>) – the gage output filename (ASCII).</p></li>
<li><p><strong>ins_file</strong> (<cite>str</cite>, optional) – the name of the instruction file to
create.  If None, the name is <cite>gage_output_file</cite> +”.ins”.
Default is None</p></li>
<li><p><strong>parse_filename</strong> (<cite>bool</cite>) – if True, get the gage_num parameter by
parsing the gage output file filename if False, get the gage
number from the file itself</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>pandas.DataFrame</strong>: a dataframe with obsnme and obsval for the sfr simulated flows.</p></li>
<li><p><strong>str</strong>: file name of instructions file relating to gage output.</p></li>
<li><p><strong>str</strong>: file name of processed gage output for all times</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>sets up observations for gage outputs only for the Flow column.</p>
<p>If <cite>parse_namefile</cite> is true, only text up to first ‘.’ is used as the gage_num</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_gage_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_gage_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gage_file</span></em>, <em class="sig-param"><span class="n">ins_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_datetime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_gage_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup a forward run post processor routine for the modflow gage file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gage_file</strong> (<cite>str</cite>) – the gage output file (ASCII)</p></li>
<li><p><strong>ins_file</strong> (<cite>str</cite>, optional) – the name of the instruction file to create.  If None, the name
is <cite>gage_file`+”.processed.ins”.  Default is `None</cite></p></li>
<li><p><strong>start_datetime</strong> (<cite>str</cite>) – a <cite>pandas.to_datetime()</cite> compatible <cite>str</cite>.  If not <cite>None</cite>,
then the resulting observation names have the datetime suffix.  If <cite>None</cite>,
the suffix is the output totim.  Default is <cite>None</cite>.</p></li>
<li><p><strong>times</strong> ([<cite>float</cite>]) – a container of times to make observations for.  If None,
all times are used. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>pandas.DataFrame</strong>: a dataframe with observation name and simulated values for the
values in the gage file.</p></li>
<li><p><strong>str</strong>: file name of instructions file that was created relating to gage output.</p></li>
<li><p><strong>str</strong>: file name of processed gage output (processed according to times passed above.)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>setups up observations for gage outputs (all columns).</p>
<p>This is the companion function of <cite>gw_utils.apply_gage_obs()</cite></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_hds_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_hds_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hds_file</span></em>, <em class="sig-param"><span class="n">kperk_pairs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skip</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">'hds'</span></em>, <em class="sig-param"><span class="n">text</span><span class="o">=</span><span class="default_value">'head'</span></em>, <em class="sig-param"><span class="n">precision</span><span class="o">=</span><span class="default_value">'single'</span></em>, <em class="sig-param"><span class="n">include_path</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_hds_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to setup using all values from a layer-stress period
pair for observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hds_file</strong> (<cite>str</cite>) – path and name of an existing MODFLOW head-save file.
If the hds_file endswith ‘ucn’, then the file is treated as a UcnFile type.</p></li>
<li><p><strong>kperk_pairs</strong> (<em>[</em><em>(</em><em>int</em><em>,</em><em>int</em><em>)</em><em>]</em>) – a list of len two tuples which are pairs of kper
(zero-based stress period index) and k (zero-based layer index) to
setup observations for.  If None, then all layers and stress period records
found in the file will be used.  Caution: a shit-ton of observations may be produced!</p></li>
<li><p><strong>skip</strong> (<em>variable</em><em>, </em><em>optional</em>) – a value or function used to determine which values
to skip when setting up observations.  If np.scalar(skip)
is True, then values equal to skip will not be used.
If skip can also be a np.ndarry with dimensions equal to the model.
Observations are set up only for cells with Non-zero values in the array.
If not np.ndarray or np.scalar(skip), then skip will be treated as a lambda function that
returns np.NaN if the value should be skipped.</p></li>
<li><p><strong>prefix</strong> (<cite>str</cite>) – the prefix to use for the observation names. default is “hds”.</p></li>
<li><p><strong>text</strong> (<cite>str</cite>) – the text tag the flopy HeadFile instance.  Default is “head”</p></li>
<li><p><strong>precison</strong> (<cite>str</cite>) – the precision string for the flopy HeadFile instance.  Default is “single”</p></li>
<li><p><strong>include_path</strong> (<cite>bool</cite>, optional) – flag to setup the binary file processing in directory where the hds_file</p></li>
<li><p><strong>located</strong> (<em>is</em>) – the process in separate directory for where python is running.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>str</strong>: the forward run script line needed to execute the headsave file observation
operation</p></li>
<li><p><strong>pandas.DataFrame</strong>: a dataframe of pest control file information</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Writes an instruction file and a _setup_ csv used construct a control file.</p>
<p>This is the companion function to <cite>gw_utils.apply_hds_obs()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_hds_timeseries">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_hds_timeseries</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bin_file</span></em>, <em class="sig-param"><span class="n">kij_dict</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_path</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">postprocess_inact</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">text</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">precision</span><span class="o">=</span><span class="default_value">'single'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_hds_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to setup a forward process to extract time-series style values
from a binary modflow binary file (or equivalent format - hds, ucn, sub, cbb, etc).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bin_file</strong> (<cite>str</cite>) – path and name of existing modflow binary file - headsave, cell budget and MT3D UCN supported.</p></li>
<li><p><strong>kij_dict</strong> (<cite>dict</cite>) – dictionary of site_name: [k,i,j] pairs. For example: <cite>{“wel1”:[0,1,1]}</cite>.</p></li>
<li><p><strong>prefix</strong> (<cite>str</cite>, optional) – string to prepend to site_name when forming observation names.  Default is None</p></li>
<li><p><strong>include_path</strong> (<cite>bool</cite>, optional) – flag to setup the binary file processing in directory where the hds_file
is located (if different from where python is running).  This is useful for setting up
the process in separate directory for where python is running.</p></li>
<li><p><strong>model</strong> (<cite>flopy.mbase</cite>, optional) – a <cite>flopy.basemodel</cite> instance.  If passed, the observation names will
have the datetime of the observation appended to them (using the flopy <cite>start_datetime</cite> attribute.
If None, the observation names will have the zero-based stress period appended to them. Default is None.</p></li>
<li><p><strong>postprocess_inact</strong> (<cite>float</cite>, optional) – Inactive value in heads/ucn file e.g. mt.btn.cinit.  If <cite>None</cite>, no
inactive value processing happens.  Default is <cite>None</cite>.</p></li>
<li><p><strong>text</strong> (<cite>str</cite>) – the text record entry in the binary file (e.g. “constant_head”).
Used to indicate that the binary file is a MODFLOW cell-by-cell budget file.
If None, headsave or MT3D unformatted concentration file
is assummed.  Default is None</p></li>
<li><p><strong>fill</strong> (<cite>float</cite>) – fill value for NaNs in the extracted timeseries dataframe.  If
<cite>None</cite>, no filling is done, which may yield model run failures as the resulting
processed timeseries CSV file (produced at runtime) may have missing values and
can’t be processed with the cooresponding instruction file.  Default is <cite>None</cite>.</p></li>
<li><p><strong>precision</strong> (<cite>str</cite>) – the precision of the binary file.  Can be “single” or “double”.
Default is “single”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>str</strong>: the forward run command to execute the binary file process during model runs.</p></li>
<li><p><strong>pandas.DataFrame</strong>: a dataframe of observation information for use in the pest control file</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function writes hds_timeseries.config that must be in the same
dir where <cite>apply_hds_timeseries()</cite> is called during the forward run</p>
<p>Assumes model time units are days</p>
<p>this is the companion function of <cite>gw_utils.apply_hds_timeseries()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_mflist_budget_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_mflist_budget_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_filename</span></em>, <em class="sig-param"><span class="n">flx_filename</span><span class="o">=</span><span class="default_value">'flux.dat'</span></em>, <em class="sig-param"><span class="n">vol_filename</span><span class="o">=</span><span class="default_value">'vol.dat'</span></em>, <em class="sig-param"><span class="n">start_datetime</span><span class="o">=</span><span class="default_value">&quot;1-1'1970&quot;</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">save_setup_file</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_mflist_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations of budget volume and flux from modflow list file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_filename</strong> (<cite>str</cite>) – path and name of the existing modflow list file</p></li>
<li><p><strong>flx_filename</strong> (<cite>str</cite>, optional) – output filename that will contain the budget flux
observations. Default is “flux.dat”</p></li>
<li><p><strong>vol_filename</strong> (<cite>str</cite>, optional) – output filename that will contain the budget volume
observations.  Default is “vol.dat”</p></li>
<li><p><strong>start_datetime</strong> (<cite>str</cite>, optional) – a string that can be parsed into a pandas.TimeStamp.
This is used to give budget observations meaningful names.  Default is “1-1-1970”.</p></li>
<li><p><strong>prefix</strong> (<cite>str</cite>, optional) – a prefix to add to the water budget observations.  Useful if
processing more than one list file as part of the forward run process. Default is ‘’.</p></li>
<li><p><strong>save_setup_file</strong> (<cite>bool</cite>) – a flag to save “_setup_”+ <cite>list_filename</cite> +”.csv” file that contains useful
control file information</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with information for constructing a control file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method writes instruction files and also a _setup_.csv to use when constructing a pest
control file.  The instruction files are named &lt;flux_file&gt;.ins and &lt;vol_file&gt;.ins, respectively</p>
<p>It is recommended to use the default values for flux_file and vol_file.</p>
<p>This is the companion function of <cite>gw_utils.apply_mflist_budget_obs()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_mtlist_budget_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_mtlist_budget_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_filename</span></em>, <em class="sig-param"><span class="n">gw_filename</span><span class="o">=</span><span class="default_value">'mtlist_gw.dat'</span></em>, <em class="sig-param"><span class="n">sw_filename</span><span class="o">=</span><span class="default_value">'mtlist_sw.dat'</span></em>, <em class="sig-param"><span class="n">start_datetime</span><span class="o">=</span><span class="default_value">'1-1-1970'</span></em>, <em class="sig-param"><span class="n">gw_prefix</span><span class="o">=</span><span class="default_value">'gw'</span></em>, <em class="sig-param"><span class="n">sw_prefix</span><span class="o">=</span><span class="default_value">'sw'</span></em>, <em class="sig-param"><span class="n">save_setup_file</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_mtlist_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations of gw (and optionally sw) mass budgets from mt3dusgs list file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_filename</strong> (<cite>str</cite>) – path and name of existing modflow list file</p></li>
<li><p><strong>gw_filename</strong> (<cite>str</cite>, optional) – output filename that will contain the gw budget
observations. Default is “mtlist_gw.dat”</p></li>
<li><p><strong>sw_filename</strong> (<cite>str</cite>, optional) – output filename that will contain the sw budget
observations. Default is “mtlist_sw.dat”</p></li>
<li><p><strong>start_datetime</strong> (<cite>str</cite>, optional) – an str that can be parsed into a <cite>pandas.TimeStamp</cite>.
used to give budget observations meaningful names.  Default is “1-1-1970”.</p></li>
<li><p><strong>gw_prefix</strong> (<cite>str</cite>, optional) – a prefix to add to the GW budget observations.
Useful if processing more than one list file as part of the forward run process.
Default is ‘gw’.</p></li>
<li><p><strong>sw_prefix</strong> (<cite>str</cite>, optional) – a prefix to add to the SW budget observations.  Useful
if processing more than one list file as part of the forward run process.
Default is ‘sw’.</p></li>
<li><p><strong>save_setup_file</strong> (<cite>bool</cite>, optional) – a flag to save “_setup_”+ <cite>list_filename</cite> +”.csv” file
that contains useful control file information.  Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>str</strong>:  the command to add to the forward run script</p></li>
<li><p><strong>str</strong>: the names of the instruction files that were created</p></li>
<li><p><strong>pandas.DataFrame</strong>: a dataframe with information for constructing a control file</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>writes an instruction file and also a _setup_.csv to use when constructing a pest</dt><dd><p>control file</p>
</dd>
</dl>
<p>the instruction files are named <cite>out_filename</cite> +”.ins”</p>
<p>It is recommended to use the default value for <cite>gw_filename</cite> or <cite>sw_filename</cite>.</p>
<p>This is the companion function of <cite>gw_utils.apply_mtlist_budget_obs()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_sfr_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_sfr_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sfr_out_file</span></em>, <em class="sig-param"><span class="n">seg_group_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ins_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_path</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sfr_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations using the sfr ASCII output file.  Setups
the ability to aggregate flows for groups of segments.  Applies
only flow to aquier and flow out.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sft_out_file</strong> (<cite>str</cite>) – the name and path to an existing SFR output file</p></li>
<li><p><strong>seg_group_dict</strong> (<cite>dict</cite>) – a dictionary of SFR segements to aggregate together for a single obs.
the key value in the dict is the base observation name. If None, all segments
are used as individual observations. Default is None</p></li>
<li><p><strong>model</strong> (<cite>flopy.mbase</cite>) – a flopy model.  If passed, the observation names will have
the datetime of the observation appended to them.  If None, the observation names
will have the stress period appended to them. Default is None.</p></li>
<li><p><strong>include_path</strong> (<cite>bool</cite>) – flag to prepend sfr_out_file path to sfr_obs.config.  Useful for setting up
process in separate directory for where python is running.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe of observation name, simulated value and group.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the companion function of <cite>gw_utils.apply_sfr_obs()</cite>.</p>
<p>This function writes “sfr_obs.config” which must be kept in the dir where
“gw_utils.apply_sfr_obs()” is being called during the forward run</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_sfr_reach_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_sfr_reach_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sfr_out_file</span></em>, <em class="sig-param"><span class="n">seg_reach</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ins_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_path</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sfr_reach_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations using the sfr ASCII output file.  Setups
sfr point observations using segment and reach numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sft_out_file</strong> (<cite>str</cite>) – the path and name of an existing SFR output file</p></li>
<li><p><strong>seg_reach</strong> (<em>varies</em>) – a dict, or list of SFR [segment,reach] pairs identifying
locations of interest.  If <cite>dict</cite>, the key value in the dict is the base
observation name. If None, all reaches are used as individual observations.
Default is None - THIS MAY SET UP A LOT OF OBS!</p></li>
<li><p><strong>model</strong> (<cite>flopy.mbase</cite>) – a flopy model.  If passed, the observation names will
have the datetime of the observation appended to them.  If None, the
observation names will have the stress period appended to them. Default is None.</p></li>
<li><p><strong>include_path</strong> (<cite>bool</cite>) – a flag to prepend sfr_out_file path to sfr_obs.config.  Useful
for setting up process in separate directory for where python is running.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe of observation names, values, and groups</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pd.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the companion function of <cite>gw_utils.apply_sfr_reach_obs()</cite>.</p>
<p>This function writes “sfr_reach_obs.config” which must be kept in the dir where
“apply_sfr_reach_obs()” is being called during the forward run</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_sfr_reach_parameters">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_sfr_reach_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nam_file</span></em>, <em class="sig-param"><span class="n">model_ws</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">par_cols</span><span class="o">=</span><span class="default_value">['strhc1']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sfr_reach_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup multiplier paramters for reach data, when reachinput option is specififed in sfr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nam_file</strong> (<cite>str</cite>) – MODFLOw name file.  DIS, BAS, and SFR must be
available as pathed in the nam_file.  Optionally, <cite>nam_file</cite> can be
an existing <cite>flopy.modflow.Modflow</cite>.</p></li>
<li><p><strong>model_ws</strong> (<cite>str</cite>) – model workspace for flopy to load the MODFLOW model from</p></li>
<li><p><strong>par_cols</strong> ([<cite>str</cite>]) – a list of segment data entires to parameterize</p></li>
<li><p><strong>tie_hcond</strong> (<cite>bool</cite>) – flag to use same mult par for hcond1 and hcond2 for a
given segment.  Default is <cite>True</cite>.</p></li>
<li><p><strong>include_temporal_pars</strong> ([<cite>str</cite>]) – list of spatially-global multipliers to set up for
each stress period.  Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with useful parameter setup information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Similar to <cite>gw_utils.setup_sfr_seg_parameters()</cite>, method will apply params to sfr reachdata</p>
<dl class="simple">
<dt>Can load the dis, bas, and sfr files with flopy using model_ws. Or can pass a model object</dt><dd><p>(SFR loading can be slow)</p>
</dd>
</dl>
<p>This is the companion function of <cite>gw_utils.apply_sfr_reach_parameters()</cite></p>
<p>Skips values = 0.0 since multipliers don’t work for these</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_sfr_seg_parameters">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_sfr_seg_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nam_file</span></em>, <em class="sig-param"><span class="n">model_ws</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">par_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tie_hcond</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">include_temporal_pars</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sfr_seg_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup multiplier parameters for SFR segment data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nam_file</strong> (<cite>str</cite>) – MODFLOw name file.  DIS, BAS, and SFR must be
available as pathed in the nam_file.  Optionally, <cite>nam_file</cite> can be
an existing <cite>flopy.modflow.Modflow</cite>.</p></li>
<li><p><strong>model_ws</strong> (<cite>str</cite>) – model workspace for flopy to load the MODFLOW model from</p></li>
<li><p><strong>par_cols</strong> ([<cite>str</cite>]) – a list of segment data entires to parameterize</p></li>
<li><p><strong>tie_hcond</strong> (<cite>bool</cite>) – flag to use same mult par for hcond1 and hcond2 for a
given segment.  Default is <cite>True</cite>.</p></li>
<li><p><strong>include_temporal_pars</strong> ([<cite>str</cite>]) – list of spatially-global multipliers to set up for
each stress period.  Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with useful parameter setup information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl>
<dt>This function handles the standard input case, not all the cryptic SFR options.  Loads the</dt><dd><blockquote>
<div><p>dis, bas, and sfr files with flopy using model_ws.</p>
</div></blockquote>
<p>This is the companion function to <cite>gw_utils.apply_sfr_seg_parameters()</cite> .</p>
<dl class="simple">
<dt>The number (and numbering) of segment data entries must consistent across</dt><dd><p>all stress periods.</p>
</dd>
</dl>
<p>Writes <cite>nam_file</cite> +”_backup_.sfr” as the backup of the original sfr file</p>
<p>Skips values = 0.0 since multipliers don’t work for these</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.setup_sft_obs">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">setup_sft_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sft_file</span></em>, <em class="sig-param"><span class="n">ins_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_datetime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ncomp</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sft_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>writes a post-processor and instruction file for a mt3d-usgs sft output file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sft_file</strong> (<cite>str</cite>) – path and name of an existing sft output file (ASCII)</p></li>
<li><p><strong>ins_file</strong> (<cite>str</cite>, optional) – the name of the instruction file to create.
If None, the name is <cite>sft_file`+”.ins”.  Default is `None</cite>.</p></li>
<li><p><strong>start_datetime</strong> (<cite>str</cite>) – a pandas.to_datetime() compatible str.  If not None,
then the resulting observation names have the datetime
suffix.  If None, the suffix is the output totim.  Default
is <cite>None</cite>.</p></li>
<li><p><strong>times</strong> ([<cite>float</cite>]) – a list of times to make observations for.  If None, all times
found in the file are used. Default is None.</p></li>
<li><p><strong>ncomp</strong> (<cite>int</cite>) – number of components in transport model. Default is 1.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this is the companion function to <cite>gw_utils.apply_sft_obs()</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe with observation names and values for the sft simulated
concentrations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><strong>pandas.DataFrame</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.write_hfb_template">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">write_hfb_template</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.write_hfb_template" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for an hfb (yuck!)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>m</strong> – a model instance with an HFB package</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.gw_utils.write_hfb_zone_multipliers_template">
<code class="sig-prename descclassname">pyemu.utils.gw_utils.</code><code class="sig-name descname">write_hfb_zone_multipliers_template</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.gw_utils.write_hfb_zone_multipliers_template" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for an hfb using multipliers per zone (double yuck!)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>m</strong> (<cite>flopy.modflow.Modflow</cite>) – a model instance with an HFB package</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>dict</strong>: a dictionary with original unique HFB conductivity values and their
corresponding parameter names</p></li>
<li><p><strong>str</strong>: the template filename that was created</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.helpers">
<span id="pyemu-utils-helpers-module"></span><h2>pyemu.utils.helpers module<a class="headerlink" href="#module-pyemu.utils.helpers" title="Permalink to this headline">¶</a></h2>
<p>High-level functions to help perform complex tasks</p>
<dl class="py class">
<dt id="pyemu.utils.helpers.PstFromFlopyModel">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">PstFromFlopyModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">new_model_ws</span></em>, <em class="sig-param"><span class="n">org_model_ws</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pp_props</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">const_props</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">temporal_bc_props</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">temporal_list_props</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">grid_props</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">grid_geostruct</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pp_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zone_props</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">pp_geostruct</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">par_bounds_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sfr_pars</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">temporal_sfr_pars</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">temporal_list_geostruct</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remove_existing</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">k_zone_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mflist_waterbudget</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">mfhyd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">hds_kperk</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">use_pp_zones</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">obssim_smp_pairs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_tpl_in_pairs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_ins_out_pairs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extra_pre_cmds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extra_model_cmds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extra_post_cmds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">redirect_forward_output</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">tmp_files</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_exe_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">build_prior</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sfr_obs</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">spatial_bc_props</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">spatial_list_props</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">spatial_list_geostruct</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">hfb_pars</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">kl_props</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kl_num_eig</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">kl_geostruct</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>a monster helper class to setup a complex PEST interface around
an existing MODFLOW-2005-family model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<cite>flopy.mbase</cite>) – a loaded flopy model instance. If model is an str, it is treated as a
MODFLOW nam file (requires org_model_ws)</p></li>
<li><p><strong>new_model_ws</strong> (<cite>str</cite>) – a directory where the new version of MODFLOW input files and PEST(++)
files will be written</p></li>
<li><p><strong>org_model_ws</strong> (<cite>str</cite>) – directory to existing MODFLOW model files.  Required if model argument
is an str.  Default is None</p></li>
<li><p><strong>pp_props</strong> ([[<cite>str</cite>,[<cite>int</cite>]]]) – pilot point multiplier parameters for grid-based properties.
A nested list of grid-scale model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices.  For example, [“lpf.hk”,[0,1,2,]] would setup pilot point multiplier
parameters for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3.  For time-varying properties (e.g. recharge), the
iterable is for zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup pilot point multiplier parameters for recharge for stress
period 1,5,11,and 16.</p></li>
<li><p><strong>const_props</strong> ([[<cite>str</cite>,[<cite>int</cite>]]]) – constant (uniform) multiplier parameters for grid-based properties.
A nested list of grid-scale model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices.  For example, [“lpf.hk”,[0,1,2,]] would setup constant (uniform) multiplier
parameters for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3.  For time-varying properties (e.g. recharge), the
iterable is for zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup constant (uniform) multiplier parameters for recharge for stress
period 1,5,11,and 16.</p></li>
<li><p><strong>temporal_list_props</strong> ([[<cite>str</cite>,[<cite>int</cite>]]]) – list-type input stress-period level multiplier parameters.
A nested list of list-type input elements to parameterize using
name, iterable pairs.  The iterable is zero-based stress-period indices.
For example, to setup multipliers for WEL flux and for RIV conductance,
temporal_list_props = [[“wel.flux”,[0,1,2]],[“riv.cond”,None]] would setup
multiplier parameters for well flux for stress periods 1,2 and 3 and
would setup one single river conductance multiplier parameter that is applied
to all stress periods</p></li>
<li><p><strong>spatial_list_props</strong> ([[<cite>str</cite>,[<cite>int</cite>]]]) – list-type input for spatial multiplier parameters.
A nested list of list-type elements to parameterize using
names (e.g. [[“riv.cond”,0],[“wel.flux”,1] to setup up cell-based parameters for
each list-type element listed.  These multiplier parameters are applied across
all stress periods.  For this to work, there must be the same number of entries
for all stress periods.  If more than one list element of the same type is in a single
cell, only one parameter is used to multiply all lists in the same cell.</p></li>
<li><p><strong>grid_props</strong> ([[<cite>str</cite>,[<cite>int</cite>]]]) – grid-based (every active model cell) multiplier parameters.
A nested list of grid-scale model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices (e.g., [“lpf.hk”,[0,1,2,]] would setup a multiplier
parameter for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3 in every active model cell).  For time-varying properties (e.g. recharge), the
iterable is for zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup grid-based multiplier parameters in every active model cell
for recharge for stress period 1,5,11,and 16.</p></li>
<li><p><strong>sfr_pars</strong> (<cite>bool</cite>) – setup parameters for the stream flow routing modflow package.
If list is passed it defines the parameters to set up.</p></li>
<li><p><strong>sfr_temporal_pars</strong> (<cite>bool</cite>) – flag to include stress-period level spatially-global multipler parameters in addition to
the spatially-discrete <cite>sfr_pars</cite>.  Requires <cite>sfr_pars</cite> to be passed.  Default is False</p></li>
<li><p><strong>grid_geostruct</strong> (<cite>pyemu.geostats.GeoStruct</cite>) – the geostatistical structure to build the prior parameter covariance matrix
elements for grid-based parameters.  If None, a generic GeoStruct is created
using an “a” parameter that is 10 times the max cell size.  Default is None</p></li>
<li><p><strong>pp_space</strong> (<cite>int</cite>) – number of grid cells between pilot points.  If None, use the default
in pyemu.pp_utils.setup_pilot_points_grid.  Default is None</p></li>
<li><p><strong>zone_props</strong> ([[<cite>str</cite>,[<cite>int</cite>]]]) – zone-based multiplier parameters.
A nested list of zone-based model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices (e.g., [“lpf.hk”,[0,1,2,]] would setup a multiplier
parameter for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3 for unique zone values in the ibound array.
For time-varying properties (e.g. recharge), the iterable is for
zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup zone-based multiplier parameters for recharge for stress
period 1,5,11,and 16.</p></li>
<li><p><strong>pp_geostruct</strong> (<cite>pyemu.geostats.GeoStruct</cite>) – the geostatistical structure to use for building the prior parameter
covariance matrix for pilot point parameters.  If None, a generic
GeoStruct is created using pp_space and grid-spacing information.
Default is None</p></li>
<li><p><strong>par_bounds_dict</strong> (<cite>dict</cite>) – a dictionary of model property/boundary condition name, upper-lower bound pairs.
For example, par_bounds_dict = {“hk”:[0.01,100.0],”flux”:[0.5,2.0]} would
set the bounds for horizontal hydraulic conductivity to
0.001 and 100.0 and set the bounds for flux parameters to 0.5 and
2.0.  For parameters not found in par_bounds_dict,
<cite>pyemu.helpers.wildass_guess_par_bounds_dict</cite> is
used to set somewhat meaningful bounds.  Default is None</p></li>
<li><p><strong>temporal_list_geostruct</strong> (<cite>pyemu.geostats.GeoStruct</cite>) – the geostastical struture to
build the prior parameter covariance matrix
for time-varying list-type multiplier parameters.  This GeoStruct
express the time correlation so that the ‘a’ parameter is the length of
time that boundary condition multiplier parameters are correlated across.
If None, then a generic GeoStruct is created that uses an ‘a’ parameter
of 3 stress periods.  Default is None</p></li>
<li><p><strong>spatial_list_geostruct</strong> (<cite>pyemu.geostats.GeoStruct</cite>) – the geostastical struture to
build the prior parameter covariance matrix
for spatially-varying list-type multiplier parameters.
If None, a generic GeoStruct is created using an “a” parameter that
is 10 times the max cell size.  Default is None.</p></li>
<li><p><strong>remove_existing</strong> (<cite>bool</cite>) – a flag to remove an existing new_model_ws directory.  If False and
new_model_ws exists, an exception is raised.  If True and new_model_ws
exists, the directory is destroyed - user beware! Default is False.</p></li>
<li><p><strong>k_zone_dict</strong> (<cite>dict</cite>) – a dictionary of zero-based layer index, zone array pairs.
e.g. {lay: np.2darray}  Used to
override using ibound zones for zone-based parameterization.  If None,
use ibound values greater than zero as zones. Alternatively a dictionary of dictionaries
can be passed to allow different zones to be defined for different parameters.
e.g. {“upw.hk” {lay: np.2darray}, “extra.rc11” {lay: np.2darray}}
or {“hk” {lay: np.2darray}, “rc11” {lay: np.2darray}}</p></li>
<li><p><strong>use_pp_zones</strong> (<cite>bool</cite>) – a flag to use ibound zones (or k_zone_dict, see above) as pilot
point zones.  If False, ibound values greater than zero are treated as
a single zone for pilot points.  Default is False</p></li>
<li><p><strong>(</strong><strong>[</strong><strong>[</strong><strong>str</strong> (<em>external_ins_out_pairs</em>) – a list of observed-simulated PEST-type SMP file
pairs to get observations
from and include in the control file.  Default is []</p></li>
<li><p><strong>str</strong><strong>]</strong><strong>]</strong> – a list of observed-simulated PEST-type SMP file
pairs to get observations
from and include in the control file.  Default is []</p></li>
<li><p><strong>(</strong><strong>[</strong><strong>[</strong><strong>str</strong> – a list of existing template file, model input
file pairs to parse parameters
from and include in the control file.  Default is []</p></li>
<li><p><strong>str</strong><strong>]</strong><strong>]</strong> – a list of existing template file, model input
file pairs to parse parameters
from and include in the control file.  Default is []</p></li>
<li><p><strong>(</strong><strong>[</strong><strong>[</strong><strong>str</strong> – a list of existing instruction file,
model output file pairs to parse
observations from and include in the control file.  Default is []</p></li>
<li><p><strong>str</strong><strong>]</strong><strong>]</strong> – a list of existing instruction file,
model output file pairs to parse
observations from and include in the control file.  Default is []</p></li>
<li><p><strong>extra_pre_cmds</strong> ([<cite>str</cite>]) – a list of preprocessing commands to add to the forward_run.py script
commands are executed with os.system() within forward_run.py. Default is None.</p></li>
<li><p><strong>redirect_forward_output</strong> (<cite>bool</cite>) – flag for whether to redirect forward model output to text files (True) or
allow model output to be directed to the screen (False).  Default is True</p></li>
<li><p><strong>extra_post_cmds</strong> ([<cite>str</cite>]) – a list of post-processing commands to add to the forward_run.py script.
Commands are executed with os.system() within forward_run.py. Default is None.</p></li>
<li><p><strong>tmp_files</strong> ([<cite>str</cite>]) – a list of temporary files that should be removed at the start of the forward
run script.  Default is [].</p></li>
<li><p><strong>model_exe_name</strong> (<cite>str</cite>) – binary name to run modflow.  If None, a default from flopy is used,
which is dangerous because of the non-standard binary names
(e.g. MODFLOW-NWT_x64, MODFLOWNWT, mfnwt, etc). Default is None.</p></li>
<li><p><strong>build_prior</strong> (<cite>bool</cite>) – flag to build prior covariance matrix. Default is True</p></li>
<li><p><strong>sfr_obs</strong> (<cite>bool</cite>) – flag to include observations of flow and aquifer exchange from
the sfr ASCII output file</p></li>
<li><p><strong>hfb_pars</strong> (<cite>bool</cite>) – add HFB parameters.  uses pyemu.gw_utils.write_hfb_template().  the resulting
HFB pars have parval1 equal to the values in the original file and use the
spatial_list_geostruct to build geostatistical covariates between parameters</p></li>
<li><p><strong>kl_props</strong> ([[<cite>str</cite>,[<cite>int</cite>]]]) – karhunen-loeve based multiplier parameters.
A nested list of KL-based model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices (e.g., [“lpf.hk”,[0,1,2,]] would setup a multiplier
parameter for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3 for unique zone values in the ibound array.
For time-varying properties (e.g. recharge), the iterable is for
zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup zone-based multiplier parameters for recharge for stress
period 1,5,11,and 16.</p></li>
<li><p><strong>kl_num_eig</strong> (<cite>int</cite>) – the number of KL-based eigenvector multiplier parameters to use for each
KL parameter set. default is 100</p></li>
<li><p><strong>kl_geostruct</strong> (<cite>pyemu.geostats.Geostruct</cite>) – the geostatistical structure
to build the prior parameter covariance matrix
elements for KL-based parameters.  If None, a generic GeoStruct is created
using an “a” parameter that is 10 times the max cell size.  Default is None</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setup up multiplier parameters for an existing MODFLOW model.</p>
<p>Does all kinds of coolness like building a
meaningful prior, assigning somewhat meaningful parameter groups and
bounds, writes a forward_run.py script with all the calls need to
implement multiplier parameters, run MODFLOW and post-process.</p>
<p>Works a lot better if TEMPCHEK, INSCHEK and PESTCHEK are available in the
system path variable</p>
</div>
<dl class="py method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.build_prior">
<code class="sig-name descname">build_prior</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">'ascii'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">droptol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunk</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">6</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.build_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>build and optionally save the prior parameter covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmt</strong> (<cite>str</cite>, optional) – the format to save the cov matrix.  Options are “ascii”,”binary”,”uncfile”, “coo”.
Default is “ascii”.  If “none” (lower case string, not None), then no file is created.</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>, optional) – the filename to save the prior cov matrix to.  If None, the name is formed using
model nam_file name.  Default is None.</p></li>
<li><p><strong>droptol</strong> (<cite>float</cite>, optional) – tolerance for dropping near-zero values when writing compressed binary.
Default is None.</p></li>
<li><p><strong>chunk</strong> (<cite>int</cite>, optional) – chunk size to write in a single pass - for binary only.  Default
is None (no chunking).</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – number of standard deviations represented by the parameter bounds.  Default
is 6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the full prior parameter covariance matrix, generated by processing parameters by
groups</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.build_pst">
<code class="sig-name descname">build_pst</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.build_pst" title="Permalink to this definition">¶</a></dt>
<dd><p>build the pest control file using the parameters and
observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – the filename to save the contorl file to.  If None, the
name if formed from the model namfile name.  Default is None.  The control
is saved in the <cite>PstFromFlopy.m.model_ws</cite> directory.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>calls pyemu.Pst.from_io_files</p>
<p>calls PESTCHEK</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">use_specsim</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">scale_offset</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>draw from the geostatistically-implied parameter covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_reals</strong> (<cite>int</cite>) – number of realizations to generate. Default is 100</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – number of standard deviations represented by
the parameter bounds.  Default is 6.</p></li>
<li><p><strong>use_specsim</strong> (<cite>bool</cite>) – flag to use spectral simulation for grid-based
parameters.  Requires a regular grid but is wicked fast.  Default is False</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>, optional) – flag to apply scale and offset to parameter
bounds when calculating variances - this is passed through to
<cite>pyemu.Cov.from_parameter_data</cite>.  Default is True.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>operates on parameters by groups to avoid having to construct a very large
covariance matrix for problems with more the 30K parameters.</p>
<p>uses <cite>helpers.geostatitical_draw()</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The realized parameter ensemble</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.ParameterEnsemble</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.write_forward_run">
<code class="sig-name descname">write_forward_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.write_forward_run" title="Permalink to this definition">¶</a></dt>
<dd><p>write the forward run script forward_run.py</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method can be called repeatedly, especially after any
changed to the pre- and/or post-processing routines.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyemu.utils.helpers.SpatialReference">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">SpatialReference</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delr</span><span class="o">=</span><span class="default_value">array([], dtype=float64)</span></em>, <em class="sig-param"><span class="n">delc</span><span class="o">=</span><span class="default_value">array([], dtype=float64)</span></em>, <em class="sig-param"><span class="n">lenuni</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">xul</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">yul</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xll</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">yll</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rotation</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">proj4_str</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">epsg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prj</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">length_multiplier</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">source</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>a class to locate a structured model grid in x-y space.
Lifted wholesale from Flopy, and preserved here…
…maybe slighlty over-engineered for here</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delr</strong> (<em>numpy ndarray</em>) – the model discretization delr vector
(An array of spacings along a row)</p></li>
<li><p><strong>delc</strong> (<em>numpy ndarray</em>) – the model discretization delc vector
(An array of spacings along a column)</p></li>
<li><p><strong>lenuni</strong> (<em>int</em>) – the length units flag from the discretization package
(default 2)</p></li>
<li><p><strong>xul</strong> (<em>float</em>) – the x coordinate of the upper left corner of the grid
Enter either xul and yul or xll and yll.</p></li>
<li><p><strong>yul</strong> (<em>float</em>) – the y coordinate of the upper left corner of the grid
Enter either xul and yul or xll and yll.</p></li>
<li><p><strong>xll</strong> (<em>float</em>) – the x coordinate of the lower left corner of the grid
Enter either xul and yul or xll and yll.</p></li>
<li><p><strong>yll</strong> (<em>float</em>) – the y coordinate of the lower left corner of the grid
Enter either xul and yul or xll and yll.</p></li>
<li><p><strong>rotation</strong> (<em>float</em>) – the counter-clockwise rotation (in degrees) of the grid</p></li>
<li><p><strong>proj4_str</strong> (<em>str</em>) – a PROJ4 string that identifies the grid in space. warning: case
sensitive!</p></li>
<li><p><strong>units</strong> (<em>string</em>) – Units for the grid.  Must be either feet or meters</p></li>
<li><p><strong>epsg</strong> (<em>int</em>) – EPSG code that identifies the grid in space. Can be used in lieu of
proj4. PROJ4 attribute will auto-populate if there is an internet
connection(via get_proj4 method).
See <a class="reference external" href="https://www.epsg-registry.org/">https://www.epsg-registry.org/</a> or spatialreference.org</p></li>
<li><p><strong>length_multiplier</strong> (<em>float</em>) – multiplier to convert model units to spatial reference units.
delr and delc above will be multiplied by this value. (default=1.)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.xedge">
<code class="sig-name descname">xedge</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.xedge" title="Permalink to this definition">¶</a></dt>
<dd><p>array of column edges</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.yedge">
<code class="sig-name descname">yedge</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.yedge" title="Permalink to this definition">¶</a></dt>
<dd><p>array of row edges</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.xgrid">
<code class="sig-name descname">xgrid</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.xgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy meshgrid of xedges</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.ygrid">
<code class="sig-name descname">ygrid</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.ygrid" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy meshgrid of yedges</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.xcenter">
<code class="sig-name descname">xcenter</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.xcenter" title="Permalink to this definition">¶</a></dt>
<dd><p>array of column centers</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.ycenter">
<code class="sig-name descname">ycenter</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.ycenter" title="Permalink to this definition">¶</a></dt>
<dd><p>array of row centers</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.xcentergrid">
<code class="sig-name descname">xcentergrid</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.xcentergrid" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy meshgrid of column centers</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.ycentergrid">
<code class="sig-name descname">ycentergrid</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.ycentergrid" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy meshgrid of row centers</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.vertices">
<code class="sig-name descname">vertices</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>1D array of cell vertices for whole grid in C-style (row-major) order
(same as np.ravel())</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>xul and yul can be explicitly (re)set after SpatialReference
instantiation, but only before any of the other attributes and methods are
accessed</p>
<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.attribs_from_namfile_header">
<em class="property">static </em><code class="sig-name descname">attribs_from_namfile_header</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">namefile</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.attribs_from_namfile_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.attribute_dict">
<em class="property">property </em><code class="sig-name descname">attribute_dict</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.attribute_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.bounds">
<em class="property">property </em><code class="sig-name descname">bounds</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return bounding box in shapely order.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.defaults">
<code class="sig-name descname">defaults</code><em class="property"> = {'length_multiplier': None, 'lenuni': 2, 'proj4_str': None, 'rotation': 0.0, 'source': 'defaults', 'units': None, 'xul': None, 'yul': None}</em><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.defaults" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.epsg">
<em class="property">property </em><code class="sig-name descname">epsg</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.epsg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.from_gridspec">
<em class="property">classmethod </em><code class="sig-name descname">from_gridspec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gridspec_file</span></em>, <em class="sig-param"><span class="n">lenuni</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.from_gridspec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.from_namfile">
<em class="property">classmethod </em><code class="sig-name descname">from_namfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">namefile</span></em>, <em class="sig-param"><span class="n">delr</span><span class="o">=</span><span class="default_value">array([], dtype=float64)</span></em>, <em class="sig-param"><span class="n">delc</span><span class="o">=</span><span class="default_value">array([], dtype=float64)</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.from_namfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_extent">
<code class="sig-name descname">get_extent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the extent of the rotated and offset grid</p>
<p>Return (xmin, xmax, ymin, ymax)</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_grid_lines">
<code class="sig-name descname">get_grid_lines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_grid_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the grid lines as a list</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_ij">
<code class="sig-name descname">get_ij</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the row and column of a point or sequence of points
in real-world coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>scalar</em><em> or </em><em>sequence of x coordinates</em>) – </p></li>
<li><p><strong>y</strong> (<em>scalar</em><em> or </em><em>sequence of y coordinates</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>i</strong> (<em>row or sequence of rows (zero-based)</em>)</p></li>
<li><p><strong>j</strong> (<em>column or sequence of columns (zero-based)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_rc">
<code class="sig-name descname">get_rc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_rc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_vertices">
<code class="sig-name descname">get_vertices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Get vertices for a single cell or sequence if i, j locations.</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_xcenter_array">
<code class="sig-name descname">get_xcenter_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_xcenter_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell center x
coordinate for every column in the grid in model space - not offset or rotated.</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_xedge_array">
<code class="sig-name descname">get_xedge_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_xedge_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell edge x
coordinates for every column in the grid in model space - not offset
or rotated.  Array is of size (ncol + 1)</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_ycenter_array">
<code class="sig-name descname">get_ycenter_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_ycenter_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell center x
coordinate for every row in the grid in model space - not offset of rotated.</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.get_yedge_array">
<code class="sig-name descname">get_yedge_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.get_yedge_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell edge y
coordinates for every row in the grid in model space - not offset or
rotated. Array is of size (nrow + 1)</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.length_multiplier">
<em class="property">property </em><code class="sig-name descname">length_multiplier</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.length_multiplier" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to identify multiplier for converting from
model units to sr units, defaulting to 1.</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.lenuni">
<em class="property">property </em><code class="sig-name descname">lenuni</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.lenuni" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.lenuni_text">
<code class="sig-name descname">lenuni_text</code><em class="property"> = {0: 'undefined', 1: 'feet', 2: 'meters', 3: 'centimeters'}</em><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.lenuni_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.lenuni_values">
<code class="sig-name descname">lenuni_values</code><em class="property"> = {'centimeters': 3, 'feet': 1, 'meters': 2, 'undefined': 0}</em><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.lenuni_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.load">
<em class="property">static </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">namefile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reffile</span><span class="o">=</span><span class="default_value">'usgs.model.reference'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to load spatial reference information from
the following files (in order):
1) usgs.model.reference
2) NAM file (header comment)
3) SpatialReference.default dictionary</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.model_length_units">
<em class="property">property </em><code class="sig-name descname">model_length_units</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.model_length_units" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.ncol">
<em class="property">property </em><code class="sig-name descname">ncol</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.ncol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.nrow">
<em class="property">property </em><code class="sig-name descname">nrow</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.nrow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.origin_loc">
<code class="sig-name descname">origin_loc</code><em class="property"> = 'ul'</em><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.origin_loc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.proj4_str">
<em class="property">property </em><code class="sig-name descname">proj4_str</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.proj4_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.read_usgs_model_reference_file">
<em class="property">static </em><code class="sig-name descname">read_usgs_model_reference_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reffile</span><span class="o">=</span><span class="default_value">'usgs.model.reference'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.read_usgs_model_reference_file" title="Permalink to this definition">¶</a></dt>
<dd><p>read spatial reference info from the usgs.model.reference file
<a class="reference external" href="https://water.usgs.gov/ogw/policy/gw-model/modelers-setup.html">https://water.usgs.gov/ogw/policy/gw-model/modelers-setup.html</a></p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.rotate">
<em class="property">static </em><code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">xorigin</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">yorigin</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Given x and y array-like values calculate the rotation about an
arbitrary origin and then return the rotated coordinates.  theta is in
degrees.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyemu.utils.helpers.SpatialReference.rotation">
<code class="sig-name descname">rotation</code><em class="property"> = 0.0</em><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.rotation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.set_spatialreference">
<code class="sig-name descname">set_spatialreference</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xul</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">yul</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xll</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">yll</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rotation</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.set_spatialreference" title="Permalink to this definition">¶</a></dt>
<dd><p>set spatial reference - can be called from model instance</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.theta">
<em class="property">property </em><code class="sig-name descname">theta</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.theta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">inverse</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Given x and y array-like values, apply rotation, scale and offset,
to convert them from model coordinates to real-world coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.units">
<em class="property">property </em><code class="sig-name descname">units</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.units" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id0">
<em class="property">property </em><code class="sig-name descname">vertices</code><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of vertices for</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.write_gridspec">
<code class="sig-name descname">write_gridspec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.write_gridspec" title="Permalink to this definition">¶</a></dt>
<dd><p>write a PEST-style grid specification file</p>
</dd></dl>

<dl class="py method">
<dt id="id1">
<em class="property">property </em><code class="sig-name descname">xcenter</code><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id2">
<em class="property">property </em><code class="sig-name descname">xcentergrid</code><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id3">
<em class="property">property </em><code class="sig-name descname">xedge</code><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id4">
<em class="property">property </em><code class="sig-name descname">xgrid</code><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.xll">
<em class="property">property </em><code class="sig-name descname">xll</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.xll" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.xul">
<em class="property">property </em><code class="sig-name descname">xul</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.xul" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id5">
<em class="property">property </em><code class="sig-name descname">ycenter</code><a class="headerlink" href="#id5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id6">
<em class="property">property </em><code class="sig-name descname">ycentergrid</code><a class="headerlink" href="#id6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id7">
<em class="property">property </em><code class="sig-name descname">yedge</code><a class="headerlink" href="#id7" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id8">
<em class="property">property </em><code class="sig-name descname">ygrid</code><a class="headerlink" href="#id8" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.yll">
<em class="property">property </em><code class="sig-name descname">yll</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.yll" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.helpers.SpatialReference.yul">
<em class="property">property </em><code class="sig-name descname">yul</code><a class="headerlink" href="#pyemu.utils.helpers.SpatialReference.yul" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.apply_array_pars">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">apply_array_pars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arr_par</span><span class="o">=</span><span class="default_value">'arr_pars.csv'</span></em>, <em class="sig-param"><span class="n">arr_par_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunk_len</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.apply_array_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to apply array-based multipler parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr_par</strong> (<cite>str</cite> or <cite>pandas.DataFrame</cite>) – if type <cite>str</cite>,</p></li>
<li><p><strong>to csv file detailing parameter array multipliers.</strong> (<em>path</em>) – This file can be written by PstFromFlopy.</p></li>
<li><p><strong>type pandas.DataFrame is Dataframe with columns of</strong> (<em>if</em>) – </p></li>
<li><p><strong>[</strong><strong>'mlt_file'</strong> – </p></li>
<li><p><strong>'model_file'</strong> – </p></li>
<li><p><strong>and optionally</strong> (<em>'org_file'</em><em>]</em>) – </p></li>
<li><p><strong>[</strong><strong>'pp_file'</strong> – </p></li>
<li><p><strong>'fac_file'</strong><strong>]</strong><strong></strong> – </p></li>
<li><p><strong>chunk_len</strong> (<cite>int</cite>) – the number of files to process per chunk
with multiprocessing - applies to both fac2real and <a href="#id9"><span class="problematic" id="id10">process_</span></a>
input_files. Default is 50.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Used to implement the parameterization constructed by
PstFromFlopyModel during a forward run</p>
<p>This function should be added to the forward_run.py script but can
be called on any correctly formatted csv</p>
<p>This function using multiprocessing, spawning one process for each
model input array (and optionally pp files).  This speeds up
execution time considerably but means you need to make sure your
forward run script uses the proper multiprocessing idioms for
freeze support and main thread handling.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.apply_genericlist_pars">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">apply_genericlist_pars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.apply_genericlist_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to apply list style mult parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame that relates files containing
multipliers to model input file names. Required columns include:
{“model_file”: file name of resulatant model input file,
“org_file”: file name of original file that multipliers act on,
“fmt”: format specifier for model input file (currently on ‘free’ supported),
“sep”: separator for model input file if ‘free’ formatted,
“head_rows”: Number of header rows to transfer from orig file to model file,
“index_cols”: list of columns (either indexes or strings) to be used to align mults, orig and model files,
“use_cols”: columns to mults act on,
“upper_bound”: ultimate upper bound for model input file parameter,
“lower_bound”: ultimate lower bound for model input file parameter}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.apply_list_and_array_pars">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">apply_list_and_array_pars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arr_par_file</span><span class="o">=</span><span class="default_value">'mult2model_info.csv'</span></em>, <em class="sig-param"><span class="n">chunk_len</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.apply_list_and_array_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply multiplier parameters to list and array style model files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr_par_file</strong> (<em>str</em>) – </p></li>
<li><p><strong>chunk_len</strong> (<cite>int</cite>) – the number of files to process per multiprocessing
chunk in appl_array_pars().  default is 50.</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Used to implement the parameterization constructed by
PstFrom during a forward run</p>
<p>Should be added to the forward_run.py script</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.apply_list_pars">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">apply_list_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.apply_list_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to apply boundary condition multiplier parameters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Used to implement the parameterization constructed by
PstFromFlopyModel during a forward run</p>
<p>Requires either “temporal_list_pars.csv” or “spatial_list_pars.csv”</p>
<p>Should be added to the forward_run.py script</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.apply_temporal_diff_obs">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">apply_temporal_diff_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config_file</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.apply_temporal_diff_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>process an instruction-output file pair and formulate difference observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config_file</strong> (<cite>str</cite>) – configuration file written by <cite>pyemu.helpers.setup_temporal_diff_obs</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>processed difference observations</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>diff_df (<cite>pandas.DataFrame</cite>)</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>writes <cite>config_file.replace(“.config”,”.processed”)</cite> output file that can be read
with the instruction file that is created by <cite>pyemu.helpers.setup_temporal_diff_obs()</cite>.</p>
<p>this is the companion function of <cite>helpers.setup_setup_temporal_diff_obs()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.build_jac_test_csv">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">build_jac_test_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">num_steps</span></em>, <em class="sig-param"><span class="n">par_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">forward</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.build_jac_test_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>build a dataframe of jactest inputs for use with sweep</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – existing control file</p></li>
<li><p><strong>num_steps</strong> (<cite>int</cite>) – number of pertubation steps for each parameter</p></li>
<li><p><strong>[</strong><strong>str</strong><strong>]</strong> (<em>par_names</em>) – list of parameter names of pars to test.
If None, all adjustable pars are used. Default is None</p></li>
<li><p><strong>forward</strong> (<cite>bool</cite>) – flag to start with forward pertubations.
Default is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the sequence of model runs to evaluate
for the jactesting.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.calc_observation_ensemble_quantiles">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">calc_observation_ensemble_quantiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ens</span></em>, <em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">quantiles</span></em>, <em class="sig-param"><span class="n">subset_obsnames</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">subset_obsgroups</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.calc_observation_ensemble_quantiles" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Given an observation ensemble, and requested quantiles, this function calculates the requested</dt><dd><p>quantile point-by-point in the ensemble. This resulting set of values does not, however, correspond
to a single realization in the ensemble. So, this function finds the minimum weighted squared
distance to the quantile and labels it in the ensemble. Also indicates which realizations
correspond to the selected quantiles.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ens</strong> (<em>pandas DataFrame</em>) – DataFrame read from an observation</p></li>
<li><p><strong>pst</strong> (<em>pyemy.Pst object</em>) – </p></li>
<li><p><strong>quantiles</strong> (<em>iterable</em>) – quantiles ranging from 0-1.0 for which results requested</p></li>
<li><p><strong>subset_obsnames</strong> (<em>iterable</em>) – list of observation names to include in calculations</p></li>
<li><p><strong>subset_obsgroups</strong> (<em>iterable</em>) – list of observation groups to include in calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>same ens object that was input but with quantile realizations</dt><dd><p>appended as new rows labelled with ‘q_#’ where ‘#’ is the slected quantile</p>
</dd>
<dt>quantile_idx (dictionary): dictionary with keys being quantiles and values being realizations</dt><dd><p>corresponding to each realization</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ens (pandas DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.calc_rmse_ensemble">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">calc_rmse_ensemble</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ens</span></em>, <em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">bygroups</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">subset_realizations</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.calc_rmse_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates RMSE (without weights) to quantify fit to observations for ensemble members</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ens</strong> (<em>pandas DataFrame</em>) – DataFrame read from an observation</p></li>
<li><p><strong>pst</strong> (<em>pyemy.Pst object</em>) – </p></li>
<li><p><strong>bygroups</strong> (<em>Bool</em>) – Flag to summarize by groups or not. Defaults to True.</p></li>
<li><p><strong>subset_realizations</strong> (<em>iterable</em><em>, </em><em>optional</em>) – Subset of realizations for which
to report RMSE. Defaults to None which returns all realizations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rows are realizations. Columns are groups. Content is RMSE</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rmse (pandas DataFrame object)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.first_order_pearson_tikhonov">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">first_order_pearson_tikhonov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">cov</span></em>, <em class="sig-param"><span class="n">reset</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">abs_drop_tol</span><span class="o">=</span><span class="default_value">0.001</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.first_order_pearson_tikhonov" title="Permalink to this definition">¶</a></dt>
<dd><p>setup preferred-difference regularization from a covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – the PEST control file</p></li>
<li><p><strong>cov</strong> (<cite>pyemu.Cov</cite>) – a covariance matrix instance with
some or all of the parameters listed in <cite>pst</cite>.</p></li>
<li><p><strong>reset</strong> (<cite>bool</cite>) – a flag to remove any existing prior information equations
in the control file.  Default is True</p></li>
<li><p><strong>abs_drop_tol</strong> (<cite>float</cite>, optional) – tolerance to control how many pi equations
are written. If the absolute value of the Pearson CC is less than
abs_drop_tol, the prior information equation will not be included in
the control file.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The weights on the prior information equations are the Pearson
correlation coefficients implied by covariance matrix.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Cov</span><span class="o">.</span><span class="n">from_ascii</span><span class="p">(</span><span class="s2">&quot;my.cov&quot;</span><span class="p">)</span>
<span class="n">pyemu</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">first_order_pearson_tikhonov</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">cov</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;my_reg.pst&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.geostatistical_draws">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">geostatistical_draws</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">struct_dict</span></em>, <em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">scale_offset</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.geostatistical_draws" title="Permalink to this definition">¶</a></dt>
<dd><p>construct a parameter ensemble from a prior covariance matrix
implied by geostatistical structure(s) and parameter bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file (or the name of control file).  The
parameter bounds in <cite>pst</cite> are used to define the variance of each
parameter group.</p></li>
<li><p><strong>struct_dict</strong> (<cite>dict</cite>) – a dict of GeoStruct (or structure file), and list of
pilot point template files pairs. If the values in the dict are
<cite>pd.DataFrames</cite>, then they must have an ‘x’,’y’, and ‘parnme’ column.
If the filename ends in ‘.csv’, then a pd.DataFrame is loaded,
otherwise a pilot points file is loaded.</p></li>
<li><p><strong>num_reals</strong> (<cite>int</cite>, optional) – number of realizations to draw.  Default is 100</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – a float representing the number of standard deviations
implied by parameter bounds. Default is 4.0, which implies 95% confidence parameter bounds.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, optional) – flag to control output to stdout.  Default is True.
flag for stdout.</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>,optional) – flag to apply scale and offset to parameter bounds
when calculating variances - this is passed through to <cite>pyemu.Cov.from_parameter_data()</cite>.
Default is True.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p><cite>pyemu.ParameterEnsemble</cite>: the realized parameter ensemble.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>parameters are realized by parameter group.  The variance of each
parameter group is used to scale the resulting geostatistical
covariance matrix Therefore, the sill of the geostatistical structures
in <cite>struct_dict</cite> should be 1.0</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;struct.dat&quot;</span><span class="p">:[</span><span class="s2">&quot;hkpp.dat.tpl&quot;</span><span class="p">,</span><span class="s2">&quot;vka.dat.tpl&quot;</span><span class="p">]}</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">geostatistical_draws</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">struct_dict</span><span class="o">=</span><span class="n">sd</span><span class="p">}</span>
<span class="n">pe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;my_pe.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.geostatistical_prior_builder">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">geostatistical_prior_builder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">struct_dict</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">scale_offset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.geostatistical_prior_builder" title="Permalink to this definition">¶</a></dt>
<dd><p>construct a full prior covariance matrix using geostastical structures
and parameter bounds information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – a control file instance (or the name of control file)</p></li>
<li><p><strong>struct_dict</strong> (<cite>dict</cite>) – a dict of GeoStruct (or structure file), and list of
pilot point template files pairs. If the values in the dict are
<cite>pd.DataFrames</cite>, then they must have an ‘x’,’y’, and ‘parnme’ column.
If the filename ends in ‘.csv’, then a pd.DataFrame is loaded,
otherwise a pilot points file is loaded.</p></li>
<li><p><strong>sigma_range</strong> (<cite>float</cite>) – a float representing the number of standard deviations
implied by parameter bounds. Default is 4.0, which implies 95% confidence parameter bounds.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, optional) – flag to control output to stdout.  Default is True.
flag for stdout.</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>) – a flag to apply scale and offset to parameter upper and lower bounds
before applying log transform.  Passed to pyemu.Cov.from_parameter_data().  Default
is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a covariance matrix that includes all adjustable parameters in the control
file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The covariance of parameters associated with geostatistical structures is defined
as a mixture of GeoStruct and bounds.  That is, the GeoStruct is used to construct a
pyemu.Cov, then the entire pyemu.Cov is scaled by the uncertainty implied by the bounds and
sigma_range. Most users will want to sill of the geostruct to sum to 1.0 so that the resulting
covariance matrices have variance proportional to the parameter bounds. Sounds complicated…</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;struct.dat&quot;</span><span class="p">:[</span><span class="s2">&quot;hkpp.dat.tpl&quot;</span><span class="p">,</span><span class="s2">&quot;vka.dat.tpl&quot;</span><span class="p">]}</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">geostatistical_draws</span><span class="p">(</span><span class="n">pst</span><span class="p">,</span><span class="n">struct_dict</span><span class="o">=</span><span class="n">sd</span><span class="p">}</span>
<span class="n">cov</span><span class="o">.</span><span class="n">to_binary</span><span class="p">(</span><span class="s2">&quot;prior.jcb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.get_maha_obs_summary">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">get_maha_obs_summary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sim_en</span></em>, <em class="sig-param"><span class="n">l1_crit_val</span><span class="o">=</span><span class="default_value">6.34</span></em>, <em class="sig-param"><span class="n">l2_crit_val</span><span class="o">=</span><span class="default_value">9.2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.get_maha_obs_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the 1-D and 2-D mahalanobis distance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_en</strong> (<cite>pyemu.ObservationEnsemble</cite>) – a simulated outputs ensemble</p></li>
<li><p><strong>l1_crit_val</strong> (<cite>float</cite>) – the chi squared critical value for the 1-D
mahalanobis distance.  Default is 6.4 (p=0.01,df=1)</p></li>
<li><p><strong>l2_crit_val</strong> (<cite>float</cite>) – the chi squared critical value for the 2-D
mahalanobis distance.  Default is 9.2 (p=0.01,df=2)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>pandas.DataFrame</strong>: 1-D subspace squared mahalanobis distances</dt><dd><p>that exceed the <cite>l1_crit_val</cite> threshold</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>pandas.DataFrame</strong>: 2-D subspace squared mahalanobis distances</dt><dd><p>that exceed the <cite>l2_crit_val</cite> threshold</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Noise realizations are added to <cite>sim_en</cite> to account for measurement</dt><dd><p>noise.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.jco_from_pestpp_runstorage">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">jco_from_pestpp_runstorage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rnj_filename</span></em>, <em class="sig-param"><span class="n">pst_filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.jco_from_pestpp_runstorage" title="Permalink to this definition">¶</a></dt>
<dd><p>read pars and obs from a pest++ serialized run storage
file (e.g., .rnj) and return jacobian matrix instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rnj_filename</strong> (<cite>str</cite>) – the name of the run storage file</p></li>
<li><p><strong>pst_filename</strong> (<cite>str</cite>) – the name of the pst file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This can then be passed to Jco.to_binary or Jco.to_coo, etc., to write jco
file in a subsequent step to avoid memory resource issues associated
with very large problems.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a jacobian matrix constructed from the run results and
pest control file information.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pyemu.Jco</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.kl_apply">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">kl_apply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_file</span></em>, <em class="sig-param"><span class="n">basis_file</span></em>, <em class="sig-param"><span class="n">par_to_file_dict</span></em>, <em class="sig-param"><span class="n">arr_shape</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.kl_apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a KL parameterization transform from basis factors to model
input arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par_file</strong> (<cite>str</cite>) – the csv file to get factor values from.  Must contain
the following columns: “name”, “new_val”, “org_val”</p></li>
<li><p><strong>basis_file</strong> (<cite>str</cite>) – the PEST-style binary file that contains the reduced
basis</p></li>
<li><p><strong>par_to_file_dict</strong> (<cite>dict</cite>) – a mapping from KL parameter prefixes to array
file names.</p></li>
<li><p><strong>arr_shape</strong> (<em>tuple</em>) – a length 2 tuple of number of rows and columns
the resulting arrays should have.</p></li>
<li><p><strong>Note</strong> – This is the companion function to kl_setup.
This function should be called during the forward run</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.kl_setup">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">kl_setup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_eig</span></em>, <em class="sig-param"><span class="n">sr</span></em>, <em class="sig-param"><span class="n">struct</span></em>, <em class="sig-param"><span class="n">prefixes</span></em>, <em class="sig-param"><span class="n">factors_file</span><span class="o">=</span><span class="default_value">'kl_factors.dat'</span></em>, <em class="sig-param"><span class="n">islog</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">basis_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tpl_dir</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.kl_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>setup a karhuenen-Loeve based parameterization for a given
geostatistical structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_eig</strong> (<cite>int</cite>) – the number of basis vectors to retain in the
reduced basis</p></li>
<li><p><strong>sr</strong> (<cite>flopy.reference.SpatialReference</cite>) – a spatial reference instance</p></li>
<li><p><strong>struct</strong> (<cite>str</cite>) – a PEST-style structure file.  Can also be a
<cite>pyemu.geostats.Geostruct</cite> instance.</p></li>
<li><p><strong>prefixes</strong> ([<cite>str</cite>]) – a list of parameter prefixes to generate KL
parameterization for.</p></li>
<li><p><strong>factors_file</strong> (<cite>str</cite>, optional) – name of the PEST-style interpolation
factors file to write (can be processed with FAC2REAL).
Default is “kl_factors.dat”.</p></li>
<li><p><strong>islog</strong> (<cite>bool</cite>, optional) – flag to indicate if the parameters are log transformed.
Default is True</p></li>
<li><p><strong>basis_file</strong> (<cite>str</cite>, optional) – the name of the PEST-style binary (e.g. jco)
file to write the reduced basis vectors to.  Default is None (not saved).</p></li>
<li><p><strong>tpl_dir</strong> (<cite>str</cite>, optional) – the directory to write the resulting
template files to.  Default is “.” (current directory).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe of parameter information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the companion function to <cite>helpers.apply_kl()</cite></p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;mymodel.nam&quot;</span><span class="p">)</span>
<span class="n">prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hk&quot;</span><span class="p">,</span><span class="s2">&quot;vka&quot;</span><span class="p">,</span><span class="s2">&quot;ss&quot;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">kl_setup</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span><span class="s2">&quot;struct.dat&quot;</span><span class="p">,</span><span class="n">prefixes</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.parse_dir_for_io_files">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">parse_dir_for_io_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">prepend_path</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.parse_dir_for_io_files" title="Permalink to this definition">¶</a></dt>
<dd><p>find template/input file pairs and instruction file/output file
pairs by extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<cite>str</cite>) – directory to search for interface files</p></li>
<li><p><strong>prepend_path</strong> (<cite>bool</cite>, optional) – flag to prepend <cite>d</cite> to each file name.
Default is False</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the return values from this function can be passed straight to
<cite>pyemu.Pst.from_io_files()</cite> classmethod constructor. Assumes the
template file names are &lt;input_file&gt;.tpl and instruction file names
are &lt;output_file&gt;.ins.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>[`str`]</strong>: list of template files in d</p></li>
<li><p><strong>[`str`]</strong>: list of input files in d</p></li>
<li><p><strong>[`str`]</strong>: list of instruction files in d</p></li>
<li><p><strong>[`str`]</strong>: list of output files in d</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.pst_from_io_files">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">pst_from_io_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tpl_files</span></em>, <em class="sig-param"><span class="n">in_files</span></em>, <em class="sig-param"><span class="n">ins_files</span></em>, <em class="sig-param"><span class="n">out_files</span></em>, <em class="sig-param"><span class="n">pst_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pst_path</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.pst_from_io_files" title="Permalink to this definition">¶</a></dt>
<dd><p>create a Pst instance from model interface files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tpl_files</strong> ([<cite>str</cite>]) – list of template file names</p></li>
<li><p><strong>in_files</strong> ([<cite>str</cite>]) – list of model input file names (pairs with template files)</p></li>
<li><p><strong>ins_files</strong> ([<cite>str</cite>]) – list of instruction file names</p></li>
<li><p><strong>out_files</strong> ([<cite>str</cite>]) – list of model output file names (pairs with instruction files)</p></li>
<li><p><strong>pst_filename</strong> (<cite>str</cite>) – name of control file to write.  If None, no file is written.
Default is None</p></li>
<li><p><strong>pst_path</strong> (<cite>str</cite>) – the path to append to the template_file and in_file in the control file.  If
not None, then any existing path in front of the template or in file is split off
and pst_path is prepended.  If python is being run in a directory other than where the control
file will reside, it is useful to pass <cite>pst_path</cite> as <cite>.</cite>.  Default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new control file instance with parameter and observation names
found in <cite>tpl_files</cite> and <cite>ins_files</cite>, repsectively.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Pst</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>calls <cite>pyemu.helpers.pst_from_io_files()</cite></p>
<p>Assigns generic values for parameter info.  Tries to use INSCHEK
to set somewhat meaningful observation values</p>
<p>all file paths are relatively to where python is running.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tpl_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my.tpl&quot;</span><span class="p">]</span>
<span class="n">in_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my.in&quot;</span><span class="p">]</span>
<span class="n">ins_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my.ins&quot;</span><span class="p">]</span>
<span class="n">out_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my.out&quot;</span><span class="p">]</span>
<span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="o">.</span><span class="n">from_io_files</span><span class="p">(</span><span class="n">tpl_files</span><span class="p">,</span><span class="n">in_files</span><span class="p">,</span><span class="n">ins_files</span><span class="p">,</span><span class="n">out_files</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">control_data</span><span class="o">.</span><span class="n">noptmax</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;my.pst)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.pst_from_parnames_obsnames">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">pst_from_parnames_obsnames</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parnames</span></em>, <em class="sig-param"><span class="n">obsnames</span></em>, <em class="sig-param"><span class="n">tplfilename</span><span class="o">=</span><span class="default_value">'model.input.tpl'</span></em>, <em class="sig-param"><span class="n">insfilename</span><span class="o">=</span><span class="default_value">'model.output.ins'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.pst_from_parnames_obsnames" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Pst object from a list of parameter names and a list of observation names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parnames</strong> (<cite>str</cite>) – list of parameter names</p></li>
<li><p><strong>obsnames</strong> (<cite>str</cite>) – list of observation names</p></li>
<li><p><strong>tplfilename</strong> (<cite>str</cite>) – template filename. Default is  “model.input.tpl”</p></li>
<li><p><strong>insfilename</strong> (<cite>str</cite>) – instruction filename. Default is “model.output.ins”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the generic control file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Pst</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.read_pestpp_runstorage">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">read_pestpp_runstorage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">irun</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">with_metadata</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.read_pestpp_runstorage" title="Permalink to this definition">¶</a></dt>
<dd><p>read pars and obs from a specific run in a pest++ serialized
run storage file into dataframes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – the name of the run storage file</p></li>
<li><p><strong>irun</strong> (<cite>int</cite>) – the run id to process. If ‘all’, then all runs are
read. Default is 0</p></li>
<li><p><strong>with_metadata</strong> (<cite>bool</cite>) – flag to return run stats and info txt as well</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>pandas.DataFrame</strong>: parameter information</p></li>
<li><p><strong>pandas.DataFrame</strong>: observation information</p></li>
<li><p><strong>pandas.DataFrame</strong>: optionally run status and info txt.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.setup_fake_forward_run">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">setup_fake_forward_run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">new_pst_name</span></em>, <em class="sig-param"><span class="n">org_cwd</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">bak_suffix</span><span class="o">=</span><span class="default_value">'._bak'</span></em>, <em class="sig-param"><span class="n">new_cwd</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.setup_fake_forward_run" title="Permalink to this definition">¶</a></dt>
<dd><p>setup a fake forward run for a pst.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – existing control file</p></li>
<li><p><strong>new_pst_name</strong> (<cite>str</cite>) – new control file to write</p></li>
<li><p><strong>org_cwd</strong> (<cite>str</cite>) – existing working dir.  Default is “.”</p></li>
<li><p><strong>bak_suffix</strong> (<cite>str</cite>, optional) – suffix to add to existing
model output files when making backup copies.</p></li>
<li><p><strong>new_cwd</strong> (<cite>str</cite>) – new working dir.  Default is “.”.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The fake forward run simply copies existing backup versions of
model output files to the outfiles pest(pp) is looking
for.  This is really a development option for debugging
PEST++ issues.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.setup_temporal_diff_obs">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">setup_temporal_diff_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">ins_file</span></em>, <em class="sig-param"><span class="n">out_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_zero_weight</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">include_path</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sort_by_name</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">long_names</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">'dif'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.setup_temporal_diff_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>a helper function to setup difference-in-time observations based on an existing
set of observations in an instruction file using the observation grouping in the
control file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – existing control file</p></li>
<li><p><strong>ins_file</strong> (<cite>str</cite>) – an existing instruction file</p></li>
<li><p><strong>out_file</strong> (<cite>str</cite>, optional) – an existing model output file that corresponds to
the instruction file.  If None, <cite>ins_file.replace(“.ins”,””)</cite> is used</p></li>
<li><p><strong>include_zero_weight</strong> (<cite>bool</cite>, optional) – flag to include zero-weighted observations
in the difference observation process.  Default is False so that only non-zero
weighted observations are used.</p></li>
<li><p><strong>include_path</strong> (<cite>bool</cite>, optional) – flag to setup the binary file processing in directory where the hds_file
is located (if different from where python is running).  This is useful for setting up
the process in separate directory for where python is running.</p></li>
<li><p><strong>sort_by_name</strong> (<cite>bool</cite>,optional) – flag to sort observation names in each group prior to setting up
the differencing.  The order of the observations matters for the differencing.  If False, then
the control file order is used.  If observation names have a datetime suffix, make sure the format is
year-month-day to use this sorting.  Default is True</p></li>
<li><p><strong>long_names</strong> (<cite>bool</cite>, optional) – flag to use long, descriptive names by concating the two observation names
that are being differenced.  This will produce names that are too long for tradtional PEST(_HP).
Default is True.</p></li>
<li><p><strong>prefix</strong> (<cite>str</cite>, optional) – prefix to prepend to observation names and group names.  Default is “dif”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple containing</p>
<ul class="simple">
<li><p><strong>str</strong>: the forward run command to execute the binary file process during model runs.</p></li>
<li><p><strong>pandas.DataFrame</strong>: a dataframe of observation information for use in the pest control file</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this is the companion function of <cite>helpers.apply_temporal_diff_obs()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.simple_ins_from_obs">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">simple_ins_from_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obsnames</span></em>, <em class="sig-param"><span class="n">insfilename</span><span class="o">=</span><span class="default_value">'model.output.ins'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.simple_ins_from_obs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>write a simple instruction file that reads the values named</dt><dd><p>in obsnames in order, one per line from a model output file</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsnames</strong> (<cite>str</cite>) – list of observation names to put in the
new instruction file</p></li>
<li><p><strong>insfilename</strong> (<cite>str</cite>) – the name of the instruction file to
create. Default is “model.output.ins”</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>writes a file <cite>insfilename</cite> with each observation read off
of a single line</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.simple_tpl_from_pars">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">simple_tpl_from_pars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parnames</span></em>, <em class="sig-param"><span class="n">tplfilename</span><span class="o">=</span><span class="default_value">'model.input.tpl'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.simple_tpl_from_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a simple template file from a list of parameter names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parnames</strong> ([<cite>str</cite>]) – list of parameter names to put in the
new template file</p></li>
<li><p><strong>tplfilename</strong> (<cite>str</cite>) – Name of the template file to create.  Default
is “model.input.tpl”</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>writes a file <cite>tplfilename</cite> with each parameter name in <cite>parnames</cite> on a line</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.write_const_tpl">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">write_const_tpl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">tpl_file</span></em>, <em class="sig-param"><span class="n">suffix</span></em>, <em class="sig-param"><span class="n">zn_array</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shape</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">longnames</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.write_const_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a constant (uniform) template file for a 2-D array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>) – the base parameter name</p></li>
<li><p><strong>tpl_file</strong> (<cite>str</cite>) – the template file to write</p></li>
<li><p><strong>zn_array</strong> (<cite>numpy.ndarray</cite>, optional) – an array used to skip inactive cells,
and optionally get shape info.</p></li>
<li><p><strong>shape</strong> (<cite>tuple</cite>) – tuple nrow and ncol.  Either <cite>zn_array</cite> or <cite>shape</cite>
must be passed</p></li>
<li><p><strong>longnames</strong> (<cite>bool</cite>) – flag to use longer names that exceed 12 chars in length.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with parameter information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.write_grid_tpl">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">write_grid_tpl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">tpl_file</span></em>, <em class="sig-param"><span class="n">suffix</span></em>, <em class="sig-param"><span class="n">zn_array</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shape</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spatial_reference</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">longnames</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.write_grid_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a grid-based template file for a 2-D array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>) – the base parameter name</p></li>
<li><p><strong>tpl_file</strong> (<cite>str</cite>) – the template file to write - include path</p></li>
<li><p><strong>zn_array</strong> (<cite>numpy.ndarray</cite>, optional) – zone array to identify
inactive cells.  Default is None</p></li>
<li><p><strong>shape</strong> (<cite>tuple</cite>, optional) – a length-two tuple of nrow and ncol.  Either
<cite>zn_array</cite> or <cite>shape</cite> must be passed.</p></li>
<li><p><strong>spatial_reference</strong> (<cite>flopy.utils.SpatialReference</cite>) – a spatial reference instance.
If <cite>longnames</cite> is True, then <cite>spatial_reference</cite> is used to add spatial info
to the parameter names.</p></li>
<li><p><strong>longnames</strong> (<cite>bool</cite>) – flag to use longer names that exceed 12 chars in length.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with parameter information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.write_zone_tpl">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">write_zone_tpl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">tpl_file</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">zn_array</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shape</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">longnames</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">'1.0'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.write_zone_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a zone-based template file for a 2-D array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>) – the base parameter name</p></li>
<li><p><strong>tpl_file</strong> (<cite>str</cite>) – the template file to write</p></li>
<li><p><strong>suffix</strong> (<cite>str</cite>) – suffix to add to parameter names.  Only used if <cite>longnames=True</cite></p></li>
<li><p><strong>zn_array</strong> (<cite>numpy.ndarray</cite>, optional) – an array used to skip inactive cells,
and optionally get shape info.  zn_array values less than 1 are given <cite>fill_value</cite></p></li>
<li><p><strong>shape</strong> (<cite>tuple</cite>) – tuple nrow and ncol.  Either <cite>zn_array</cite> or <cite>shape</cite>
must be passed</p></li>
<li><p><strong>longnames</strong> (<cite>bool</cite>) – flag to use longer names that exceed 12 chars in length.
Default is False.</p></li>
<li><p><strong>fill_value</strong> (<cite>str</cite>) – value to fill locations where <cite>zn_array</cite> is less than 1.0.
Default is “1.0”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with parameter information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.helpers.zero_order_tikhonov">
<code class="sig-prename descclassname">pyemu.utils.helpers.</code><code class="sig-name descname">zero_order_tikhonov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">parbounds</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">par_groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reset</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.helpers.zero_order_tikhonov" title="Permalink to this definition">¶</a></dt>
<dd><p>setup preferred-value regularization in a pest control file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pst</strong> (<cite>pyemu.Pst</cite>) – the control file instance</p></li>
<li><p><strong>parbounds</strong> (<cite>bool</cite>, optional) – flag to weight the new prior information
equations according to parameter bound width - approx the KL
transform. Default is True</p></li>
<li><p><strong>par_groups</strong> (<cite>list</cite>) – a list of parameter groups to build PI equations for.
If None, all adjustable parameters are used. Default is None</p></li>
<li><p><strong>reset</strong> (<cite>bool</cite>) – a flag to remove any existing prior information equations
in the control file.  Default is True</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="s2">&quot;my.pst&quot;</span><span class="p">)</span>
<span class="n">pyemu</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">zero_order_tikhonov</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;my_reg.pst&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.optimization">
<span id="pyemu-utils-optimization-module"></span><h2>pyemu.utils.optimization module<a class="headerlink" href="#module-pyemu.utils.optimization" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyemu.utils.optimization.add_pi_obj_func">
<code class="sig-prename descclassname">pyemu.utils.optimization.</code><code class="sig-name descname">add_pi_obj_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pst</span></em>, <em class="sig-param"><span class="n">obj_func_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">out_pst_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.optimization.add_pi_obj_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyemu.utils.os_utils">
<span id="pyemu-utils-os-utils-module"></span><h2>pyemu.utils.os_utils module<a class="headerlink" href="#module-pyemu.utils.os_utils" title="Permalink to this headline">¶</a></h2>
<p>Operating system utilities in the PEST(++) realm</p>
<dl class="py function">
<dt id="pyemu.utils.os_utils.run">
<code class="sig-prename descclassname">pyemu.utils.os_utils.</code><code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cmd_str</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.os_utils.run" title="Permalink to this definition">¶</a></dt>
<dd><p>an OS agnostic function to execute a command line</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmd_str</strong> (<cite>str</cite>) – the str to execute with <cite>os.system()</cite></p></li>
<li><p><strong>cwd</strong> (<cite>str</cite>, optional) – the directory to execute the command in.
Default is “.”.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, optional) – flag to echo to stdout the  <cite>cmd_str</cite>.
Default is <cite>False</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>uses <cite>platform</cite> to detect OS and adds .exe suffix or ./ prefix as appropriate
if <cite>os.system</cite> returns non-zero, an exception is raised</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyemu</span><span class="o">.</span><span class="n">os_utils</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pestpp-ies my.pst&quot;</span><span class="p">,</span><span class="n">cwd</span><span class="o">=</span><span class="s2">&quot;template&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.os_utils.start_workers">
<code class="sig-prename descclassname">pyemu.utils.os_utils.</code><code class="sig-name descname">start_workers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">worker_dir</span></em>, <em class="sig-param"><span class="n">exe_rel_path</span></em>, <em class="sig-param"><span class="n">pst_rel_path</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">worker_root</span><span class="o">=</span><span class="default_value">'..'</span></em>, <em class="sig-param"><span class="n">port</span><span class="o">=</span><span class="default_value">4004</span></em>, <em class="sig-param"><span class="n">rel_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">local</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">cleanup</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">master_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">silent_master</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">reuse_master</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.os_utils.start_workers" title="Permalink to this definition">¶</a></dt>
<dd><p>start a group of pest(++) workers on the local machine</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>worker_dir</strong> (<cite>str</cite>) – the path to a complete set of input files need by PEST(++).
This directory will be copied to make worker (and optionally the master)
directories</p></li>
<li><p><strong>exe_rel_path</strong> (<cite>str</cite>) – the relative path to and name of the pest(++) executable from within
the <cite>worker_dir</cite>.  For example, if the executable is up one directory from
<cite>worker_dir</cite>, the <cite>exe_rel_path</cite> would be <cite>os.path.join(“..”,”pestpp-ies”)</cite></p></li>
<li><p><strong>pst_rel_path</strong> (<cite>str</cite>) – the relative path to and name of the pest control file from within
<cite>worker_dir</cite>.</p></li>
<li><p><strong>num_workers</strong> (<cite>int</cite>, optional) – number of workers to start. defaults to number of cores</p></li>
<li><p><strong>worker_root</strong> (<cite>str</cite>, optional) – the root directory to make the new worker directories in.
Default is “..”  (up one directory from where python is running).</p></li>
<li><p><strong>rel_path</strong> (<cite>str</cite>, optional) – the relative path to where pest(++) should be run
from within the worker_dir, defaults to the uppermost level of the worker dir.
This option is usually not needed unless you are one of those crazy people who
spreads files across countless subdirectories.</p></li>
<li><p><strong>local</strong> (<cite>bool</cite>, optional) – flag for using “localhost” instead of actual hostname/IP address on
worker command line. Default is True</p></li>
<li><p><strong>cleanup</strong> (<cite>bool</cite>, optional) – flag to remove worker directories once processes exit. Default is
True.  Set to False for debugging issues</p></li>
<li><p><strong>master_dir</strong> (<cite>str</cite>) – name of directory for master instance.  If <cite>master_dir</cite>
exists, then it will be REMOVED!!!  If <cite>master_dir</cite>, is None,
no master instance will be started.  If not None, a copy of <cite>worker_dir</cite> will be
made into <cite>master_dir</cite> and the PEST(++) executable will be started in master mode
in this directory. Default is None</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, optional) – flag to echo useful information to stdout.  Default is False</p></li>
<li><p><strong>silent_master</strong> (<cite>bool</cite>, optional) – flag to pipe master output to devnull and instead print
a simple message to stdout every few seconds.  This is only for
pestpp Travis testing so that log file sizes dont explode. Default is False</p></li>
<li><p><strong>reuse_master</strong> (<cite>bool</cite>) – flag to use an existing <cite>master_dir</cite> as is - this is an advanced user
option for cases where you want to construct your own <cite>master_dir</cite> then have an async
process started in it by this function.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>if all workers (and optionally master) exit gracefully, then the worker</dt><dd><p>dirs will be removed unless <cite>cleanup</cite> is False</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># start 10 workers using the directory &quot;template&quot; as the base case and</span>
<span class="c1"># also start a master instance in a directory &quot;master&quot;.</span>
<span class="n">pyemu</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">start_workers</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span><span class="s2">&quot;pestpp-ies&quot;</span><span class="p">,</span><span class="s2">&quot;pest.pst&quot;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">master_dir</span><span class="o">=</span><span class="s2">&quot;master&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.pp_utils">
<span id="pyemu-utils-pp-utils-module"></span><h2>pyemu.utils.pp_utils module<a class="headerlink" href="#module-pyemu.utils.pp_utils" title="Permalink to this headline">¶</a></h2>
<p>Pilot point support utilities</p>
<dl class="py function">
<dt id="pyemu.utils.pp_utils.pilot_points_to_tpl">
<code class="sig-prename descclassname">pyemu.utils.pp_utils.</code><code class="sig-name descname">pilot_points_to_tpl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pp_file</span></em>, <em class="sig-param"><span class="n">tpl_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name_prefix</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">longnames</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pp_utils.pilot_points_to_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for a pilot points file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pp_file</strong> – (<cite>str</cite>): existing pilot points file</p></li>
<li><p><strong>tpl_file</strong> (<cite>str</cite>) – template file name to write.  If None,
<cite>pp_file`+”.tpl” is used.  Default is `None</cite>.</p></li>
<li><p><strong>name_prefix</strong> (<cite>str</cite>) – name to prepend to parameter names for each
pilot point.  For example, if <cite>name_prefix = “hk_”</cite>, then each
pilot point parameters will be named “hk_0001”,”hk_0002”, etc.
If None, parameter names from <cite>pp_df.name</cite> are used.
Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with pilot point information
(name,x,y,zone,parval1) with the parameter information
(parnme,tpl_str)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.pp_utils.pp_file_to_dataframe">
<code class="sig-prename descclassname">pyemu.utils.pp_utils.</code><code class="sig-name descname">pp_file_to_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pp_filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pp_utils.pp_file_to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>read a pilot point file to a pandas Dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pp_filename</strong> (<cite>str</cite>) – path and name of an existing pilot point file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with <cite>pp_utils.PP_NAMES</cite> for columns</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">pp_utils</span><span class="o">.</span><span class="n">pp_file_to_dataframe</span><span class="p">(</span><span class="s2">&quot;my_pp.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.pp_utils.pp_tpl_to_dataframe">
<code class="sig-prename descclassname">pyemu.utils.pp_utils.</code><code class="sig-name descname">pp_tpl_to_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tpl_filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pp_utils.pp_tpl_to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>read a pilot points template file to a pandas dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tpl_filename</strong> (<cite>str</cite>) – path and name of an existing pilot points
template file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe of pilot point info with “parnme” included</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Use for processing pilot points since the point point file itself may
have generic “names”.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">pp_utils</span><span class="o">.</span><span class="n">pp_tpl_file_to_dataframe</span><span class="p">(</span><span class="s2">&quot;my_pp.dat.tpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.pp_utils.setup_pilotpoints_grid">
<code class="sig-prename descclassname">pyemu.utils.pp_utils.</code><code class="sig-name descname">setup_pilotpoints_grid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ml</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ibound</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prefix_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">every_n_cell</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">ninst</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">use_ibound_zones</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pp_dir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tpl_dir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">shapename</span><span class="o">=</span><span class="default_value">'pp.shp'</span></em>, <em class="sig-param"><span class="n">longnames</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pp_utils.setup_pilotpoints_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>setup a regularly-spaced (gridded) pilot point parameterization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ml</strong> (<cite>flopy.mbase</cite>, optional) – a flopy mbase dervied type.  If None, <cite>sr</cite> must not be None.</p></li>
<li><p><strong>sr</strong> (<cite>flopy.utils.reference.SpatialReference</cite>, optional) – a spatial reference use to
locate the model grid in space.  If None, <cite>ml</cite> must not be None.  Default is None</p></li>
<li><p><strong>ibound</strong> (<cite>numpy.ndarray</cite>, optional) – the modflow ibound integer array.  THis is used to
set pilot points only in active areas. If None and ml is None, then pilot points
are set in all rows and columns according to <cite>every_n_cell</cite>.  Default is None.</p></li>
<li><p><strong>prefix_dict</strong> (<cite>dict</cite>) – a dictionary of layer index, pilot point parameter prefix(es) pairs.
For example : <cite>{0:[“hk,”vk”]}</cite> would setup pilot points with the prefix “hk” and “vk” for
model layer 1. If None, a generic set of pilot points with
the “pp” prefix are setup for a generic nrow by ncol grid. Default is None</p></li>
<li><p><strong>ninst</strong> (<cite>int</cite>) – Number of instances of pilot_points to set up.
e.g. number of layers. If ml is None and prefix_dict is None,
this is used to set up default prefix_dict.</p></li>
<li><p><strong>use_ibound_zones</strong> (<cite>bool</cite>) – a flag to use the greater-than-zero values in the
ibound as pilot point zones.  If False ,ibound values greater than zero are
treated as a single zone.  Default is False.</p></li>
<li><p><strong>pp_dir</strong> (<cite>str</cite>, optional) – directory to write pilot point files to.  Default is ‘.’</p></li>
<li><p><strong>tpl_dir</strong> (<cite>str</cite>, optional) – directory to write pilot point template file to.  Default is ‘.’</p></li>
<li><p><strong>shapename</strong> (<cite>str</cite>, optional) – name of shapefile to write that contains pilot
point information. Default is “pp.shp”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe summarizing pilot point information (same information
written to <cite>shapename</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my.nam&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">pp_utils</span><span class="o">.</span><span class="n">setup_pilotpoints_grid</span><span class="p">(</span><span class="n">ml</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.pp_utils.write_pp_file">
<code class="sig-prename descclassname">pyemu.utils.pp_utils.</code><code class="sig-name descname">write_pp_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">pp_df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pp_utils.write_pp_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a pilot points dataframe to a pilot points file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – pilot points file to write</p></li>
<li><p><strong>pp_df</strong> (<cite>pandas.DataFrame</cite>) – a dataframe that has
at least columns “x”,”y”,”zone”, and “value”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.pp_utils.write_pp_shapfile">
<code class="sig-prename descclassname">pyemu.utils.pp_utils.</code><code class="sig-name descname">write_pp_shapfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pp_df</span></em>, <em class="sig-param"><span class="n">shapename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pp_utils.write_pp_shapfile" title="Permalink to this definition">¶</a></dt>
<dd><p>write pilot points dataframe to a shapefile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pp_df</strong> (<cite>pandas.DataFrame</cite>) – pilot point dataframe (must include “x” and “y”
columns).  If <cite>pp_df</cite> is a string, it is assumed to be a pilot points file
and is loaded with <cite>pp_utils.pp_file_to_dataframe</cite>. Can also be a list of
<cite>pandas.DataFrames</cite> and/or filenames.</p></li>
<li><p><strong>shapename</strong> (<cite>str</cite>) – the shapefile name to write.  If <cite>None</cite> , <cite>pp_df</cite> must be a string
and shapefile is saved as <cite>pp_df</cite> +”.shp”</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>requires pyshp</p>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.pst_from">
<span id="pyemu-utils-pst-from-module"></span><h2>pyemu.utils.pst_from module<a class="headerlink" href="#module-pyemu.utils.pst_from" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyemu.utils.pst_from.PstFrom">
<em class="property">class </em><code class="sig-prename descclassname">pyemu.utils.pst_from.</code><code class="sig-name descname">PstFrom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">original_d</span></em>, <em class="sig-param"><span class="n">new_d</span></em>, <em class="sig-param"><span class="n">longnames</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">remove_existing</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">spatial_reference</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zero_based</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">start_datetime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>construct high-dimensional PEST(++) interfaces with all the bells and whistles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_d</strong> (<cite>str</cite>) – the path to a complete set of model input and output files</p></li>
<li><p><strong>new_d</strong> (<cite>str</cite>) – the path to where the model files and PEST interface files will be copied/built</p></li>
<li><p><strong>longnames</strong> (<cite>bool</cite>) – flag to use longer-than-PEST-likes parameter and observation names.  Default is True</p></li>
<li><p><strong>remove_existing</strong> (<cite>bool</cite>) – flag to destroy any existing files and folders in <cite>new_d</cite>.  Default is False</p></li>
<li><p><strong>spatial_reference</strong> (<em>varies</em>) – an object that faciliates geo-locating model cells based on index.  Default is None</p></li>
<li><p><strong>zero_based</strong> (<cite>bool</cite>) – flag if the model uses zero-based indices, Default is True</p></li>
<li><p><strong>start_datetime</strong> (<cite>str</cite>) – a string that can be case to a datatime instance the represents the starting datetime
of the model</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.add_observations">
<code class="sig-name descname">add_observations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">insfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">index_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_rows</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">ofile_skip</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ofile_sep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rebuild_pst</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">obsgp</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.add_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Add list style outputs as observation files to PstFrom object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – path to model output file name to set up
as observations</p></li>
<li><p><strong>insfile</strong> (<cite>str</cite>) – desired instructions file filename</p></li>
<li><p><strong>index_cols</strong> (<cite>list</cite>-like or <cite>int</cite>) – columns to denote are indices for obs</p></li>
<li><p><strong>use_cols</strong> (<cite>list</cite>-like or <cite>int</cite>) – columns to set up as obs</p></li>
<li><p><strong>use_rows</strong> (<cite>list</cite>-like or <cite>int</cite>) – select only specific row of file for obs</p></li>
<li><p><strong>prefix</strong> (<cite>str</cite>) – prefix for obsnmes</p></li>
<li><p><strong>ofile_skip</strong> (<cite>int</cite>) – number of lines to skip in model output file</p></li>
<li><p><strong>ofile_sep</strong> (<cite>str</cite>) – delimiter in output file</p></li>
<li><p><strong>rebuild_pst</strong> (<cite>bool</cite>) – (Re)Construct PstFrom.pst object after adding
new obs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe with info for new observations</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>Pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.add_observations_from_ins">
<code class="sig-name descname">add_observations_from_ins</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ins_file</span></em>, <em class="sig-param"><span class="n">out_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pst_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inschek</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.add_observations_from_ins" title="Permalink to this definition">¶</a></dt>
<dd><p>add new observations to a control file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ins_file</strong> (<cite>str</cite>) – instruction file with exclusively new
observation names</p></li>
<li><p><strong>out_file</strong> (<cite>str</cite>) – model output file.  If None, then
ins_file.replace(“.ins”,””) is used. Default is None</p></li>
<li><p><strong>pst_path</strong> (<cite>str</cite>) – the path to append to the instruction file and
out file in the control file.  If not None, then any existing
path in front of the template or in file is split off and
pst_path is prepended.  If python is being run in a directory
other than where the control file will reside, it is useful
to pass <cite>pst_path</cite> as <cite>.</cite>. Default is None</p></li>
<li><p><strong>inschek</strong> (<cite>bool</cite>) – flag to try to process the existing output file
using the <cite>pyemu.InstructionFile</cite> class.  If successful,
processed outputs are used as obsvals</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>the data for the new observations that were</dt><dd><p>added</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>populates the new observation information with default values</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pst</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">Pst</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="s2">&quot;my.pst&quot;</span><span class="p">))</span>
<span class="n">pst</span><span class="o">.</span><span class="n">add_observations</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span><span class="s2">&quot;new_obs.dat.ins&quot;</span><span class="p">),</span>
                     <span class="n">pst_path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">pst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="s2">&quot;my_new.pst&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.add_parameters">
<code class="sig-name descname">add_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filenames</span></em>, <em class="sig-param"><span class="n">par_type</span></em>, <em class="sig-param"><span class="n">zone_array</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dist_type</span><span class="o">=</span><span class="default_value">'gaussian'</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">4.0</span></em>, <em class="sig-param"><span class="n">upper_bound</span><span class="o">=</span><span class="default_value">10000000000.0</span></em>, <em class="sig-param"><span class="n">lower_bound</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">transform</span><span class="o">=</span><span class="default_value">'log'</span></em>, <em class="sig-param"><span class="n">par_name_base</span><span class="o">=</span><span class="default_value">'p'</span></em>, <em class="sig-param"><span class="n">index_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pargp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pp_space</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">use_pp_zones</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_eig_kl</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">spatial_reference</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">geostruct</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">datetime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mfile_fmt</span><span class="o">=</span><span class="default_value">'free'</span></em>, <em class="sig-param"><span class="n">mfile_skip</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ult_ubound</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ult_lbound</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rebuild_pst</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alt_inst_str</span><span class="o">=</span><span class="default_value">'inst'</span></em>, <em class="sig-param"><span class="n">comment_char</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">par_style</span><span class="o">=</span><span class="default_value">'multiplier'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.add_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Add list or array style model input files to PstFrom object.
This method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filenames</strong> (<cite>str</cite>) – Model input filenames to parameterize</p></li>
<li><p><strong>par_type</strong> (<cite>str</cite>) – One of <cite>grid</cite> - for every element, <cite>constant</cite> - for single
parameter applied to every element, <cite>zone</cite> - for zone-based
parameterization (only for array-style) or <cite>pilotpoint</cite> - for
pilot-point base parameterization of array style input files.
Note <cite>kl</cite> not yet implemented # TODO</p></li>
<li><p><strong>zone_array</strong> (<cite>np.ndarray</cite>) – array defining spatial limits or zones
for parameterization.</p></li>
<li><p><strong>dist_type</strong> – not yet implemented # TODO</p></li>
<li><p><strong>sigma_range</strong> – not yet implemented # TODO</p></li>
<li><p><strong>upper_bound</strong> (<cite>float</cite>) – PEST parameter upper bound # TODO support different ubound,lbound,transform if multiple use_col</p></li>
<li><p><strong>lower_bound</strong> (<cite>float</cite>) – PEST parameter lower bound</p></li>
<li><p><strong>transform</strong> (<cite>str</cite>) – PEST parameter transformation</p></li>
<li><p><strong>par_name_base</strong> (<cite>str</cite>) – basename for parameters that are set up</p></li>
<li><p><strong>index_cols</strong> (<cite>list</cite>-like) – if not None, will attempt to parameterize
expecting a tabular-style model input file. <cite>index_cols</cite>
defines the unique columns used to set up pars.
May be passed as a dictionary using the keys <cite>i</cite> and <cite>j</cite>
to allow columns that relate to model rows and columns to be
identified and processed to x,y.</p></li>
<li><p><strong>use_cols</strong> (<cite>list</cite>-like or <cite>int</cite>) – for tabular-style model input file,
defines the columns to be parameterised</p></li>
<li><p><strong>pargp</strong> (<cite>str</cite>) – Parameter group to assign pars to. This is PESTs
pargp but is also used to gather correlated parameters set up
using multiple <cite>add_parameters()</cite> calls (e.g. temporal pars)
with common geostructs.</p></li>
<li><p><strong>pp_space</strong> (<cite>int</cite>) – Spacing between pilot point parameters</p></li>
<li><p><strong>use_pp_zones</strong> (<cite>bool</cite>) – a flag to use the greater-than-zero values
in the zone_array as pilot point zones.
If False, zone_array values greater than zero are treated as a
single zone.  Default is False.</p></li>
<li><p><strong>num_eig_kl</strong> – TODO - impliment with KL pars</p></li>
<li><p><strong>spatial_reference</strong> (<cite>pyemu.helpers.SpatialReference</cite>) – If different
spatial reference required for pilotpoint setup.
If None spatial reference passed to <cite>PstFrom()</cite> will be used
for pilot-points</p></li>
<li><p><strong>geostruct</strong> (<cite>pyemu.geostats.GeoStruct()</cite>) – For specifying correlation
geostruct for pilot-points and par covariance.</p></li>
<li><p><strong>datetime</strong> (<cite>str</cite>) – <p>optional %Y%m%d string or datetime object for
setting up temporally correlated pars. Where datetime is passed</p>
<blockquote>
<div><p>correlation axis for pars will be set to timedelta.</p>
</div></blockquote>
</p></li>
<li><p><strong>mfile_fmt</strong> (<cite>str</cite>) – format of model input file - this will be preserved</p></li>
<li><p><strong>mfile_skip</strong> (<cite>int</cite> or <cite>str</cite>) – header in model input file to skip
when reading and reapply when writing. Can optionally be <cite>str</cite> in which case <cite>mf_skip</cite> will be treated
as a <cite>comment_char</cite>.</p></li>
<li><p><strong>ult_ubound</strong> (<cite>float</cite>) – Ultimate upper bound for model input
parameter once all mults are applied - ensure physical model par vals. If not passed,
it is set to 1.0e+30</p></li>
<li><p><strong>ult_lbound</strong> (<cite>float</cite>) – Ultimate lower bound for model input
parameter once all mults are applied.  If not passed, it is set to
1.0e-30 for log transform and -1.0e+30 for non-log transform</p></li>
<li><p><strong>rebuild_pst</strong> (<cite>bool</cite>) – (Re)Construct PstFrom.pst object after adding
new parameters</p></li>
<li><p><strong>alt_inst_str</strong> (<cite>str</cite>) – Alternative to default <cite>inst</cite> string in
parameter names</p></li>
<li><p><strong>comment_char</strong> (<cite>str</cite>) – option to skip comment lines in model file.
This is not additive with <cite>mfile_skip</cite> option.
Warning: currently comment lines within list-like tabular data
will be lost.</p></li>
<li><p><strong>par_style</strong> (<cite>str</cite>) – either “multiplier” or “direct” where the former setups
up a multiplier parameter process against the exsting model input
array and the former setups a template file to write the model
input file directly.  Default is “multiplier”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe with info for new parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.add_py_function">
<code class="sig-name descname">add_py_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">function_name</span></em>, <em class="sig-param"><span class="n">is_pre_cmd</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.add_py_function" title="Permalink to this definition">¶</a></dt>
<dd><p>add a python function to the forward run script</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<cite>str</cite>) – a python source file</p></li>
<li><p><strong>function_name</strong> (<cite>str</cite>) – a python function in
<cite>file_name</cite></p></li>
<li><p><strong>is_pre_cmd</strong> (<cite>bool</cite>) – flag to include <cite>function_name</cite> in
PstFrom.pre_py_cmds.  If False, <cite>function_name</cite> is
added to PstFrom.post_py_cmds instead. If passed as <cite>None</cite>,
then the function <cite>function_name</cite> is added to the forward run
script but is not called.  Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt><cite>function_name</cite> is expected to be standalone a function</dt><dd><p>that contains all the imports it needs or these imports
should have been added to the forward run script through the
<cite>PstFrom.py_imports</cite> list.</p>
</dd>
<dt>This function adds the <cite>function_name</cite> call to the forward</dt><dd><dl class="simple">
<dt>run script (either as a pre or post command). It is up to users</dt><dd><dl class="simple">
<dt>to make sure <cite>function_name</cite> is a valid python function call</dt><dd><p>that includes the parentheses and requisite arguments</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>This function expects “def ” + <cite>function_name</cite> to be flushed left at the outer</dt><dd><p>most indentation level</p>
</dd>
</dl>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pf</span> <span class="o">=</span> <span class="n">PstFrom</span><span class="p">()</span>
<span class="n">pf</span><span class="o">.</span><span class="n">add_py_function</span><span class="p">(</span><span class="s2">&quot;preprocess.py&quot;</span><span class="p">,</span><span class="s2">&quot;mult_well_function()&quot;</span><span class="p">,</span><span class="n">is_pre_cmd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.build_prior">
<code class="sig-name descname">build_prior</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">'ascii'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">droptol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunk</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">6</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.build_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the prior parameter covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmt</strong> (<cite>str</cite>) – the file format to save to.  Default is “ASCII”, can be “binary”, “coo”, or “none”</p></li>
<li><p><strong>filename</strong> (<cite>str</cite>) – the filename to save the cov to</p></li>
<li><p><strong>droptol</strong> (<cite>float</cite>) – absolute value of prior cov entries that are smaller than <cite>droptol</cite> are treated as
zero.</p></li>
<li><p><strong>chunk</strong> (<cite>int</cite>) – number of entries to write to binary/coo at once.  Default is None (write all elements at once</p></li>
<li><p><strong>sigma_range</strong> (<cite>int</cite>) – number of standard deviations represented by parameter bounds.  Default is 6 (99%
confidence).  4 would be approximately 95% confidence bounds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the prior parameter covariance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.Cov</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method processes parameters by group names</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.build_pst">
<code class="sig-name descname">build_pst</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">update</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">version</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.build_pst" title="Permalink to this definition">¶</a></dt>
<dd><p>Build control file from i/o files in PstFrom object.
Warning: This builds a pest control file from scratch, overwriting
anything already in self.pst object and anything already writen to <cite>filename</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – the filename to save the control file to.
If None, the name is formed from the <cite>PstFrom.original_d</cite>
,the orginal directory name from which the forward model
was extracted.  Default is None.
The control file is saved in the <cite>PstFrom.new_d</cite> directory.</p></li>
<li><p><strong>update</strong> (<em>bool</em><em>) or </em><em>(</em><em>str</em>) – flag to add to existing Pst object and
rewrite. If string {‘pars’, ‘obs’} just update respective
components of Pst. Default is False - build from PstFrom
components.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>This builds a pest control file from scratch, overwriting anything already</dt><dd><p>in self.pst object and anything already writen to <cite>filename</cite></p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_reals</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">use_specsim</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">scale_offset</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a parameter ensemble from the distribution implied by the initial parameter values in the
control file and the prior parameter covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_reals</strong> (<cite>int</cite>) – the number of realizations to draw</p></li>
<li><p><strong>sigma_range</strong> (<cite>int</cite>) – number of standard deviations represented by parameter bounds.  Default is 6 (99%
confidence).  4 would be approximately 95% confidence bounds</p></li>
<li><p><strong>use_specsim</strong> (<cite>bool</cite>) – flag to use spectral simulation for grid-scale pars (highly recommended).
Default is False</p></li>
<li><p><strong>scale_offset</strong> (<cite>bool</cite>) – flag to apply scale and offset to parameter bounds before calculating prior variance.
Dfault is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a prior parameter ensemble</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyemu.ParameterEnsemble</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method draws by parameter group</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.initialize_spatial_reference">
<code class="sig-name descname">initialize_spatial_reference</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.initialize_spatial_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>process the spatial reference argument</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.parfile_relations">
<em class="property">property </em><code class="sig-name descname">parfile_relations</code><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.parfile_relations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.parse_kij_args">
<code class="sig-name descname">parse_kij_args</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.parse_kij_args" title="Permalink to this definition">¶</a></dt>
<dd><p>parse args into kij indices</p>
</dd></dl>

<dl class="py method">
<dt id="pyemu.utils.pst_from.PstFrom.write_forward_run">
<code class="sig-name descname">write_forward_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.PstFrom.write_forward_run" title="Permalink to this definition">¶</a></dt>
<dd><p>write the forward run script</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.pst_from.write_array_tpl">
<code class="sig-prename descclassname">pyemu.utils.pst_from.</code><code class="sig-name descname">write_array_tpl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">tpl_filename</span></em>, <em class="sig-param"><span class="n">suffix</span></em>, <em class="sig-param"><span class="n">par_type</span></em>, <em class="sig-param"><span class="n">zone_array</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gpname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shape</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">longnames</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">get_xy</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">input_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">par_style</span><span class="o">=</span><span class="default_value">'multiplier'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.write_array_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for a 2D array.</p>
<blockquote>
<div><dl>
<dt>Args:</dt><dd><p>name (<cite>str</cite>): the base parameter name
tpl_filename (<cite>str</cite>): the template file to write - include path
suffix (<cite>str</cite>): suffix to append to par names
par_type (<cite>str</cite>): type of parameter
zone_array (<cite>numpy.ndarray</cite>): an array used to skip inactive cells. Values less than 1 are</p>
<blockquote>
<div><p>not parameterized and are assigned a value of fill_value. Default is None.</p>
</div></blockquote>
<p>gpname (<cite>str</cite>): pargp filed in dataframe
shape (<cite>tuple</cite>): dimensions of array to write
longnames (<cite>bool</cite>): Use parnames &gt; 12 char
fill_value:
get_xy:
input_filename:
par_style (<cite>str</cite>): either ‘direct’ or ‘multiplier’</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe with parameter information</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>df (<cite>pandas.DataFrame</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.pst_from.write_list_tpl">
<code class="sig-prename descclassname">pyemu.utils.pst_from.</code><code class="sig-name descname">write_list_tpl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filenames</span></em>, <em class="sig-param"><span class="n">dfs</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">tpl_filename</span></em>, <em class="sig-param"><span class="n">index_cols</span></em>, <em class="sig-param"><span class="n">par_type</span></em>, <em class="sig-param"><span class="n">use_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">zone_array</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gpname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">longnames</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">get_xy</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ij_in_idx</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xy_in_idx</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zero_based</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">input_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">par_style</span><span class="o">=</span><span class="default_value">'multiplier'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.pst_from.write_list_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>Write template files for a list style input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filenames</strong> (<cite>str</cite> of <cite>container</cite> of <cite>str</cite>) – original input filenames</p></li>
<li><p><strong>dfs</strong> (<cite>pandas.DataFrame</cite> or <cite>container</cite> of pandas.DataFrames) – pandas
representations of input file.</p></li>
<li><p><strong>name</strong> (<cite>str</cite> or container of str) – parameter name prefixes.
If more that one column to be parameterised, must be a container
of strings providing the prefix for the parameters in the
different columns.</p></li>
<li><p><strong>tpl_filename</strong> (<cite>str</cite>) – Path (from current execution directory)
for desired template file</p></li>
<li><p><strong>index_cols</strong> (<cite>list</cite>) – column names to use as indices in tabular
input dataframe</p></li>
<li><p><strong>par_type</strong> (<cite>str</cite>) – ‘constant’,’zone’, or ‘grid’ used in parname
generation. If <cite>constant</cite>, one par is set up for each <cite>use_cols</cite>.
If <cite>zone</cite>, one par is set up for each zone for each <cite>use_cols</cite>.
If <cite>grid</cite>, one par is set up for every unique index combination
(from <cite>index_cols</cite>) for each <cite>use_cols</cite>.</p></li>
<li><p><strong>use_cols</strong> (<cite>list</cite>) – Columns in tabular input file to paramerterise.
If None, pars are set up for all columns apart from index cols.</p></li>
<li><p><strong>suffix</strong> (<cite>str</cite>) – Optional par name suffix</p></li>
<li><p><strong>zone_array</strong> (<cite>np.ndarray</cite>) – Array defining zone divisions.
If not None and <cite>par_type</cite> is <cite>grid</cite> or <cite>zone</cite> it is expected that
<cite>index_cols</cite> provide the indicies for
querying <cite>zone_array</cite>. Therefore, array dimension should equal
<cite>len(index_cols)</cite>.</p></li>
<li><p><strong>longnames</strong> (<cite>boolean</cite>) – Specify is pars will be specified without the
12 char restriction - recommended if using Pest++.</p></li>
<li><p><strong>get_xy</strong> (<cite>pyemu.PstFrom</cite> method) – Can be specified to get real-world xy
from <cite>index_cols</cite> passed (to assist correlation definition)</p></li>
<li><p><strong>ij_in_idx</strong> (<cite>list</cite> or <cite>array</cite>) – defining which <cite>index_cols</cite> contain i,j</p></li>
<li><p><strong>xy_in_idx</strong> (<cite>list</cite> or <cite>array</cite>) – defining which <cite>index_cols</cite> contain x,y</p></li>
<li><p><strong>zero_based</strong> (<cite>boolean</cite>) – IMPORTANT - pass as False if <cite>index_cols</cite>
are NOT zero-based indicies (e.g. MODFLOW row/cols).
If False 1 with be subtracted from <cite>index_cols</cite>.</p></li>
<li><p><strong>input_filename</strong> (<cite>str</cite>) – Path to input file (paired with tpl file)</p></li>
<li><p><strong>par_style</strong> (<cite>str</cite>) – either ‘direct’ or ‘multiplier’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe with info for the new parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.smp_utils">
<span id="pyemu-utils-smp-utils-module"></span><h2>pyemu.utils.smp_utils module<a class="headerlink" href="#module-pyemu.utils.smp_utils" title="Permalink to this headline">¶</a></h2>
<p>PEST-style site sample (smp) file support utilities</p>
<dl class="py function">
<dt id="pyemu.utils.smp_utils.dataframe_to_smp">
<code class="sig-prename descclassname">pyemu.utils.smp_utils.</code><code class="sig-name descname">dataframe_to_smp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">smp_filename</span></em>, <em class="sig-param"><span class="n">name_col</span><span class="o">=</span><span class="default_value">'name'</span></em>, <em class="sig-param"><span class="n">datetime_col</span><span class="o">=</span><span class="default_value">'datetime'</span></em>, <em class="sig-param"><span class="n">value_col</span><span class="o">=</span><span class="default_value">'value'</span></em>, <em class="sig-param"><span class="n">datetime_format</span><span class="o">=</span><span class="default_value">'dd/mm/yyyy'</span></em>, <em class="sig-param"><span class="n">value_format</span><span class="o">=</span><span class="default_value">'{0:15.6E}'</span></em>, <em class="sig-param"><span class="n">max_name_len</span><span class="o">=</span><span class="default_value">12</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.smp_utils.dataframe_to_smp" title="Permalink to this definition">¶</a></dt>
<dd><p>write a dataframe as an smp file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<cite>pandas.DataFrame</cite>) – the dataframe to write to an SMP
file.  This dataframe should be in “long” form - columns for
site name, datetime, and value.</p></li>
<li><p><strong>smp_filename</strong> (<cite>str</cite>) – smp file to write</p></li>
<li><p><strong>name_col</strong> (<cite>str</cite>,optional) – the name of the dataframe column
that contains the site name.  Default is “name”</p></li>
<li><p><strong>datetime_col</strong> (<cite>str</cite>) – the column in the dataframe that the
datetime values.  Default is “datetime”.</p></li>
<li><p><strong>value_col</strong> (<cite>str</cite>) – the column in the dataframe that is the values</p></li>
<li><p><strong>datetime_format</strong> (<cite>str</cite>, optional) – The format to write the datetimes in the
smp file.  Can be either ‘dd/mm/yyyy’ or ‘mm/dd/yyy’.  Default
is ‘dd/mm/yyyy’.</p></li>
<li><p><strong>value_format</strong> (<cite>str</cite>, optional) – a python float-compatible format.
Default is “{0:15.6E}”.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyemu</span><span class="o">.</span><span class="n">smp_utils</span><span class="o">.</span><span class="n">dataframe_to_smp</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s2">&quot;my.smp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.smp_utils.smp_to_dataframe">
<code class="sig-prename descclassname">pyemu.utils.smp_utils.</code><code class="sig-name descname">smp_to_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smp_filename</span></em>, <em class="sig-param"><span class="n">datetime_format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.smp_utils.smp_to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>load an smp file into a pandas dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smp_filename</strong> (<cite>str</cite>) – path and nane of existing smp filename to load</p></li>
<li><p><strong>datetime_format</strong> (<cite>str</cite>, optional) – The format of the datetime strings
in the smp file. Can be either “%m/%d/%Y %H:%M:%S” or “%d/%m/%Y %H:%M:%S”
If None, then we will try to deduce the format for you, which
always dangerous.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe with index of datetime and columns of
site names.  Missing values are set to NaN.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">smp_to_dataframe</span><span class="p">(</span><span class="s2">&quot;my.smp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyemu.utils.smp_utils.smp_to_ins">
<code class="sig-prename descclassname">pyemu.utils.smp_utils.</code><code class="sig-name descname">smp_to_ins</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smp_filename</span></em>, <em class="sig-param"><span class="n">ins_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_generic_names</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">gwutils_compliant</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">datetime_format</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyemu.utils.smp_utils.smp_to_ins" title="Permalink to this definition">¶</a></dt>
<dd><p>create an instruction file for an smp file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smp_filename</strong> (<cite>str</cite>) – path and name of an existing smp file</p></li>
<li><p><strong>ins_filename</strong> (<cite>str</cite>, optional) – the name of the instruction
file to create.  If None, <cite>smp_filename</cite> +”.ins” is used.
Default is None.</p></li>
<li><p><strong>use_generic_names</strong> (<cite>bool</cite>) – flag to force observations names
to use a generic <cite>int</cite> counter instead of trying to use a
datetime string.  Default is False</p></li>
<li><p><strong>gwutils_compliant</strong> (<cite>bool</cite>) – flag to use instruction set that
is compliant with the PEST gw utils (fixed format instructions).
If false, use free format (with whitespace) instruction set.
Default is False</p></li>
<li><p><strong>datetime_format</strong> (<cite>str</cite>) – string to pass to datetime.strptime in
the <cite>smp_utils.smp_to_dataframe()</cite> function.  If None, not
used. Default is None.</p></li>
<li><p><strong>prefix</strong> (<cite>str</cite>) – a prefix to add to the front of the derived
observation names.  Default is ‘’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataframe of the smp file
information with the observation names and
instruction lines as additional columns.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pyemu</span><span class="o">.</span><span class="n">smp_utils</span><span class="o">.</span><span class="n">smp_to_ins</span><span class="p">(</span><span class="s2">&quot;my.smp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyemu.utils" title="Permalink to this headline">¶</a></h2>
<p>pyemu utils module contains lots of useful functions and
classes, including support for geostatistical interpolation and
covariance matrices, pilot point setup and processing and
functionality dedicated to wrapping MODFLOW models into
the PEST(++) model independent framework</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jeremy White, Mike Fienen, Brioch Hemmings, and others

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>